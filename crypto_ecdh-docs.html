<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - ecdh</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 14px;
            scroll-behavior: smooth;
         }

         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
            line-height: 1.6;
         }

         .sidebar {
            width: 12%;
            background: rgba(59, 56, 56, 0.15);
            padding: 1.5rem;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.4);
            overflow-y: auto;
            position: sticky;
            top: 0;
            height: 100vh;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
         }

         .sidebar::-webkit-scrollbar {
            width: 6px;
         }

         .sidebar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
         }

         .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
         }

         main {
            flex: 1;
            padding: 2rem;
            margin: 0;
            max-width: calc(100% - 280px);
            background: linear-gradient(
               135deg,
               rgba(59, 56, 56, 0.05) 0%,
               rgba(0, 0, 0, 0.1) 100%
            );
         }

         .nav-links {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
         }

         .nav-links a {
            color: #ddd;
            text-decoration: none;
            padding: 0.5rem;
            border-radius: 4px;
            transition: all 0.2s ease;
         }

         .nav-links a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
         }

         h1 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #fff 0%, #ddd 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
         }

         h2 {
            font-size: 1.4rem;
            margin: 1rem 0 0.5rem;
            color: #f0f0f0;
         }

         h3 {
            font-size: 1.2rem;
            margin: 0.8rem 0 0.3rem;
            color: #e0e0e0;
         }

         .sidebar h2,
         .sidebar h3 {
            font-size: 1rem;
            margin: 0.5rem 0 0.3rem;
            color: #ccc;
         }

         pre {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #e6e6e6;
            padding: 1rem 1.2rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-size: 0.9rem;
            overflow-x: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
         }

         code {
            color: #f5f5f5;
            font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace;
            white-space: pre-wrap;
         }

         p {
            font-size: 15px;
            margin: 1rem 0;
            color: #ddd;
         }

         article {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(59, 56, 56, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
         }

         article:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
            transform: translateY(-2px);
         }

         .hidden {
            display: none !important;
         }

         .filter-section {
            margin-bottom: 1.5rem;
         }

         .filter-section h3 {
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #aaa;
         }

         .filter-toggle label {
            display: flex;
            align-items: center;
            margin-bottom: 0.6rem;
            font-size: 0.85rem;
            color: #bbb;
            cursor: pointer;
            padding: 0.3rem;
            border-radius: 4px;
            transition: background 0.2s ease;
         }

         .filter-toggle label:hover {
            background: rgba(255, 255, 255, 0.05);
         }

         .filter-toggle input {
            margin-right: 0.6rem;
         }

         .field-line,
         .method-line {
            display: block;
         }

         #searchInput {
            width: 100%;
            margin-bottom: 1.5rem;
            border-radius: 8px !important;
            height: 2.8rem;
            font-size: 0.9rem;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 0 1rem;
         }

         #searchInput::placeholder {
            color: rgba(255, 255, 255, 0.5);
         }

         #searchInput:focus {
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.1);
         }

         .section-divider {
            height: 1px;
            background: linear-gradient(
               90deg,
               transparent 0%,
               rgba(255, 255, 255, 0.3) 50%,
               transparent 100%
            );
            margin: 1.5rem 0;
         }

         .subpackage-list {
            list-style: none;
            padding: 0;
         }

         .subpackage-list li {
            margin-bottom: 0.4rem;
         }

         .subpackage-list a {
            display: block;
            padding: 0.5rem 0.8rem;
            color: #ccc;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-size: 0.85rem;
         }

         .subpackage-list a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            transform: translateX(4px);
         }

         .empty-state {
            color: rgba(177, 175, 175, 0.6);
            font-style: italic;
            font-size: 0.8rem;
         }

         .badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            color: #ddd;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-left: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .method-badge {
            background: rgba(100, 200, 255, 0.2);
            color: #87ceeb;
         }

         .const-badge {
            background: rgba(255, 200, 100, 0.2);
            color: #ffd700;
         }

         .var-badge {
            background: rgba(200, 255, 100, 0.2);
            color: #90ee90;
         }

         .type-badge {
            background: rgba(255, 100, 200, 0.2);
            color: #699eff;
         }

         .interface-badge {
            background: rgba(150, 100, 255, 0.2);
            color: #dda0dd;
         }

         .toc {
            position: sticky;
            top: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
         }

         .toc h4 {
            margin: 0 0 0.8rem;
            font-size: 0.9rem;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .toc ul {
            list-style: none;
            padding: 0;
            margin: 0;
         }

         .toc li {
            margin-bottom: 0.3rem;
         }

         .toc a {
            color: #bbb;
            text-decoration: none;
            font-size: 0.8rem;
            transition: color 0.2s ease;
         }

         .toc a:hover {
            color: #fff;
         }

         @media (max-width: 768px) {
            body {
               flex-direction: column;
            }

            .sidebar {
               width: 90%;
               height: auto;
               position: relative;
            }

            main {
               max-width: 100%;
               padding: 1rem;
            }
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <div class="nav-links">
            <a href="index.html" title="Home">⌂</a>
            <span>|</span>
            <a href="#" onclick="history.back()" title="Back">←</a>
         </div>

         <div class="filter-section">
            <h3>Search</h3>
            <input
               type="search"
               id="searchInput"
               placeholder="Search symbols..."
            />
         </div>

         <div class="filter-section">
            <h3>Filters</h3>
            <div class="filter-toggle">
               <label>
                  <input type="checkbox" id="showImports" />
                  Show imports
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFunctions" />
                  Show private functions
               </label>
               <label>
                  <input type="checkbox" id="showPrivateStructs" />
                  Show private structs
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFields" />
                  Show private fields
               </label>
               <label>
                  <input type="checkbox" id="showPrivateGlobals" />
                  Show private globals
               </label>
               <label>
                  <input type="checkbox" id="showPrivateTypes" />
                  Show private types
               </label>
               <label>
                  <input type="checkbox" id="showPrivateInterfaces" />
                  Show private interfaces
               </label>
            </div>
         </div>

         <div class="section-divider"></div>

         <div class="filter-section">
            <h3>Subpackages</h3>
            
            <div class="empty-state">No subpackages</div>
            
         </div>

         
         <div class="section-divider"></div>

         <div class="toc">
            <h4>Quick Navigation</h4>
            <ul>
               
               <li><a href="#globals">Constants & Variables</a></li>
                 
               <li><a href="#interfaces">Interfaces</a></li>
                
               <li><a href="#structs">Structs</a></li>
                
               <li><a href="#functions">Functions</a></li>
               
            </ul>
         </div>
         
      </aside>

      <main>
         <h1>ecdh</h1>
         <div class="section-divider"></div>

         
         <section id="imports">
            <h2>Imports</h2>
            <article class="imports" data-name="imports">
               <pre><code>"crypto"
"crypto/internal/boring"
"crypto/internal/fips140/ecdh"
"crypto/subtle"
"errors"
"io"
"bytes"
"crypto/internal/boring"
"crypto/internal/fips140/ecdh"
"crypto/internal/fips140only"
"errors"
"io"
"bytes"
"crypto/internal/fips140/edwards25519/field"
"crypto/internal/fips140only"
"crypto/internal/randutil"
"errors"
"io"
</code></pre>
            </article>
         </section>
          
         <section id="globals">
            <h2>Constants & Variables</h2>
            
            <article class="global" data-name="p256">
               <h3>
                  p256 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var p256 = *ast.UnaryExpr</code></pre>
            </article>
            
            <article class="global" data-name="p384">
               <h3>
                  p384 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var p384 = *ast.UnaryExpr</code></pre>
            </article>
            
            <article class="global" data-name="p521">
               <h3>
                  p521 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var p521 = *ast.UnaryExpr</code></pre>
            </article>
            
            <article class="global" data-name="x25519">
               <h3>
                  x25519 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var x25519 = *ast.UnaryExpr</code></pre>
            </article>
            
            <article class="global" data-name="x25519PrivateKeySize">
               <h3>
                  x25519PrivateKeySize 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var x25519PrivateKeySize = 32</code></pre>
            </article>
            
            <article class="global" data-name="x25519PublicKeySize">
               <h3>
                  x25519PublicKeySize 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var x25519PublicKeySize = 32</code></pre>
            </article>
            
            <article class="global" data-name="x25519SharedSecretSize">
               <h3>
                  x25519SharedSecretSize 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var x25519SharedSecretSize = 32</code></pre>
            </article>
            
         </section>
           
         <section id="interfaces">
            <h2>Interfaces</h2>
            
            <article class="interface" data-name="Curve">
               <h3>
                  Curve
                  <span class="badge interface-badge">interface</span>
               </h3>
               
               <pre
                  class="methods-block"
               ><code class="methods-code">type Curve interface {
GenerateKey(rand io.Reader) (*PrivateKey, error)
NewPrivateKey(key []byte) (*PrivateKey, error)
NewPublicKey(key []byte) (*PublicKey, error)
ecdh(local *PrivateKey, remote *PublicKey) ([]byte, error)
}</code></pre>
            </article>
            
         </section>
          
         <section id="structs">
            <h2>Structs</h2>
            
            <article class="struct" data-name="PrivateKey">
               <h3>
                  PrivateKey
                  <span class="badge">struct</span>
               </h3>
               
               <p>PrivateKey is an ECDH private key, usually kept secret.
These keys can be parsed with [crypto/x509.ParsePKCS8PrivateKey] and encoded
with [crypto/x509.MarshalPKCS8PrivateKey]. For NIST curves, they then need to
be converted with [crypto/ecdsa.PrivateKey.ECDH] after parsing.</p>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type PrivateKey struct {
curve Curve
privateKey []byte
publicKey *PublicKey
boring *boring.PrivateKeyECDH
fips *ecdh.PrivateKey
}</code></pre>
            </article>
            
            <article class="struct" data-name="PublicKey">
               <h3>
                  PublicKey
                  <span class="badge">struct</span>
               </h3>
               
               <p>PublicKey is an ECDH public key, usually a peer's ECDH share sent over the wire.
These keys can be parsed with [crypto/x509.ParsePKIXPublicKey] and encoded
with [crypto/x509.MarshalPKIXPublicKey]. For NIST curves, they then need to
be converted with [crypto/ecdsa.PublicKey.ECDH] after parsing.</p>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type PublicKey struct {
curve Curve
publicKey []byte
boring *boring.PublicKeyECDH
fips *ecdh.PublicKey
}</code></pre>
            </article>
            
            <article class="struct" data-name="nistCurve">
               <h3>
                  nistCurve
                  <span class="badge">struct</span>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type nistCurve struct {
name string
generate func(io.Reader) (*ecdh.PrivateKey, error)
newPrivateKey func([]byte) (*ecdh.PrivateKey, error)
newPublicKey func(publicKey []byte) (*ecdh.PublicKey, error)
sharedSecret func(*ecdh.PrivateKey, *ecdh.PublicKey) (sharedSecret []byte, err error)
}</code></pre>
            </article>
            
            <article class="struct" data-name="x25519Curve">
               <h3>
                  x25519Curve
                  <span class="badge">struct</span>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type x25519Curve struct {

}</code></pre>
            </article>
            
         </section>
          
         <section id="functions">
            <h2>Functions</h2>
            
            <article class="function" data-name="Bytes">
               <h3>
                  Bytes 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Bytes returns a copy of the encoding of the private key.</p>
               
               <pre><code>func (k *PrivateKey) Bytes() []byte</code></pre>
            </article>
            
            <article class="function" data-name="Bytes">
               <h3>
                  Bytes 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Bytes returns a copy of the encoding of the public key.</p>
               
               <pre><code>func (k *PublicKey) Bytes() []byte</code></pre>
            </article>
            
            <article class="function" data-name="Curve">
               <h3>
                  Curve 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (k *PublicKey) Curve() Curve</code></pre>
            </article>
            
            <article class="function" data-name="Curve">
               <h3>
                  Curve 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (k *PrivateKey) Curve() Curve</code></pre>
            </article>
            
            <article class="function" data-name="ECDH">
               <h3>
                  ECDH 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>ECDH performs an ECDH exchange and returns the shared secret. The [PrivateKey]
and [PublicKey] must use the same curve.
For NIST curves, this performs ECDH as specified in SEC 1, Version 2.0,
Section 3.3.1, and returns the x-coordinate encoded according to SEC 1,
Version 2.0, Section 2.3.5. The result is never the point at infinity.
This is also known as the Shared Secret Computation of the Ephemeral Unified
Model scheme specified in NIST SP 800-56A Rev. 3, Section 6.1.2.2.
For [X25519], this performs ECDH as specified in RFC 7748, Section 6.1. If
the result is the all-zero value, ECDH returns an error.</p>
               
               <pre><code>func (k *PrivateKey) ECDH(remote *PublicKey) ([]byte, error)</code></pre>
            </article>
            
            <article class="function" data-name="Equal">
               <h3>
                  Equal 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Equal returns whether x represents the same public key as k.
Note that there can be equivalent public keys with different encodings which
would return false from this check but behave the same way as inputs to ECDH.
This check is performed in constant time as long as the key types and their
curve match.</p>
               
               <pre><code>func (k *PublicKey) Equal(x crypto.PublicKey) bool</code></pre>
            </article>
            
            <article class="function" data-name="Equal">
               <h3>
                  Equal 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Equal returns whether x represents the same private key as k.
Note that there can be equivalent private keys with different encodings which
would return false from this check but behave the same way as inputs to [ECDH].
This check is performed in constant time as long as the key types and their
curve match.</p>
               
               <pre><code>func (k *PrivateKey) Equal(x crypto.PrivateKey) bool</code></pre>
            </article>
            
            <article class="function" data-name="GenerateKey">
               <h3>
                  GenerateKey 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (c *x25519Curve) GenerateKey(rand io.Reader) (*PrivateKey, error)</code></pre>
            </article>
            
            <article class="function" data-name="GenerateKey">
               <h3>
                  GenerateKey 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (c *nistCurve) GenerateKey(rand io.Reader) (*PrivateKey, error)</code></pre>
            </article>
            
            <article class="function" data-name="NewPrivateKey">
               <h3>
                  NewPrivateKey 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (c *nistCurve) NewPrivateKey(key []byte) (*PrivateKey, error)</code></pre>
            </article>
            
            <article class="function" data-name="NewPrivateKey">
               <h3>
                  NewPrivateKey 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (c *x25519Curve) NewPrivateKey(key []byte) (*PrivateKey, error)</code></pre>
            </article>
            
            <article class="function" data-name="NewPublicKey">
               <h3>
                  NewPublicKey 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (c *nistCurve) NewPublicKey(key []byte) (*PublicKey, error)</code></pre>
            </article>
            
            <article class="function" data-name="NewPublicKey">
               <h3>
                  NewPublicKey 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (c *x25519Curve) NewPublicKey(key []byte) (*PublicKey, error)</code></pre>
            </article>
            
            <article class="function" data-name="P256">
               <h3>
                  P256 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>P256 returns a [Curve] which implements NIST P-256 (FIPS 186-3, section D.2.3),
also known as secp256r1 or prime256v1.
Multiple invocations of this function will return the same value, which can
be used for equality checks and switch statements.</p>
               
               <pre><code>func P256() Curve</code></pre>
            </article>
            
            <article class="function" data-name="P384">
               <h3>
                  P384 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>P384 returns a [Curve] which implements NIST P-384 (FIPS 186-3, section D.2.4),
also known as secp384r1.
Multiple invocations of this function will return the same value, which can
be used for equality checks and switch statements.</p>
               
               <pre><code>func P384() Curve</code></pre>
            </article>
            
            <article class="function" data-name="P521">
               <h3>
                  P521 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>P521 returns a [Curve] which implements NIST P-521 (FIPS 186-3, section D.2.5),
also known as secp521r1.
Multiple invocations of this function will return the same value, which can
be used for equality checks and switch statements.</p>
               
               <pre><code>func P521() Curve</code></pre>
            </article>
            
            <article class="function" data-name="Public">
               <h3>
                  Public 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Public implements the implicit interface of all standard library private
keys. See the docs of [crypto.PrivateKey].</p>
               
               <pre><code>func (k *PrivateKey) Public() crypto.PublicKey</code></pre>
            </article>
            
            <article class="function" data-name="PublicKey">
               <h3>
                  PublicKey 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (k *PrivateKey) PublicKey() *PublicKey</code></pre>
            </article>
            
            <article class="function" data-name="String">
               <h3>
                  String 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (c *nistCurve) String() string</code></pre>
            </article>
            
            <article class="function" data-name="String">
               <h3>
                  String 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (c *x25519Curve) String() string</code></pre>
            </article>
            
            <article class="function" data-name="X25519">
               <h3>
                  X25519 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>X25519 returns a [Curve] which implements the X25519 function over Curve25519
(RFC 7748, Section 5).
Multiple invocations of this function will return the same value, so it can
be used for equality checks and switch statements.</p>
               
               <pre><code>func X25519() Curve</code></pre>
            </article>
            
            <article class="function" data-name="ecdh">
               <h3>
                  ecdh 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (c *nistCurve) ecdh(local *PrivateKey, remote *PublicKey) ([]byte, error)</code></pre>
            </article>
            
            <article class="function" data-name="ecdh">
               <h3>
                  ecdh 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (c *x25519Curve) ecdh(local *PrivateKey, remote *PublicKey) ([]byte, error)</code></pre>
            </article>
            
            <article class="function" data-name="isZero">
               <h3>
                  isZero 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>isZero reports whether x is all zeroes in constant time.</p>
               
               <pre><code>func isZero(x []byte) bool</code></pre>
            </article>
            
            <article class="function" data-name="x25519ScalarMult">
               <h3>
                  x25519ScalarMult 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func x25519ScalarMult(dst []byte, scalar []byte, point []byte)</code></pre>
            </article>
            
         </section>
         
      </main>

      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }

         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               imports: document.getElementById("showImports"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
               types: document.getElementById("showPrivateTypes"),
               interfaces: document.getElementById(
                  "showPrivateInterfaces"
               ),
            };

            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });

               if (toggle) {
                  toggle.addEventListener("change", () => {
                     const show = toggle.checked;
                     document
                        .querySelectorAll(`${selector}.private`)
                        .forEach((el) => {
                           el.classList.toggle("hidden", !show);
                        });
                  });
               }
            };

            hideInitial("article.imports", toggles.imports);
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            hideInitial("article.type", toggles.types);
            hideInitial("article.interface", toggles.interfaces);

            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;

                  const lines = codeBlock.innerHTML.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch && trimmed != "}") {
                           return `<span class="field-line">${line}</span>`;
                        }
                        if (nameMatch == null) return;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class="field-line${
                           isPriv ? " hidden private" : ""
                        }" data-name="${name}">${line}</span>`;
                     })
                     .join("");

                  codeBlock.innerHTML = newContent;

                  if (toggles.fields) {
                     toggles.fields.addEventListener("change", () => {
                        const show = toggles.fields.checked;
                        article
                           .querySelectorAll(".field-line.private")
                           .forEach((el) =>
                              el.classList.toggle("hidden", !show)
                           );
                     });
                  }
               });

            // Handle private methods in interfaces
            document
               .querySelectorAll("article.interface")
               .forEach((article) => {
                  const codeBlock = article.querySelector(
                     "code.methods-code"
                  );
                  if (!codeBlock) return;

                  const lines = codeBlock.innerHTML.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch) {
                           return `<span class="method-line">${line}</span>`;
                        }

                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class="method-line${
                           isPriv ? " hidden private" : ""
                        }" data-name="${name}">${line}</span>`;
                     })
                     .join("");

                  codeBlock.innerHTML = newContent;

                  if (toggles.fields) {
                     // Reuse fields toggle for interface methods
                     toggles.fields.addEventListener("change", () => {
                        const show = toggles.fields.checked;
                        article
                           .querySelectorAll(".method-line.private")
                           .forEach((el) =>
                              el.classList.toggle("hidden", !show)
                           );
                     });
                  }
               });

            const searchInput = document.getElementById("searchInput");
            if (searchInput) {
               searchInput.addEventListener("input", () => {
                  const query = searchInput.value.trim().toLowerCase();

                  document.querySelectorAll("article").forEach((el) => {
                     const name = el.dataset.name;
                     if (!name) return;

                     const matches =
                        query === "" ||
                        name.toLowerCase().includes(query) ||
                        (el.textContent &&
                           el.textContent.toLowerCase().includes(query));

                     if (matches) {
                        // Only show if not hidden by privacy filters
                        const isPrivateEl =
                           el.classList.contains("private");
                        const shouldShowPrivate =
                           getPrivateToggleState(el);

                        if (!isPrivateEl || shouldShowPrivate) {
                           el.classList.remove("hidden");
                        }
                     } else {
                        el.classList.add("hidden");
                     }
                  });
               });
            }

            // Helper function to check if private elements should be shown
            function getPrivateToggleState(element) {
               if (element.classList.contains("function")) {
                  return toggles.functions?.checked || false;
               } else if (element.classList.contains("struct")) {
                  return toggles.structs?.checked || false;
               } else if (element.classList.contains("global")) {
                  return toggles.globals?.checked || false;
               } else if (element.classList.contains("type")) {
                  return toggles.types?.checked || false;
               } else if (element.classList.contains("interface")) {
                  return toggles.interfaces?.checked || false;
               } else if (element.classList.contains("imports")) {
                  return toggles.imports?.checked || false;
               }
               return false;
            }

            document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
               anchor.addEventListener("click", function (e) {
                  e.preventDefault();
                  const target = document.querySelector(
                     this.getAttribute("href")
                  );
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               });
            });
         });
      </script>
   </body>
</html>
