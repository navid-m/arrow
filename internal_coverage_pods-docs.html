<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - pods</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>pods</code>
         </h1>
         <hr />
          
         <article class="struct" data-name="Pod">
            <h2>type Pod struct</h2>
            <hr />
            
            <p>Pod encapsulates a set of files emitted during the executions of a
coverage-instrumented binary. Each pod contains a single meta-data
file, and then 0 or more counter data files that refer to that
meta-data file. Pods are intended to simplify processing of
coverage output files in the case where we have several coverage
output directories containing output files derived from more
than one instrumented executable. In the case where the files that
make up a pod are spread out across multiple directories, each
element of the "Origins" field below will be populated with the
index of the originating directory for the corresponding counter
data file (within the slice of input dirs handed to CollectPods).
The ProcessIDs field will be populated with the process ID of each
data file in the CounterDataFiles slice.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">MetaFile string
CounterDataFiles []string
Origins []int
ProcessIDs []int</code></pre>
         </article>
         
         <article class="struct" data-name="fileWithAnnotations">
            <h2>type fileWithAnnotations struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">file string
origin int
pid int</code></pre>
         </article>
         
         <article class="struct" data-name="protoPod">
            <h2>type protoPod struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">mf string
elements []fileWithAnnotations</code></pre>
         </article>
          
         <article class="function" data-name="CollectPods">
            <h2>CollectPods</h2>
            <hr />
            
            <p>CollectPods visits the files contained within the directories in
the list 'dirs', collects any coverage-related files, partitions
them into pods, and returns a list of the pods to the caller, along
with an error if something went wrong during directory/file
reading.

CollectPods skips over any file that is not related to coverage
(e.g. avoids looking at things that are not meta-data files or
counter-data files). CollectPods also skips over 'orphaned' counter
data files (e.g. counter data files for which we can't find the
corresponding meta-data file). If "warn" is true, CollectPods will
issue warnings to stderr when it encounters non-fatal problems (for
orphans or a directory with no meta-data files).</p>
            
            <pre><code>func CollectPods(dirs []string, warn bool) ([]Pod, error)</code></pre>
         </article>
         
         <article class="function" data-name="CollectPodsFromFiles">
            <h2>CollectPodsFromFiles</h2>
            <hr />
            
            <p>CollectPodsFromFiles functions the same as "CollectPods" but
operates on an explicit list of files instead of a directory.</p>
            
            <pre><code>func CollectPodsFromFiles(files []string, warn bool) []Pod</code></pre>
         </article>
         
         <article class="function" data-name="collectPodsImpl">
            <h2>collectPodsImpl</h2>
            <hr />
            
            <p>collectPodsImpl examines the specified list of files and picks out
subsets that correspond to coverage pods. The first stage in this
process is collecting a set { M1, M2, ... MN } where each M_k is a
distinct coverage meta-data file. We then create a single pod for
each meta-data file M_k, then find all of the counter data files
that refer to that meta-data file (recall that the counter data
file name incorporates the meta-data hash), and add the counter
data file to the appropriate pod.

This process is complicated by the fact that we need to keep track
of directory indices for counter data files. Here is an example to
motivate:

	directory 1:

M1   covmeta.9bbf1777f47b3fcacb05c38b035512d6
C1   covcounters.9bbf1777f47b3fcacb05c38b035512d6.1677673.1662138360208416486
C2   covcounters.9bbf1777f47b3fcacb05c38b035512d6.1677637.1662138359974441782

	directory 2:

M2   covmeta.9bbf1777f47b3fcacb05c38b035512d6
C3   covcounters.9bbf1777f47b3fcacb05c38b035512d6.1677445.1662138360208416480
C4   covcounters.9bbf1777f47b3fcacb05c38b035512d6.1677677.1662138359974441781
M3   covmeta.a723844208cea2ae80c63482c78b2245
C5   covcounters.a723844208cea2ae80c63482c78b2245.3677445.1662138360208416480
C6   covcounters.a723844208cea2ae80c63482c78b2245.1877677.1662138359974441781

In these two directories we have three meta-data files, but only
two are distinct, meaning that we'll wind up with two pods. The
first pod (with meta-file M1) will have four counter data files
(C1, C2, C3, C4) and the second pod will have two counter data files
(C5, C6).</p>
            
            <pre><code>func collectPodsImpl(files []string, dirIndices []int, warn bool) []Pod</code></pre>
         </article>
         
         <article class="function" data-name="warning">
            <h2>warning</h2>
            <hr />
            
            <pre><code>func warning(s string, a ...*ast.InterfaceType)</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
