<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - dsa</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>dsa</code>
         </h1>
         <hr />
         
         <article class="global" data-name="ErrInvalidPublicKey">
            <h2>ErrInvalidPublicKey</h2>
            <hr />
            
            <p>ErrInvalidPublicKey results when a public key is not usable by this code.
FIPS is quite strict about the format of DSA keys, but other code may be
less so. Thus, when using keys which may have been generated by other code,
this error must be handled.</p>
            
            <pre><code>ErrInvalidPublicKey</code></pre>
         </article>
         
         <article class="global" data-name="L1024N160">
            <h2>L1024N160</h2>
            <hr />
            
            <pre><code>L1024N160 ParameterSizes</code></pre>
         </article>
         
         <article class="global" data-name="L2048N224">
            <h2>L2048N224</h2>
            <hr />
            
            <pre><code>L2048N224</code></pre>
         </article>
         
         <article class="global" data-name="L2048N256">
            <h2>L2048N256</h2>
            <hr />
            
            <pre><code>L2048N256</code></pre>
         </article>
         
         <article class="global" data-name="L3072N256">
            <h2>L3072N256</h2>
            <hr />
            
            <pre><code>L3072N256</code></pre>
         </article>
         
         <article class="global" data-name="numMRTests">
            <h2>numMRTests</h2>
            <hr />
            
            <p>numMRTests is the number of Miller-Rabin primality tests that we perform. We
pick the largest recommended number from table C.1 of FIPS 186-3.</p>
            
            <pre><code>numMRTests</code></pre>
         </article>
          
         <article class="struct" data-name="Parameters">
            <h2>type Parameters struct</h2>
            <hr />
            
            <p>Parameters represents the domain parameters for a key. These parameters can
be shared across many keys. The bit length of Q must be a multiple of 8.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">P *big.Int
Q *big.Int
G *big.Int</code></pre>
         </article>
         
         <article class="struct" data-name="PublicKey">
            <h2>type PublicKey struct</h2>
            <hr />
            
            <p>PublicKey represents a DSA public key.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Parameters
Y *big.Int</code></pre>
         </article>
         
         <article class="struct" data-name="PrivateKey">
            <h2>type PrivateKey struct</h2>
            <hr />
            
            <p>PrivateKey represents a DSA private key.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">PublicKey
X *big.Int</code></pre>
         </article>
          
         <article class="function" data-name="GenerateParameters">
            <h2>GenerateParameters</h2>
            <hr />
            
            <p>GenerateParameters puts a random, valid set of DSA parameters into params.
This function can take many seconds, even on fast machines.</p>
            
            <pre><code>func GenerateParameters(params *Parameters, rand io.Reader, sizes ParameterSizes) error</code></pre>
         </article>
         
         <article class="function" data-name="GenerateKey">
            <h2>GenerateKey</h2>
            <hr />
            
            <p>GenerateKey generates a public&private key pair. The Parameters of the
[PrivateKey] must already be valid (see [GenerateParameters]).</p>
            
            <pre><code>func GenerateKey(priv *PrivateKey, rand io.Reader) error</code></pre>
         </article>
         
         <article class="function" data-name="fermatInverse">
            <h2>fermatInverse</h2>
            <hr />
            
            <p>fermatInverse calculates the inverse of k in GF(P) using Fermat's method.
This has better constant-time properties than Euclid's method (implemented
in math/big.Int.ModInverse) although math/big itself isn't strictly
constant-time so it's not perfect.</p>
            
            <pre><code>func fermatInverse(k *big.Int, P *big.Int) *big.Int</code></pre>
         </article>
         
         <article class="function" data-name="Sign">
            <h2>Sign</h2>
            <hr />
            
            <p>Sign signs an arbitrary length hash (which should be the result of hashing a
larger message) using the private key, priv. It returns the signature as a
pair of integers. The security of the private key depends on the entropy of
rand.

Note that FIPS 186-3 section 4.6 specifies that the hash should be truncated
to the byte-length of the subgroup. This function does not perform that
truncation itself.

Be aware that calling Sign with an attacker-controlled [PrivateKey] may
require an arbitrary amount of CPU.</p>
            
            <pre><code>func Sign(rand io.Reader, priv *PrivateKey, hash []byte) (r *big.Int, s *big.Int, err error)</code></pre>
         </article>
         
         <article class="function" data-name="Verify">
            <h2>Verify</h2>
            <hr />
            
            <p>Verify verifies the signature in r, s of hash using the public key, pub. It
reports whether the signature is valid.

Note that FIPS 186-3 section 4.6 specifies that the hash should be truncated
to the byte-length of the subgroup. This function does not perform that
truncation itself.</p>
            
            <pre><code>func Verify(pub *PublicKey, hash []byte, r *big.Int, s *big.Int) bool</code></pre>
         </article>
         
         <article class="function" data-name="testSignAndVerify">
            <h2>testSignAndVerify</h2>
            <hr />
            
            <pre><code>func testSignAndVerify(t *testing.T, i int, priv *PrivateKey)</code></pre>
         </article>
         
         <article class="function" data-name="testParameterGeneration">
            <h2>testParameterGeneration</h2>
            <hr />
            
            <pre><code>func testParameterGeneration(t *testing.T, sizes ParameterSizes, L int, N int)</code></pre>
         </article>
         
         <article class="function" data-name="TestParameterGeneration">
            <h2>TestParameterGeneration</h2>
            <hr />
            
            <pre><code>func TestParameterGeneration(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="fromHex">
            <h2>fromHex</h2>
            <hr />
            
            <pre><code>func fromHex(s string) *big.Int</code></pre>
         </article>
         
         <article class="function" data-name="TestSignAndVerify">
            <h2>TestSignAndVerify</h2>
            <hr />
            
            <pre><code>func TestSignAndVerify(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestSignAndVerifyWithBadPublicKey">
            <h2>TestSignAndVerifyWithBadPublicKey</h2>
            <hr />
            
            <pre><code>func TestSignAndVerifyWithBadPublicKey(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestSigningWithDegenerateKeys">
            <h2>TestSigningWithDegenerateKeys</h2>
            <hr />
            
            <pre><code>func TestSigningWithDegenerateKeys(t *testing.T)</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
