<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - ppc64</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>ppc64</code>
         </h1>
         <hr />
         
         <article class="global" data-name="hasPCrel">
            <h2>hasPCrel</h2>
            <hr />
            
            <p>The build configuration supports PC-relative instructions and relocations (limited to tested targets).</p>
            
            <pre><code>hasPCrel</code></pre>
         </article>
         
         <article class="global" data-name="STUB_TOC">
            <h2>STUB_TOC</h2>
            <hr />
            
            <p>For genstub, the type of stub required by the caller.</p>
            
            <pre><code>STUB_TOC</code></pre>
         </article>
         
         <article class="global" data-name="STUB_PCREL">
            <h2>STUB_PCREL</h2>
            <hr />
            
            <pre><code>STUB_PCREL</code></pre>
         </article>
         
         <article class="global" data-name="stubStrs">
            <h2>stubStrs</h2>
            <hr />
            
            <pre><code>stubStrs</code></pre>
         </article>
         
         <article class="global" data-name="OP_TOCRESTORE">
            <h2>OP_TOCRESTORE</h2>
            <hr />
            
            <pre><code>OP_TOCRESTORE</code></pre>
         </article>
         
         <article class="global" data-name="OP_TOCSAVE">
            <h2>OP_TOCSAVE</h2>
            <hr />
            
            <pre><code>OP_TOCSAVE</code></pre>
         </article>
         
         <article class="global" data-name="OP_NOP">
            <h2>OP_NOP</h2>
            <hr />
            
            <pre><code>OP_NOP</code></pre>
         </article>
         
         <article class="global" data-name="OP_BL">
            <h2>OP_BL</h2>
            <hr />
            
            <pre><code>OP_BL</code></pre>
         </article>
         
         <article class="global" data-name="OP_BCTR">
            <h2>OP_BCTR</h2>
            <hr />
            
            <pre><code>OP_BCTR</code></pre>
         </article>
         
         <article class="global" data-name="OP_BCTRL">
            <h2>OP_BCTRL</h2>
            <hr />
            
            <pre><code>OP_BCTRL</code></pre>
         </article>
         
         <article class="global" data-name="OP_BCL">
            <h2>OP_BCL</h2>
            <hr />
            
            <pre><code>OP_BCL</code></pre>
         </article>
         
         <article class="global" data-name="OP_ADDI">
            <h2>OP_ADDI</h2>
            <hr />
            
            <pre><code>OP_ADDI</code></pre>
         </article>
         
         <article class="global" data-name="OP_ADDIS">
            <h2>OP_ADDIS</h2>
            <hr />
            
            <pre><code>OP_ADDIS</code></pre>
         </article>
         
         <article class="global" data-name="OP_LD">
            <h2>OP_LD</h2>
            <hr />
            
            <pre><code>OP_LD</code></pre>
         </article>
         
         <article class="global" data-name="OP_PLA_PFX">
            <h2>OP_PLA_PFX</h2>
            <hr />
            
            <pre><code>OP_PLA_PFX</code></pre>
         </article>
         
         <article class="global" data-name="OP_PLA_SFX">
            <h2>OP_PLA_SFX</h2>
            <hr />
            
            <pre><code>OP_PLA_SFX</code></pre>
         </article>
         
         <article class="global" data-name="OP_PLD_PFX_PCREL">
            <h2>OP_PLD_PFX_PCREL</h2>
            <hr />
            
            <pre><code>OP_PLD_PFX_PCREL</code></pre>
         </article>
         
         <article class="global" data-name="OP_PLD_SFX">
            <h2>OP_PLD_SFX</h2>
            <hr />
            
            <pre><code>OP_PLD_SFX</code></pre>
         </article>
         
         <article class="global" data-name="OP_MFLR">
            <h2>OP_MFLR</h2>
            <hr />
            
            <pre><code>OP_MFLR</code></pre>
         </article>
         
         <article class="global" data-name="OP_MTLR">
            <h2>OP_MTLR</h2>
            <hr />
            
            <pre><code>OP_MTLR</code></pre>
         </article>
         
         <article class="global" data-name="OP_MFCTR">
            <h2>OP_MFCTR</h2>
            <hr />
            
            <pre><code>OP_MFCTR</code></pre>
         </article>
         
         <article class="global" data-name="OP_MTCTR">
            <h2>OP_MTCTR</h2>
            <hr />
            
            <pre><code>OP_MTCTR</code></pre>
         </article>
         
         <article class="global" data-name="OP_ADDIS_R12_R2">
            <h2>OP_ADDIS_R12_R2</h2>
            <hr />
            
            <pre><code>OP_ADDIS_R12_R2</code></pre>
         </article>
         
         <article class="global" data-name="OP_ADDIS_R12_R12">
            <h2>OP_ADDIS_R12_R12</h2>
            <hr />
            
            <pre><code>OP_ADDIS_R12_R12</code></pre>
         </article>
         
         <article class="global" data-name="OP_ADDI_R12_R12">
            <h2>OP_ADDI_R12_R12</h2>
            <hr />
            
            <pre><code>OP_ADDI_R12_R12</code></pre>
         </article>
         
         <article class="global" data-name="OP_PLD_SFX_R12">
            <h2>OP_PLD_SFX_R12</h2>
            <hr />
            
            <pre><code>OP_PLD_SFX_R12</code></pre>
         </article>
         
         <article class="global" data-name="OP_PLA_SFX_R12">
            <h2>OP_PLA_SFX_R12</h2>
            <hr />
            
            <pre><code>OP_PLA_SFX_R12</code></pre>
         </article>
         
         <article class="global" data-name="OP_LIS_R12">
            <h2>OP_LIS_R12</h2>
            <hr />
            
            <pre><code>OP_LIS_R12</code></pre>
         </article>
         
         <article class="global" data-name="OP_LD_R12_R12">
            <h2>OP_LD_R12_R12</h2>
            <hr />
            
            <pre><code>OP_LD_R12_R12</code></pre>
         </article>
         
         <article class="global" data-name="OP_MTCTR_R12">
            <h2>OP_MTCTR_R12</h2>
            <hr />
            
            <pre><code>OP_MTCTR_R12</code></pre>
         </article>
         
         <article class="global" data-name="OP_MFLR_R12">
            <h2>OP_MFLR_R12</h2>
            <hr />
            
            <pre><code>OP_MFLR_R12</code></pre>
         </article>
         
         <article class="global" data-name="OP_MFLR_R0">
            <h2>OP_MFLR_R0</h2>
            <hr />
            
            <pre><code>OP_MFLR_R0</code></pre>
         </article>
         
         <article class="global" data-name="OP_MTLR_R0">
            <h2>OP_MTLR_R0</h2>
            <hr />
            
            <pre><code>OP_MTLR_R0</code></pre>
         </article>
         
         <article class="global" data-name="OP_BCL_NIA">
            <h2>OP_BCL_NIA</h2>
            <hr />
            
            <p>This is a special, preferred form of bcl to obtain the next
instruction address (NIA, aka PC+4) in LR.</p>
            
            <pre><code>OP_BCL_NIA</code></pre>
         </article>
         
         <article class="global" data-name="MASK_PLD_PFX">
            <h2>MASK_PLD_PFX</h2>
            <hr />
            
            <p>Masks to match opcodes</p>
            
            <pre><code>MASK_PLD_PFX</code></pre>
         </article>
         
         <article class="global" data-name="MASK_PLD_SFX">
            <h2>MASK_PLD_SFX</h2>
            <hr />
            
            <pre><code>MASK_PLD_SFX</code></pre>
         </article>
         
         <article class="global" data-name="MASK_PLD_RT">
            <h2>MASK_PLD_RT</h2>
            <hr />
            
            <pre><code>MASK_PLD_RT</code></pre>
         </article>
         
         <article class="global" data-name="MASK_OP_LD">
            <h2>MASK_OP_LD</h2>
            <hr />
            
            <pre><code>MASK_OP_LD</code></pre>
         </article>
         
         <article class="global" data-name="MASK_OP_ADDIS">
            <h2>MASK_OP_ADDIS</h2>
            <hr />
            
            <pre><code>MASK_OP_ADDIS</code></pre>
         </article>
         
         <article class="global" data-name="maxAlign">
            <h2>maxAlign</h2>
            <hr />
            
            <pre><code>maxAlign</code></pre>
         </article>
         
         <article class="global" data-name="minAlign">
            <h2>minAlign</h2>
            <hr />
            
            <pre><code>minAlign</code></pre>
         </article>
         
         <article class="global" data-name="funcAlign">
            <h2>funcAlign</h2>
            <hr />
            
            <pre><code>funcAlign</code></pre>
         </article>
         
         <article class="global" data-name="dwarfRegSP">
            <h2>dwarfRegSP</h2>
            <hr />
            
            <p>Used by ../internal/ld/dwarf.go</p>
            
            <pre><code>dwarfRegSP</code></pre>
         </article>
         
         <article class="global" data-name="dwarfRegLR">
            <h2>dwarfRegLR</h2>
            <hr />
            
            <p>Used by ../internal/ld/dwarf.go</p>
            
            <pre><code>dwarfRegLR</code></pre>
         </article>
           
         <article class="function" data-name="genstub">
            <h2>genstub</h2>
            <hr />
            
            <p>Generate a stub to call between TOC and NOTOC functions. See genpltstub for more details about calling stubs.
This is almost identical to genpltstub, except the location of the target symbol is known at link time.</p>
            
            <pre><code>func genstub(ctxt *ld.Link, ldr *loader.Loader, r loader.Reloc, ri int, s loader.Sym, stubType int) (ssym loader.Sym, firstUse bool)</code></pre>
         </article>
         
         <article class="function" data-name="genpltstub">
            <h2>genpltstub</h2>
            <hr />
            
            <pre><code>func genpltstub(ctxt *ld.Link, ldr *loader.Loader, r loader.Reloc, ri int, s loader.Sym) (sym loader.Sym, firstUse bool)</code></pre>
         </article>
         
         <article class="function" data-name="genstubs">
            <h2>genstubs</h2>
            <hr />
            
            <p>Scan relocs and generate PLT stubs and generate/fixup ABI defined functions created by the linker.</p>
            
            <pre><code>func genstubs(ctxt *ld.Link, ldr *loader.Loader)</code></pre>
         </article>
         
         <article class="function" data-name="genaddmoduledata">
            <h2>genaddmoduledata</h2>
            <hr />
            
            <pre><code>func genaddmoduledata(ctxt *ld.Link, ldr *loader.Loader)</code></pre>
         </article>
         
         <article class="function" data-name="rewriteABIFuncReloc">
            <h2>rewriteABIFuncReloc</h2>
            <hr />
            
            <p>Rewrite ELF (v1 or v2) calls to _savegpr0_n, _savegpr1_n, _savefpr_n, _restfpr_n, _savevr_m, or
_restvr_m (14<=n<=31, 20<=m<=31). Redirect them to runtime.elf_restgpr0+(n-14)*4,
runtime.elf_restvr+(m-20)*8, and similar.

These functions are defined in the ELFv2 ABI (generated when using gcc -Os option) to save and
restore callee-saved registers (as defined in the PPC64 ELF ABIs) from registers n or m to 31 of
the named type. R12 and R0 are sometimes used in exceptional ways described in the ABI.

Final note, this is only needed when linking internally. The external linker will generate these
functions if they are used.</p>
            
            <pre><code>func rewriteABIFuncReloc(ctxt *ld.Link, ldr *loader.Loader, tname string, r loader.Reloc) (sym loader.Sym, firstUse bool)</code></pre>
         </article>
         
         <article class="function" data-name="gentext">
            <h2>gentext</h2>
            <hr />
            
            <pre><code>func gentext(ctxt *ld.Link, ldr *loader.Loader)</code></pre>
         </article>
         
         <article class="function" data-name="gencallstub">
            <h2>gencallstub</h2>
            <hr />
            
            <p>Create a calling stub. The stubType maps directly to the properties listed in the ELFv2 1.5
section 4.2.5.3.

There are 3 cases today (as paraphrased from the ELFv2 document):

 1. R2 holds the TOC pointer on entry. The call stub must save R2 into the ELFv2 TOC stack save slot.

 2. R2 holds the TOC pointer on entry. The caller has already saved R2 to the TOC stack save slot.

 3. R2 does not hold the TOC pointer on entry. The caller has no expectations of R2.

Go only needs case 1 and 3 today. Go symbols which have AttrShare set could use case 2, but case 1 always
works in those cases too.</p>
            
            <pre><code>func gencallstub(ctxt *ld.Link, ldr *loader.Loader, stubType int, stub *loader.SymbolBuilder, targ loader.Sym)</code></pre>
         </article>
         
         <article class="function" data-name="rewritetoinsn">
            <h2>rewritetoinsn</h2>
            <hr />
            
            <p>Rewrite the instruction at offset into newinsn. Also, verify the
existing instruction under mask matches the check value.</p>
            
            <pre><code>func rewritetoinsn(target *ld.Target, ldr *loader.Loader, su *loader.SymbolBuilder, offset int64, mask uint32, check uint32, newinsn uint32)</code></pre>
         </article>
         
         <article class="function" data-name="rewritetonop">
            <h2>rewritetonop</h2>
            <hr />
            
            <p>Rewrite the instruction at offset into a hardware nop instruction. Also, verify the
existing instruction under mask matches the check value.</p>
            
            <pre><code>func rewritetonop(target *ld.Target, ldr *loader.Loader, su *loader.SymbolBuilder, offset int64, mask uint32, check uint32)</code></pre>
         </article>
         
         <article class="function" data-name="adddynrel">
            <h2>adddynrel</h2>
            <hr />
            
            <pre><code>func adddynrel(target *ld.Target, ldr *loader.Loader, syms *ld.ArchSyms, s loader.Sym, r loader.Reloc, rIdx int) bool</code></pre>
         </article>
         
         <article class="function" data-name="addelfdynrel">
            <h2>addelfdynrel</h2>
            <hr />
            
            <pre><code>func addelfdynrel(target *ld.Target, ldr *loader.Loader, syms *ld.ArchSyms, s loader.Sym, r loader.Reloc, rIdx int) bool</code></pre>
         </article>
         
         <article class="function" data-name="xcoffreloc1">
            <h2>xcoffreloc1</h2>
            <hr />
            
            <pre><code>func xcoffreloc1(arch *sys.Arch, out *ld.OutBuf, ldr *loader.Loader, s loader.Sym, r loader.ExtReloc, sectoff int64) bool</code></pre>
         </article>
         
         <article class="function" data-name="elfreloc1">
            <h2>elfreloc1</h2>
            <hr />
            
            <pre><code>func elfreloc1(ctxt *ld.Link, out *ld.OutBuf, ldr *loader.Loader, s loader.Sym, r loader.ExtReloc, ri int, sectoff int64) bool</code></pre>
         </article>
         
         <article class="function" data-name="elfsetupplt">
            <h2>elfsetupplt</h2>
            <hr />
            
            <pre><code>func elfsetupplt(ctxt *ld.Link, ldr *loader.Loader, plt *loader.SymbolBuilder, got *loader.SymbolBuilder, dynamic loader.Sym)</code></pre>
         </article>
         
         <article class="function" data-name="machoreloc1">
            <h2>machoreloc1</h2>
            <hr />
            
            <pre><code>func machoreloc1(*sys.Arch, *ld.OutBuf, *loader.Loader, loader.Sym, loader.ExtReloc, int64) bool</code></pre>
         </article>
         
         <article class="function" data-name="symtoc">
            <h2>symtoc</h2>
            <hr />
            
            <p>Return the value of .TOC. for symbol s</p>
            
            <pre><code>func symtoc(ldr *loader.Loader, syms *ld.ArchSyms, s loader.Sym) int64</code></pre>
         </article>
         
         <article class="function" data-name="archreloctoc">
            <h2>archreloctoc</h2>
            <hr />
            
            <p>archreloctoc relocates a TOC relative symbol.</p>
            
            <pre><code>func archreloctoc(ldr *loader.Loader, target *ld.Target, syms *ld.ArchSyms, r loader.Reloc, s loader.Sym, val int64) int64</code></pre>
         </article>
         
         <article class="function" data-name="archrelocaddr">
            <h2>archrelocaddr</h2>
            <hr />
            
            <p>archrelocaddr relocates a symbol address.
This code is for linux only.</p>
            
            <pre><code>func archrelocaddr(ldr *loader.Loader, target *ld.Target, syms *ld.ArchSyms, r loader.Reloc, s loader.Sym, val int64) int64</code></pre>
         </article>
         
         <article class="function" data-name="r2Valid">
            <h2>r2Valid</h2>
            <hr />
            
            <p>Determine if the code was compiled so that the TOC register R2 is initialized and maintained.</p>
            
            <pre><code>func r2Valid(ctxt *ld.Link) bool</code></pre>
         </article>
         
         <article class="function" data-name="isLinkingPIC">
            <h2>isLinkingPIC</h2>
            <hr />
            
            <p>Determine if this is linking a position-independent binary.</p>
            
            <pre><code>func isLinkingPIC(ctxt *ld.Link) bool</code></pre>
         </article>
         
         <article class="function" data-name="trampoline">
            <h2>trampoline</h2>
            <hr />
            
            <p>resolve direct jump relocation r in s, and add trampoline if necessary.</p>
            
            <pre><code>func trampoline(ctxt *ld.Link, ldr *loader.Loader, ri int, rs loader.Sym, s loader.Sym)</code></pre>
         </article>
         
         <article class="function" data-name="gentramp">
            <h2>gentramp</h2>
            <hr />
            
            <pre><code>func gentramp(ctxt *ld.Link, ldr *loader.Loader, tramp *loader.SymbolBuilder, target loader.Sym, offset int64)</code></pre>
         </article>
         
         <article class="function" data-name="unpackInstPair">
            <h2>unpackInstPair</h2>
            <hr />
            
            <p>Unpack a pair of 32 bit instruction words from
a 64 bit relocation into instN and instN+1 in endian order.</p>
            
            <pre><code>func unpackInstPair(target *ld.Target, r int64) (uint32, uint32)</code></pre>
         </article>
         
         <article class="function" data-name="packInstPair">
            <h2>packInstPair</h2>
            <hr />
            
            <p>Pack a pair of 32 bit instruction words o1, o2 into 64 bit relocation
in endian order.</p>
            
            <pre><code>func packInstPair(target *ld.Target, o1 uint32, o2 uint32) int64</code></pre>
         </article>
         
         <article class="function" data-name="computeHA">
            <h2>computeHA</h2>
            <hr />
            
            <p>Compute the high-adjusted value (always a signed 32b value) per the ELF ABI.
The returned value is always 0 <= x <= 0xFFFF.</p>
            
            <pre><code>func computeHA(val int32) uint32</code></pre>
         </article>
         
         <article class="function" data-name="computeLO">
            <h2>computeLO</h2>
            <hr />
            
            <p>Compute the low value (the lower 16 bits of any 32b value) per the ELF ABI.
The returned value is always 0 <= x <= 0xFFFF.</p>
            
            <pre><code>func computeLO(val int32) uint32</code></pre>
         </article>
         
         <article class="function" data-name="computePrefix34HI">
            <h2>computePrefix34HI</h2>
            <hr />
            
            <p>Compute the high 18 bits of a signed 34b constant. Used to pack the high 18 bits
of a prefix34 relocation field. This assumes the input is already restricted to
34 bits.</p>
            
            <pre><code>func computePrefix34HI(val int64) uint32</code></pre>
         </article>
         
         <article class="function" data-name="computeTLSLEReloc">
            <h2>computeTLSLEReloc</h2>
            <hr />
            
            <pre><code>func computeTLSLEReloc(target *ld.Target, ldr *loader.Loader, rs loader.Sym, s loader.Sym) int64</code></pre>
         </article>
         
         <article class="function" data-name="archreloc">
            <h2>archreloc</h2>
            <hr />
            
            <pre><code>func archreloc(target *ld.Target, ldr *loader.Loader, syms *ld.ArchSyms, r loader.Reloc, s loader.Sym, val int64) (relocatedOffset int64, nExtReloc int, ok bool)</code></pre>
         </article>
         
         <article class="function" data-name="archrelocvariant">
            <h2>archrelocvariant</h2>
            <hr />
            
            <pre><code>func archrelocvariant(target *ld.Target, ldr *loader.Loader, r loader.Reloc, rv sym.RelocVariant, s loader.Sym, t int64, p []byte) relocatedOffset int64</code></pre>
         </article>
         
         <article class="function" data-name="extreloc">
            <h2>extreloc</h2>
            <hr />
            
            <pre><code>func extreloc(target *ld.Target, ldr *loader.Loader, r loader.Reloc, s loader.Sym) (loader.ExtReloc, bool)</code></pre>
         </article>
         
         <article class="function" data-name="addpltsym">
            <h2>addpltsym</h2>
            <hr />
            
            <pre><code>func addpltsym(ctxt *ld.Link, ldr *loader.Loader, s loader.Sym)</code></pre>
         </article>
         
         <article class="function" data-name="ensureglinkresolver">
            <h2>ensureglinkresolver</h2>
            <hr />
            
            <p>Generate the glink resolver stub if necessary and return the .glink section.</p>
            
            <pre><code>func ensureglinkresolver(ctxt *ld.Link, ldr *loader.Loader) *loader.SymbolBuilder</code></pre>
         </article>
         
         <article class="function" data-name="Init">
            <h2>Init</h2>
            <hr />
            
            <pre><code>func Init() (*sys.Arch, ld.Arch)</code></pre>
         </article>
         
         <article class="function" data-name="archinit">
            <h2>archinit</h2>
            <hr />
            
            <pre><code>func archinit(ctxt *ld.Link)</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
