<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - codesign</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>codesign</code>
         </h1>
         <hr />
         
         <article class="global" data-name="pageSizeBits">
            <h2>pageSizeBits</h2>
            <hr />
            
            <pre><code>pageSizeBits</code></pre>
         </article>
         
         <article class="global" data-name="pageSize">
            <h2>pageSize</h2>
            <hr />
            
            <pre><code>pageSize</code></pre>
         </article>
         
         <article class="global" data-name="LC_CODE_SIGNATURE">
            <h2>LC_CODE_SIGNATURE</h2>
            <hr />
            
            <pre><code>LC_CODE_SIGNATURE</code></pre>
         </article>
         
         <article class="global" data-name="CSMAGIC_REQUIREMENT">
            <h2>CSMAGIC_REQUIREMENT</h2>
            <hr />
            
            <pre><code>CSMAGIC_REQUIREMENT</code></pre>
         </article>
         
         <article class="global" data-name="CSMAGIC_REQUIREMENTS">
            <h2>CSMAGIC_REQUIREMENTS</h2>
            <hr />
            
            <pre><code>CSMAGIC_REQUIREMENTS</code></pre>
         </article>
         
         <article class="global" data-name="CSMAGIC_CODEDIRECTORY">
            <h2>CSMAGIC_CODEDIRECTORY</h2>
            <hr />
            
            <pre><code>CSMAGIC_CODEDIRECTORY</code></pre>
         </article>
         
         <article class="global" data-name="CSMAGIC_EMBEDDED_SIGNATURE">
            <h2>CSMAGIC_EMBEDDED_SIGNATURE</h2>
            <hr />
            
            <pre><code>CSMAGIC_EMBEDDED_SIGNATURE</code></pre>
         </article>
         
         <article class="global" data-name="CSMAGIC_DETACHED_SIGNATURE">
            <h2>CSMAGIC_DETACHED_SIGNATURE</h2>
            <hr />
            
            <pre><code>CSMAGIC_DETACHED_SIGNATURE</code></pre>
         </article>
         
         <article class="global" data-name="CSSLOT_CODEDIRECTORY">
            <h2>CSSLOT_CODEDIRECTORY</h2>
            <hr />
            
            <pre><code>CSSLOT_CODEDIRECTORY</code></pre>
         </article>
         
         <article class="global" data-name="CS_HASHTYPE_SHA1">
            <h2>CS_HASHTYPE_SHA1</h2>
            <hr />
            
            <pre><code>CS_HASHTYPE_SHA1</code></pre>
         </article>
         
         <article class="global" data-name="CS_HASHTYPE_SHA256">
            <h2>CS_HASHTYPE_SHA256</h2>
            <hr />
            
            <pre><code>CS_HASHTYPE_SHA256</code></pre>
         </article>
         
         <article class="global" data-name="CS_HASHTYPE_SHA256_TRUNCATED">
            <h2>CS_HASHTYPE_SHA256_TRUNCATED</h2>
            <hr />
            
            <pre><code>CS_HASHTYPE_SHA256_TRUNCATED</code></pre>
         </article>
         
         <article class="global" data-name="CS_HASHTYPE_SHA384">
            <h2>CS_HASHTYPE_SHA384</h2>
            <hr />
            
            <pre><code>CS_HASHTYPE_SHA384</code></pre>
         </article>
         
         <article class="global" data-name="CS_EXECSEG_MAIN_BINARY">
            <h2>CS_EXECSEG_MAIN_BINARY</h2>
            <hr />
            
            <pre><code>CS_EXECSEG_MAIN_BINARY</code></pre>
         </article>
         
         <article class="global" data-name="CS_EXECSEG_ALLOW_UNSIGNED">
            <h2>CS_EXECSEG_ALLOW_UNSIGNED</h2>
            <hr />
            
            <pre><code>CS_EXECSEG_ALLOW_UNSIGNED</code></pre>
         </article>
         
         <article class="global" data-name="CS_EXECSEG_DEBUGGER">
            <h2>CS_EXECSEG_DEBUGGER</h2>
            <hr />
            
            <pre><code>CS_EXECSEG_DEBUGGER</code></pre>
         </article>
         
         <article class="global" data-name="CS_EXECSEG_JIT">
            <h2>CS_EXECSEG_JIT</h2>
            <hr />
            
            <pre><code>CS_EXECSEG_JIT</code></pre>
         </article>
         
         <article class="global" data-name="CS_EXECSEG_SKIP_LV">
            <h2>CS_EXECSEG_SKIP_LV</h2>
            <hr />
            
            <pre><code>CS_EXECSEG_SKIP_LV</code></pre>
         </article>
         
         <article class="global" data-name="CS_EXECSEG_CAN_LOAD_CDHASH">
            <h2>CS_EXECSEG_CAN_LOAD_CDHASH</h2>
            <hr />
            
            <pre><code>CS_EXECSEG_CAN_LOAD_CDHASH</code></pre>
         </article>
         
         <article class="global" data-name="CS_EXECSEG_CAN_EXEC_CDHASH">
            <h2>CS_EXECSEG_CAN_EXEC_CDHASH</h2>
            <hr />
            
            <pre><code>CS_EXECSEG_CAN_EXEC_CDHASH</code></pre>
         </article>
         
         <article class="global" data-name="blobSize">
            <h2>blobSize</h2>
            <hr />
            
            <pre><code>blobSize</code></pre>
         </article>
         
         <article class="global" data-name="superBlobSize">
            <h2>superBlobSize</h2>
            <hr />
            
            <pre><code>superBlobSize</code></pre>
         </article>
         
         <article class="global" data-name="codeDirectorySize">
            <h2>codeDirectorySize</h2>
            <hr />
            
            <pre><code>codeDirectorySize</code></pre>
         </article>
          
         <article class="struct" data-name="Blob">
            <h2>type Blob struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">typ uint32
offset uint32</code></pre>
         </article>
         
         <article class="struct" data-name="SuperBlob">
            <h2>type SuperBlob struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">magic uint32
length uint32
count uint32</code></pre>
         </article>
         
         <article class="struct" data-name="CodeDirectory">
            <h2>type CodeDirectory struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">magic uint32
length uint32
version uint32
flags uint32
hashOffset uint32
identOffset uint32
nSpecialSlots uint32
nCodeSlots uint32
codeLimit uint32
hashSize uint8
hashType uint8
_pad1 uint8
pageSize uint8
_pad2 uint32
scatterOffset uint32
teamOffset uint32
_pad3 uint32
codeLimit64 uint64
execSegBase uint64
execSegLimit uint64
execSegFlags uint64</code></pre>
         </article>
         
         <article class="struct" data-name="CodeSigCmd">
            <h2>type CodeSigCmd struct</h2>
            <hr />
            
            <p>CodeSigCmd is Mach-O LC_CODE_SIGNATURE load command.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Cmd uint32
Cmdsize uint32
Dataoff uint32
Datasize uint32</code></pre>
         </article>
          
         <article class="function" data-name="put">
            <h2>put</h2>
            <hr />
            
            <pre><code>func put(out []byte) []byte</code></pre>
         </article>
         
         <article class="function" data-name="put">
            <h2>put</h2>
            <hr />
            
            <pre><code>func put(out []byte) []byte</code></pre>
         </article>
         
         <article class="function" data-name="put">
            <h2>put</h2>
            <hr />
            
            <pre><code>func put(out []byte) []byte</code></pre>
         </article>
         
         <article class="function" data-name="FindCodeSigCmd">
            <h2>FindCodeSigCmd</h2>
            <hr />
            
            <pre><code>func FindCodeSigCmd(f *macho.File) (CodeSigCmd, bool)</code></pre>
         </article>
         
         <article class="function" data-name="put32be">
            <h2>put32be</h2>
            <hr />
            
            <pre><code>func put32be(b []byte, x uint32) []byte</code></pre>
         </article>
         
         <article class="function" data-name="put64be">
            <h2>put64be</h2>
            <hr />
            
            <pre><code>func put64be(b []byte, x uint64) []byte</code></pre>
         </article>
         
         <article class="function" data-name="put8">
            <h2>put8</h2>
            <hr />
            
            <pre><code>func put8(b []byte, x uint8) []byte</code></pre>
         </article>
         
         <article class="function" data-name="puts">
            <h2>puts</h2>
            <hr />
            
            <pre><code>func puts(b []byte, s []byte) []byte</code></pre>
         </article>
         
         <article class="function" data-name="Size">
            <h2>Size</h2>
            <hr />
            
            <p>Size computes the size of the code signature.
id is the identifier used for signing (a field in CodeDirectory blob, which
has no significance in ad-hoc signing).</p>
            
            <pre><code>func Size(codeSize int64, id string) int64</code></pre>
         </article>
         
         <article class="function" data-name="Sign">
            <h2>Sign</h2>
            <hr />
            
            <p>Sign generates an ad-hoc code signature and writes it to out.
out must have length at least Size(codeSize, id).
data is the file content without the signature, of size codeSize.
textOff and textSize is the file offset and size of the text segment.
isMain is true if this is a main executable.
id is the identifier used for signing (a field in CodeDirectory blob, which
has no significance in ad-hoc signing).</p>
            
            <pre><code>func Sign(out []byte, data io.Reader, id string, codeSize int64, textOff int64, textSize int64, isMain bool)</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
