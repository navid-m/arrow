<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - cgi</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>cgi</code>
         </h1>
         <hr />
         
         <article class="global" data-name="trailingPort">
            <h2>trailingPort</h2>
            <hr />
            
            <pre><code>trailingPort</code></pre>
         </article>
         
         <article class="global" data-name="osDefaultInheritEnv">
            <h2>osDefaultInheritEnv</h2>
            <hr />
            
            <pre><code>osDefaultInheritEnv</code></pre>
         </article>
         
         <article class="global" data-name="testHookStartProcess">
            <h2>testHookStartProcess</h2>
            <hr />
            
            <pre><code>testHookStartProcess func</code></pre>
         </article>
          
         <article class="struct" data-name="response">
            <h2>type response struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">req *http.Request
header http.Header
code int
wroteHeader bool
wroteCGIHeader bool
bufw *bufio.Writer</code></pre>
         </article>
         
         <article class="struct" data-name="Handler">
            <h2>type Handler struct</h2>
            <hr />
            
            <p>Handler runs an executable in a subprocess with a CGI environment.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Path string
Root string
Dir string
Env []string
InheritEnv []string
Logger *log.Logger
Args []string
Stderr io.Writer
PathLocationHandler http.Handler</code></pre>
         </article>
         
         <article class="struct" data-name="customWriterRecorder">
            <h2>type customWriterRecorder struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">w io.Writer
*httptest.ResponseRecorder</code></pre>
         </article>
         
         <article class="struct" data-name="limitWriter">
            <h2>type limitWriter struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">w io.Writer
n int</code></pre>
         </article>
          
         <article class="function" data-name="cgiMain">
            <h2>cgiMain</h2>
            <hr />
            
            <pre><code>func cgiMain()</code></pre>
         </article>
         
         <article class="function" data-name="testCGI">
            <h2>testCGI</h2>
            <hr />
            
            <p>testCGI is a CGI program translated from a Perl program to complete host_test.
test cases in host_test should be provided by testCGI.</p>
            
            <pre><code>func testCGI()</code></pre>
         </article>
         
         <article class="function" data-name="Read">
            <h2>Read</h2>
            <hr />
            
            <pre><code>func Read(p []byte) (n int, err error)</code></pre>
         </article>
         
         <article class="function" data-name="childCGIProcess">
            <h2>childCGIProcess</h2>
            <hr />
            
            <p>childCGIProcess is used by integration_test to complete unit tests.</p>
            
            <pre><code>func childCGIProcess()</code></pre>
         </article>
         
         <article class="function" data-name="Request">
            <h2>Request</h2>
            <hr />
            
            <p>Request returns the HTTP request as represented in the current
environment. This assumes the current program is being run
by a web server in a CGI environment.
The returned Request's Body is populated, if applicable.</p>
            
            <pre><code>func Request() (*http.Request, error)</code></pre>
         </article>
         
         <article class="function" data-name="envMap">
            <h2>envMap</h2>
            <hr />
            
            <pre><code>func envMap(env []string) *ast.MapType</code></pre>
         </article>
         
         <article class="function" data-name="RequestFromMap">
            <h2>RequestFromMap</h2>
            <hr />
            
            <p>RequestFromMap creates an [http.Request] from CGI variables.
The returned Request's Body field is not populated.</p>
            
            <pre><code>func RequestFromMap(params *ast.MapType) (*http.Request, error)</code></pre>
         </article>
         
         <article class="function" data-name="Serve">
            <h2>Serve</h2>
            <hr />
            
            <p>Serve executes the provided [Handler] on the currently active CGI
request, if any. If there's no current CGI environment
an error is returned. The provided handler may be nil to use
[http.DefaultServeMux].</p>
            
            <pre><code>func Serve(handler http.Handler) error</code></pre>
         </article>
         
         <article class="function" data-name="Flush">
            <h2>Flush</h2>
            <hr />
            
            <pre><code>func Flush()</code></pre>
         </article>
         
         <article class="function" data-name="Header">
            <h2>Header</h2>
            <hr />
            
            <pre><code>func Header() http.Header</code></pre>
         </article>
         
         <article class="function" data-name="Write">
            <h2>Write</h2>
            <hr />
            
            <pre><code>func Write(p []byte) (n int, err error)</code></pre>
         </article>
         
         <article class="function" data-name="WriteHeader">
            <h2>WriteHeader</h2>
            <hr />
            
            <pre><code>func WriteHeader(code int)</code></pre>
         </article>
         
         <article class="function" data-name="writeCGIHeader">
            <h2>writeCGIHeader</h2>
            <hr />
            
            <p>writeCGIHeader finalizes the header sent to the client and writes it to the output.
p is not written by writeHeader, but is the first chunk of the body
that will be written. It is sniffed for a Content-Type if none is
set explicitly.</p>
            
            <pre><code>func writeCGIHeader(p []byte)</code></pre>
         </article>
         
         <article class="function" data-name="TestRequest">
            <h2>TestRequest</h2>
            <hr />
            
            <pre><code>func TestRequest(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestRequestWithTLS">
            <h2>TestRequestWithTLS</h2>
            <hr />
            
            <pre><code>func TestRequestWithTLS(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestRequestWithoutHost">
            <h2>TestRequestWithoutHost</h2>
            <hr />
            
            <pre><code>func TestRequestWithoutHost(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestRequestWithoutRequestURI">
            <h2>TestRequestWithoutRequestURI</h2>
            <hr />
            
            <pre><code>func TestRequestWithoutRequestURI(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestRequestWithoutRemotePort">
            <h2>TestRequestWithoutRemotePort</h2>
            <hr />
            
            <pre><code>func TestRequestWithoutRemotePort(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestResponse">
            <h2>TestResponse</h2>
            <hr />
            
            <pre><code>func TestResponse(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="stderr">
            <h2>stderr</h2>
            <hr />
            
            <pre><code>func stderr() io.Writer</code></pre>
         </article>
         
         <article class="function" data-name="removeLeadingDuplicates">
            <h2>removeLeadingDuplicates</h2>
            <hr />
            
            <p>removeLeadingDuplicates remove leading duplicate in environments.
It's possible to override environment like following.

	cgi.Handler{
	  ...
	  Env: []string{"SCRIPT_FILENAME=foo.php"},
	}</p>
            
            <pre><code>func removeLeadingDuplicates(env []string) ret []string</code></pre>
         </article>
         
         <article class="function" data-name="ServeHTTP">
            <h2>ServeHTTP</h2>
            <hr />
            
            <pre><code>func ServeHTTP(rw http.ResponseWriter, req *http.Request)</code></pre>
         </article>
         
         <article class="function" data-name="printf">
            <h2>printf</h2>
            <hr />
            
            <pre><code>func printf(format string, v ...any)</code></pre>
         </article>
         
         <article class="function" data-name="handleInternalRedirect">
            <h2>handleInternalRedirect</h2>
            <hr />
            
            <pre><code>func handleInternalRedirect(rw http.ResponseWriter, req *http.Request, path string)</code></pre>
         </article>
         
         <article class="function" data-name="upperCaseAndUnderscore">
            <h2>upperCaseAndUnderscore</h2>
            <hr />
            
            <pre><code>func upperCaseAndUnderscore(r rune) rune</code></pre>
         </article>
         
         <article class="function" data-name="TestMain">
            <h2>TestMain</h2>
            <hr />
            
            <p>TestMain executes the test binary as the cgi server if
SERVER_SOFTWARE is set, and runs the tests otherwise.</p>
            
            <pre><code>func TestMain(m *testing.M)</code></pre>
         </article>
         
         <article class="function" data-name="newRequest">
            <h2>newRequest</h2>
            <hr />
            
            <pre><code>func newRequest(httpreq string) *http.Request</code></pre>
         </article>
         
         <article class="function" data-name="runCgiTest">
            <h2>runCgiTest</h2>
            <hr />
            
            <pre><code>func runCgiTest(t *testing.T, h *Handler, httpreq string, expectedMap *ast.MapType, checks ...func) *httptest.ResponseRecorder</code></pre>
         </article>
         
         <article class="function" data-name="runResponseChecks">
            <h2>runResponseChecks</h2>
            <hr />
            
            <pre><code>func runResponseChecks(t *testing.T, rw *httptest.ResponseRecorder, expectedMap *ast.MapType, checks ...func)</code></pre>
         </article>
         
         <article class="function" data-name="TestCGIBasicGet">
            <h2>TestCGIBasicGet</h2>
            <hr />
            
            <pre><code>func TestCGIBasicGet(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestCGIEnvIPv6">
            <h2>TestCGIEnvIPv6</h2>
            <hr />
            
            <pre><code>func TestCGIEnvIPv6(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestCGIBasicGetAbsPath">
            <h2>TestCGIBasicGetAbsPath</h2>
            <hr />
            
            <pre><code>func TestCGIBasicGetAbsPath(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestPathInfo">
            <h2>TestPathInfo</h2>
            <hr />
            
            <pre><code>func TestPathInfo(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestPathInfoDirRoot">
            <h2>TestPathInfoDirRoot</h2>
            <hr />
            
            <pre><code>func TestPathInfoDirRoot(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestDupHeaders">
            <h2>TestDupHeaders</h2>
            <hr />
            
            <pre><code>func TestDupHeaders(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestDropProxyHeader">
            <h2>TestDropProxyHeader</h2>
            <hr />
            
            <p>Issue 16405: CGI+http.Transport differing uses of HTTP_PROXY.
Verify we don't set the HTTP_PROXY environment variable.
Hope nobody was depending on it. It's not a known header, though.</p>
            
            <pre><code>func TestDropProxyHeader(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestPathInfoNoRoot">
            <h2>TestPathInfoNoRoot</h2>
            <hr />
            
            <pre><code>func TestPathInfoNoRoot(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestCGIBasicPost">
            <h2>TestCGIBasicPost</h2>
            <hr />
            
            <pre><code>func TestCGIBasicPost(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="chunk">
            <h2>chunk</h2>
            <hr />
            
            <pre><code>func chunk(s string) string</code></pre>
         </article>
         
         <article class="function" data-name="TestCGIPostChunked">
            <h2>TestCGIPostChunked</h2>
            <hr />
            
            <p>The CGI spec doesn't allow chunked requests.</p>
            
            <pre><code>func TestCGIPostChunked(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestRedirect">
            <h2>TestRedirect</h2>
            <hr />
            
            <pre><code>func TestRedirect(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestInternalRedirect">
            <h2>TestInternalRedirect</h2>
            <hr />
            
            <pre><code>func TestInternalRedirect(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestCopyError">
            <h2>TestCopyError</h2>
            <hr />
            
            <p>TestCopyError tests that we kill the process if there's an error copying
its output. (for example, from the client having gone away)

If we fail to do so, the test will time out (and dump its goroutines) with a
call to [Handler.ServeHTTP] blocked on a deferred call to [exec.Cmd.Wait].</p>
            
            <pre><code>func TestCopyError(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="handlerRunning">
            <h2>handlerRunning</h2>
            <hr />
            
            <p>handlerRunning reports whether any goroutine is currently running
[Handler.ServeHTTP].</p>
            
            <pre><code>func handlerRunning() bool</code></pre>
         </article>
         
         <article class="function" data-name="TestDir">
            <h2>TestDir</h2>
            <hr />
            
            <pre><code>func TestDir(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestEnvOverride">
            <h2>TestEnvOverride</h2>
            <hr />
            
            <pre><code>func TestEnvOverride(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestHandlerStderr">
            <h2>TestHandlerStderr</h2>
            <hr />
            
            <pre><code>func TestHandlerStderr(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestRemoveLeadingDuplicates">
            <h2>TestRemoveLeadingDuplicates</h2>
            <hr />
            
            <pre><code>func TestRemoveLeadingDuplicates(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestHostingOurselves">
            <h2>TestHostingOurselves</h2>
            <hr />
            
            <p>This test is a CGI host (testing host.go) that runs its own binary
as a child process testing the other half of CGI (child.go).</p>
            
            <pre><code>func TestHostingOurselves(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="Write">
            <h2>Write</h2>
            <hr />
            
            <pre><code>func Write(p []byte) (n int, err error)</code></pre>
         </article>
         
         <article class="function" data-name="Write">
            <h2>Write</h2>
            <hr />
            
            <pre><code>func Write(p []byte) (n int, err error)</code></pre>
         </article>
         
         <article class="function" data-name="TestKillChildAfterCopyError">
            <h2>TestKillChildAfterCopyError</h2>
            <hr />
            
            <p>If there's an error copying the child's output to the parent, test
that we kill the child.</p>
            
            <pre><code>func TestKillChildAfterCopyError(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestChildOnlyHeaders">
            <h2>TestChildOnlyHeaders</h2>
            <hr />
            
            <p>Test that a child handler writing only headers works.
golang.org/issue/7196</p>
            
            <pre><code>func TestChildOnlyHeaders(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestNilRequestBody">
            <h2>TestNilRequestBody</h2>
            <hr />
            
            <p>Test that a child handler does not receive a nil Request Body.
golang.org/issue/39190</p>
            
            <pre><code>func TestNilRequestBody(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestChildContentType">
            <h2>TestChildContentType</h2>
            <hr />
            
            <pre><code>func TestChildContentType(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="Test500WithNoHeaders">
            <h2>Test500WithNoHeaders</h2>
            <hr />
            
            <p>golang.org/issue/7198</p>
            
            <pre><code>func Test500WithNoHeaders(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="Test500WithNoContentType">
            <h2>Test500WithNoContentType</h2>
            <hr />
            
            <pre><code>func Test500WithNoContentType(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="Test500WithEmptyHeaders">
            <h2>Test500WithEmptyHeaders</h2>
            <hr />
            
            <pre><code>func Test500WithEmptyHeaders(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="want500Test">
            <h2>want500Test</h2>
            <hr />
            
            <pre><code>func want500Test(t *testing.T, path string)</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
