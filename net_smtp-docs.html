<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - smtp</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>smtp</code>
         </h1>
         <hr />
         
         <article class="global" data-name="testHookStartTLS">
            <h2>testHookStartTLS</h2>
            <hr />
            
            <pre><code>testHookStartTLS func</code></pre>
         </article>
         
         <article class="global" data-name="authTests">
            <h2>authTests</h2>
            <hr />
            
            <pre><code>authTests</code></pre>
         </article>
         
         <article class="global" data-name="basicServer">
            <h2>basicServer</h2>
            <hr />
            
            <pre><code>basicServer</code></pre>
         </article>
         
         <article class="global" data-name="basicClient">
            <h2>basicClient</h2>
            <hr />
            
            <pre><code>basicClient</code></pre>
         </article>
         
         <article class="global" data-name="newClientServer">
            <h2>newClientServer</h2>
            <hr />
            
            <pre><code>newClientServer</code></pre>
         </article>
         
         <article class="global" data-name="newClientClient">
            <h2>newClientClient</h2>
            <hr />
            
            <pre><code>newClientClient</code></pre>
         </article>
         
         <article class="global" data-name="newClient2Server">
            <h2>newClient2Server</h2>
            <hr />
            
            <pre><code>newClient2Server</code></pre>
         </article>
         
         <article class="global" data-name="newClient2Client">
            <h2>newClient2Client</h2>
            <hr />
            
            <pre><code>newClient2Client</code></pre>
         </article>
         
         <article class="global" data-name="baseHelloServer">
            <h2>baseHelloServer</h2>
            <hr />
            
            <pre><code>baseHelloServer</code></pre>
         </article>
         
         <article class="global" data-name="helloServer">
            <h2>helloServer</h2>
            <hr />
            
            <pre><code>helloServer</code></pre>
         </article>
         
         <article class="global" data-name="baseHelloClient">
            <h2>baseHelloClient</h2>
            <hr />
            
            <pre><code>baseHelloClient</code></pre>
         </article>
         
         <article class="global" data-name="helloClient">
            <h2>helloClient</h2>
            <hr />
            
            <pre><code>helloClient</code></pre>
         </article>
         
         <article class="global" data-name="sendMailServer">
            <h2>sendMailServer</h2>
            <hr />
            
            <pre><code>sendMailServer</code></pre>
         </article>
         
         <article class="global" data-name="sendMailClient">
            <h2>sendMailClient</h2>
            <hr />
            
            <pre><code>sendMailClient</code></pre>
         </article>
         
         <article class="global" data-name="authFailedServer">
            <h2>authFailedServer</h2>
            <hr />
            
            <pre><code>authFailedServer</code></pre>
         </article>
         
         <article class="global" data-name="authFailedClient">
            <h2>authFailedClient</h2>
            <hr />
            
            <pre><code>authFailedClient</code></pre>
         </article>
         
         <article class="global" data-name="localhostCert">
            <h2>localhostCert</h2>
            <hr />
            
            <p>localhostCert is a PEM-encoded TLS cert generated from src/crypto/tls:

	go run generate_cert.go --rsa-bits 1024 --host 127.0.0.1,::1,example.com \
		--ca --start-date "Jan 1 00:00:00 1970" --duration=1000000h</p>
            
            <pre><code>localhostCert</code></pre>
         </article>
         
         <article class="global" data-name="localhostKey">
            <h2>localhostKey</h2>
            <hr />
            
            <p>localhostKey is the private key for localhostCert.</p>
            
            <pre><code>localhostKey</code></pre>
         </article>
          
         <article class="struct" data-name="ServerInfo">
            <h2>type ServerInfo struct</h2>
            <hr />
            
            <p>ServerInfo records information about an SMTP server.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Name string
TLS bool
Auth []string</code></pre>
         </article>
         
         <article class="struct" data-name="plainAuth">
            <h2>type plainAuth struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">identity string
username string
password string
host string</code></pre>
         </article>
         
         <article class="struct" data-name="cramMD5Auth">
            <h2>type cramMD5Auth struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">username string
secret string</code></pre>
         </article>
         
         <article class="struct" data-name="Client">
            <h2>type Client struct</h2>
            <hr />
            
            <p>A Client represents a client connection to an SMTP server.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Text *textproto.Conn
conn net.Conn
tls bool
serverName string
ext *ast.MapType
auth []string
localName string
didHello bool
helloError error</code></pre>
         </article>
         
         <article class="struct" data-name="dataCloser">
            <h2>type dataCloser struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">c *Client
io.WriteCloser</code></pre>
         </article>
         
         <article class="struct" data-name="authTest">
            <h2>type authTest struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">auth Auth
challenges []string
name string
responses []string</code></pre>
         </article>
         
         <article class="struct" data-name="toServerEmptyAuth">
            <h2>type toServerEmptyAuth struct</h2>
            <hr />
            
            <p>toServerEmptyAuth is an implementation of Auth that only implements
the Start method, and returns "FOOAUTH", nil, nil. Notably, it returns
zero bytes for "toServer" so we can test that we don't send spaces at
the end of the line. See TestClientAuthTrimSpace.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code"></code></pre>
         </article>
         
         <article class="struct" data-name="faker">
            <h2>type faker struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">io.ReadWriter</code></pre>
         </article>
         
         <article class="struct" data-name="smtpSender">
            <h2>type smtpSender struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">w io.Writer</code></pre>
         </article>
          
         <article class="function" data-name="PlainAuth">
            <h2>PlainAuth</h2>
            <hr />
            
            <p>PlainAuth returns an [Auth] that implements the PLAIN authentication
mechanism as defined in RFC 4616. The returned Auth uses the given
username and password to authenticate to host and act as identity.
Usually identity should be the empty string, to act as username.

PlainAuth will only send the credentials if the connection is using TLS
or is connected to localhost. Otherwise authentication will fail with an
error, without sending the credentials.</p>
            
            <pre><code>func PlainAuth(identity string, username string, password string, host string) Auth</code></pre>
         </article>
         
         <article class="function" data-name="isLocalhost">
            <h2>isLocalhost</h2>
            <hr />
            
            <pre><code>func isLocalhost(name string) bool</code></pre>
         </article>
         
         <article class="function" data-name="Start">
            <h2>Start</h2>
            <hr />
            
            <pre><code>func Start(server *ServerInfo) (string, []byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="Next">
            <h2>Next</h2>
            <hr />
            
            <pre><code>func Next(fromServer []byte, more bool) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="CRAMMD5Auth">
            <h2>CRAMMD5Auth</h2>
            <hr />
            
            <p>CRAMMD5Auth returns an [Auth] that implements the CRAM-MD5 authentication
mechanism as defined in RFC 2195.
The returned Auth uses the given username and secret to authenticate
to the server using the challenge-response mechanism.</p>
            
            <pre><code>func CRAMMD5Auth(username string, secret string) Auth</code></pre>
         </article>
         
         <article class="function" data-name="Start">
            <h2>Start</h2>
            <hr />
            
            <pre><code>func Start(server *ServerInfo) (string, []byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="Next">
            <h2>Next</h2>
            <hr />
            
            <pre><code>func Next(fromServer []byte, more bool) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="Dial">
            <h2>Dial</h2>
            <hr />
            
            <p>Dial returns a new [Client] connected to an SMTP server at addr.
The addr must include a port, as in "mail.example.com:smtp".</p>
            
            <pre><code>func Dial(addr string) (*Client, error)</code></pre>
         </article>
         
         <article class="function" data-name="NewClient">
            <h2>NewClient</h2>
            <hr />
            
            <p>NewClient returns a new [Client] using an existing connection and host as a
server name to be used when authenticating.</p>
            
            <pre><code>func NewClient(conn net.Conn, host string) (*Client, error)</code></pre>
         </article>
         
         <article class="function" data-name="Close">
            <h2>Close</h2>
            <hr />
            
            <p>Close closes the connection.</p>
            
            <pre><code>func Close() error</code></pre>
         </article>
         
         <article class="function" data-name="hello">
            <h2>hello</h2>
            <hr />
            
            <p>hello runs a hello exchange if needed.</p>
            
            <pre><code>func hello() error</code></pre>
         </article>
         
         <article class="function" data-name="Hello">
            <h2>Hello</h2>
            <hr />
            
            <p>Hello sends a HELO or EHLO to the server as the given host name.
Calling this method is only necessary if the client needs control
over the host name used. The client will introduce itself as "localhost"
automatically otherwise. If Hello is called, it must be called before
any of the other methods.</p>
            
            <pre><code>func Hello(localName string) error</code></pre>
         </article>
         
         <article class="function" data-name="cmd">
            <h2>cmd</h2>
            <hr />
            
            <p>cmd is a convenience function that sends a command and returns the response</p>
            
            <pre><code>func cmd(expectCode int, format string, args ...any) (int, string, error)</code></pre>
         </article>
         
         <article class="function" data-name="helo">
            <h2>helo</h2>
            <hr />
            
            <p>helo sends the HELO greeting to the server. It should be used only when the
server does not support ehlo.</p>
            
            <pre><code>func helo() error</code></pre>
         </article>
         
         <article class="function" data-name="ehlo">
            <h2>ehlo</h2>
            <hr />
            
            <p>ehlo sends the EHLO (extended hello) greeting to the server. It
should be the preferred greeting for servers that support it.</p>
            
            <pre><code>func ehlo() error</code></pre>
         </article>
         
         <article class="function" data-name="StartTLS">
            <h2>StartTLS</h2>
            <hr />
            
            <p>StartTLS sends the STARTTLS command and encrypts all further communication.
Only servers that advertise the STARTTLS extension support this function.</p>
            
            <pre><code>func StartTLS(config *tls.Config) error</code></pre>
         </article>
         
         <article class="function" data-name="TLSConnectionState">
            <h2>TLSConnectionState</h2>
            <hr />
            
            <p>TLSConnectionState returns the client's TLS connection state.
The return values are their zero values if [Client.StartTLS] did
not succeed.</p>
            
            <pre><code>func TLSConnectionState() (state tls.ConnectionState, ok bool)</code></pre>
         </article>
         
         <article class="function" data-name="Verify">
            <h2>Verify</h2>
            <hr />
            
            <p>Verify checks the validity of an email address on the server.
If Verify returns nil, the address is valid. A non-nil return
does not necessarily indicate an invalid address. Many servers
will not verify addresses for security reasons.</p>
            
            <pre><code>func Verify(addr string) error</code></pre>
         </article>
         
         <article class="function" data-name="Auth">
            <h2>Auth</h2>
            <hr />
            
            <p>Auth authenticates a client using the provided authentication mechanism.
A failed authentication closes the connection.
Only servers that advertise the AUTH extension support this function.</p>
            
            <pre><code>func Auth(a Auth) error</code></pre>
         </article>
         
         <article class="function" data-name="Mail">
            <h2>Mail</h2>
            <hr />
            
            <p>Mail issues a MAIL command to the server using the provided email address.
If the server supports the 8BITMIME extension, Mail adds the BODY=8BITMIME
parameter. If the server supports the SMTPUTF8 extension, Mail adds the
SMTPUTF8 parameter.
This initiates a mail transaction and is followed by one or more [Client.Rcpt] calls.</p>
            
            <pre><code>func Mail(from string) error</code></pre>
         </article>
         
         <article class="function" data-name="Rcpt">
            <h2>Rcpt</h2>
            <hr />
            
            <p>Rcpt issues a RCPT command to the server using the provided email address.
A call to Rcpt must be preceded by a call to [Client.Mail] and may be followed by
a [Client.Data] call or another Rcpt call.</p>
            
            <pre><code>func Rcpt(to string) error</code></pre>
         </article>
         
         <article class="function" data-name="Close">
            <h2>Close</h2>
            <hr />
            
            <pre><code>func Close() error</code></pre>
         </article>
         
         <article class="function" data-name="Data">
            <h2>Data</h2>
            <hr />
            
            <p>Data issues a DATA command to the server and returns a writer that
can be used to write the mail headers and body. The caller should
close the writer before calling any more methods on c. A call to
Data must be preceded by one or more calls to [Client.Rcpt].</p>
            
            <pre><code>func Data() (io.WriteCloser, error)</code></pre>
         </article>
         
         <article class="function" data-name="SendMail">
            <h2>SendMail</h2>
            <hr />
            
            <p>SendMail connects to the server at addr, switches to TLS if
possible, authenticates with the optional mechanism a if possible,
and then sends an email from address from, to addresses to, with
message msg.
The addr must include a port, as in "mail.example.com:smtp".

The addresses in the to parameter are the SMTP RCPT addresses.

The msg parameter should be an RFC 822-style email with headers
first, a blank line, and then the message body. The lines of msg
should be CRLF terminated. The msg headers should usually include
fields such as "From", "To", "Subject", and "Cc".  Sending "Bcc"
messages is accomplished by including an email address in the to
parameter but not including it in the msg headers.

The SendMail function and the net/smtp package are low-level
mechanisms and provide no support for DKIM signing, MIME
attachments (see the mime/multipart package), or other mail
functionality. Higher-level packages exist outside of the standard
library.</p>
            
            <pre><code>func SendMail(addr string, a Auth, from string, to []string, msg []byte) error</code></pre>
         </article>
         
         <article class="function" data-name="Extension">
            <h2>Extension</h2>
            <hr />
            
            <p>Extension reports whether an extension is support by the server.
The extension name is case-insensitive. If the extension is supported,
Extension also returns a string that contains any parameters the
server specifies for the extension.</p>
            
            <pre><code>func Extension(ext string) (bool, string)</code></pre>
         </article>
         
         <article class="function" data-name="Reset">
            <h2>Reset</h2>
            <hr />
            
            <p>Reset sends the RSET command to the server, aborting the current mail
transaction.</p>
            
            <pre><code>func Reset() error</code></pre>
         </article>
         
         <article class="function" data-name="Noop">
            <h2>Noop</h2>
            <hr />
            
            <p>Noop sends the NOOP command to the server. It does nothing but check
that the connection to the server is okay.</p>
            
            <pre><code>func Noop() error</code></pre>
         </article>
         
         <article class="function" data-name="Quit">
            <h2>Quit</h2>
            <hr />
            
            <p>Quit sends the QUIT command and closes the connection to the server.</p>
            
            <pre><code>func Quit() error</code></pre>
         </article>
         
         <article class="function" data-name="validateLine">
            <h2>validateLine</h2>
            <hr />
            
            <p>validateLine checks to see if a line has CR or LF as per RFC 5321.</p>
            
            <pre><code>func validateLine(line string) error</code></pre>
         </article>
         
         <article class="function" data-name="TestAuth">
            <h2>TestAuth</h2>
            <hr />
            
            <pre><code>func TestAuth(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestAuthPlain">
            <h2>TestAuthPlain</h2>
            <hr />
            
            <pre><code>func TestAuthPlain(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestClientAuthTrimSpace">
            <h2>TestClientAuthTrimSpace</h2>
            <hr />
            
            <p>Issue 17794: don't send a trailing space on AUTH command when there's no password.</p>
            
            <pre><code>func TestClientAuthTrimSpace(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="Start">
            <h2>Start</h2>
            <hr />
            
            <pre><code>func Start(server *ServerInfo) (proto string, toServer []byte, err error)</code></pre>
         </article>
         
         <article class="function" data-name="Next">
            <h2>Next</h2>
            <hr />
            
            <pre><code>func Next(fromServer []byte, more bool) (toServer []byte, err error)</code></pre>
         </article>
         
         <article class="function" data-name="Close">
            <h2>Close</h2>
            <hr />
            
            <pre><code>func Close() error</code></pre>
         </article>
         
         <article class="function" data-name="LocalAddr">
            <h2>LocalAddr</h2>
            <hr />
            
            <pre><code>func LocalAddr() net.Addr</code></pre>
         </article>
         
         <article class="function" data-name="RemoteAddr">
            <h2>RemoteAddr</h2>
            <hr />
            
            <pre><code>func RemoteAddr() net.Addr</code></pre>
         </article>
         
         <article class="function" data-name="SetDeadline">
            <h2>SetDeadline</h2>
            <hr />
            
            <pre><code>func SetDeadline(time.Time) error</code></pre>
         </article>
         
         <article class="function" data-name="SetReadDeadline">
            <h2>SetReadDeadline</h2>
            <hr />
            
            <pre><code>func SetReadDeadline(time.Time) error</code></pre>
         </article>
         
         <article class="function" data-name="SetWriteDeadline">
            <h2>SetWriteDeadline</h2>
            <hr />
            
            <pre><code>func SetWriteDeadline(time.Time) error</code></pre>
         </article>
         
         <article class="function" data-name="TestBasic">
            <h2>TestBasic</h2>
            <hr />
            
            <pre><code>func TestBasic(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestHELOFailed">
            <h2>TestHELOFailed</h2>
            <hr />
            
            <pre><code>func TestHELOFailed(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestExtensions">
            <h2>TestExtensions</h2>
            <hr />
            
            <pre><code>func TestExtensions(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestNewClient">
            <h2>TestNewClient</h2>
            <hr />
            
            <pre><code>func TestNewClient(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestNewClient2">
            <h2>TestNewClient2</h2>
            <hr />
            
            <pre><code>func TestNewClient2(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestNewClientWithTLS">
            <h2>TestNewClientWithTLS</h2>
            <hr />
            
            <pre><code>func TestNewClientWithTLS(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestHello">
            <h2>TestHello</h2>
            <hr />
            
            <pre><code>func TestHello(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestSendMail">
            <h2>TestSendMail</h2>
            <hr />
            
            <pre><code>func TestSendMail(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestSendMailWithAuth">
            <h2>TestSendMailWithAuth</h2>
            <hr />
            
            <pre><code>func TestSendMailWithAuth(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestAuthFailed">
            <h2>TestAuthFailed</h2>
            <hr />
            
            <pre><code>func TestAuthFailed(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestTLSClient">
            <h2>TestTLSClient</h2>
            <hr />
            
            <pre><code>func TestTLSClient(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestTLSConnState">
            <h2>TestTLSConnState</h2>
            <hr />
            
            <pre><code>func TestTLSConnState(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="newLocalListener">
            <h2>newLocalListener</h2>
            <hr />
            
            <pre><code>func newLocalListener(t *testing.T) net.Listener</code></pre>
         </article>
         
         <article class="function" data-name="send">
            <h2>send</h2>
            <hr />
            
            <pre><code>func send(f string)</code></pre>
         </article>
         
         <article class="function" data-name="serverHandle">
            <h2>serverHandle</h2>
            <hr />
            
            <p>smtp server, finely tailored to deal with our own client only!</p>
            
            <pre><code>func serverHandle(c net.Conn, t *testing.T) error</code></pre>
         </article>
         
         <article class="function" data-name="serverHandleTLS">
            <h2>serverHandleTLS</h2>
            <hr />
            
            <pre><code>func serverHandleTLS(c net.Conn, t *testing.T) error</code></pre>
         </article>
         
         <article class="function" data-name="init">
            <h2>init</h2>
            <hr />
            
            <pre><code>func init()</code></pre>
         </article>
         
         <article class="function" data-name="sendMail">
            <h2>sendMail</h2>
            <hr />
            
            <pre><code>func sendMail(hostPort string) error</code></pre>
         </article>
         
         <article class="function" data-name="testingKey">
            <h2>testingKey</h2>
            <hr />
            
            <pre><code>func testingKey(s string) string</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
