<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - note</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>note</code>
         </h1>
         <hr />
         
         <article class="global" data-name="errVerifierID">
            <h2>errVerifierID</h2>
            <hr />
            
            <pre><code>errVerifierID</code></pre>
         </article>
         
         <article class="global" data-name="errVerifierAlg">
            <h2>errVerifierAlg</h2>
            <hr />
            
            <pre><code>errVerifierAlg</code></pre>
         </article>
         
         <article class="global" data-name="errVerifierHash">
            <h2>errVerifierHash</h2>
            <hr />
            
            <pre><code>errVerifierHash</code></pre>
         </article>
         
         <article class="global" data-name="algEd25519">
            <h2>algEd25519</h2>
            <hr />
            
            <pre><code>algEd25519</code></pre>
         </article>
         
         <article class="global" data-name="errSignerID">
            <h2>errSignerID</h2>
            <hr />
            
            <pre><code>errSignerID</code></pre>
         </article>
         
         <article class="global" data-name="errSignerAlg">
            <h2>errSignerAlg</h2>
            <hr />
            
            <pre><code>errSignerAlg</code></pre>
         </article>
         
         <article class="global" data-name="errSignerHash">
            <h2>errSignerHash</h2>
            <hr />
            
            <pre><code>errSignerHash</code></pre>
         </article>
         
         <article class="global" data-name="errMalformedNote">
            <h2>errMalformedNote</h2>
            <hr />
            
            <pre><code>errMalformedNote</code></pre>
         </article>
         
         <article class="global" data-name="errInvalidSigner">
            <h2>errInvalidSigner</h2>
            <hr />
            
            <pre><code>errInvalidSigner</code></pre>
         </article>
         
         <article class="global" data-name="errMismatchedVerifier">
            <h2>errMismatchedVerifier</h2>
            <hr />
            
            <pre><code>errMismatchedVerifier</code></pre>
         </article>
         
         <article class="global" data-name="sigSplit">
            <h2>sigSplit</h2>
            <hr />
            
            <pre><code>sigSplit</code></pre>
         </article>
         
         <article class="global" data-name="sigPrefix">
            <h2>sigPrefix</h2>
            <hr />
            
            <pre><code>sigPrefix</code></pre>
         </article>
          
         <article class="struct" data-name="verifier">
            <h2>type verifier struct</h2>
            <hr />
            
            <p>verifier is a trivial Verifier implementation.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">name string
hash uint32
verify func</code></pre>
         </article>
         
         <article class="struct" data-name="signer">
            <h2>type signer struct</h2>
            <hr />
            
            <p>signer is a trivial Signer implementation.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">name string
hash uint32
sign func</code></pre>
         </article>
         
         <article class="struct" data-name="UnknownVerifierError">
            <h2>type UnknownVerifierError struct</h2>
            <hr />
            
            <p>An UnknownVerifierError indicates that the given key is not known.
The Open function records signatures without associated verifiers as
unverified signatures.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Name string
KeyHash uint32</code></pre>
         </article>
         
         <article class="struct" data-name="ambiguousVerifierError">
            <h2>type ambiguousVerifierError struct</h2>
            <hr />
            
            <p>An ambiguousVerifierError indicates that the given name and hash
match multiple keys passed to [VerifierList].
(If this happens, some malicious actor has taken control of the
verifier list, at which point we may as well give up entirely,
but we diagnose the problem instead.)</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">name string
hash uint32</code></pre>
         </article>
         
         <article class="struct" data-name="nameHash">
            <h2>type nameHash struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">name string
hash uint32</code></pre>
         </article>
         
         <article class="struct" data-name="Note">
            <h2>type Note struct</h2>
            <hr />
            
            <p>A Note is a text and signatures.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Text string
Sigs []Signature
UnverifiedSigs []Signature</code></pre>
         </article>
         
         <article class="struct" data-name="Signature">
            <h2>type Signature struct</h2>
            <hr />
            
            <p>A Signature is a single signature found in a note.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Name string
Hash uint32
Base64 string</code></pre>
         </article>
         
         <article class="struct" data-name="UnverifiedNoteError">
            <h2>type UnverifiedNoteError struct</h2>
            <hr />
            
            <p>An UnverifiedNoteError indicates that the note
successfully parsed but had no verifiable signatures.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Note *Note</code></pre>
         </article>
         
         <article class="struct" data-name="InvalidSignatureError">
            <h2>type InvalidSignatureError struct</h2>
            <hr />
            
            <p>An InvalidSignatureError indicates that the given key was known
and the associated Verifier rejected the signature.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Name string
Hash uint32</code></pre>
         </article>
          
         <article class="function" data-name="keyHash">
            <h2>keyHash</h2>
            <hr />
            
            <p>keyHash computes the key hash for the given server name and encoded public key.</p>
            
            <pre><code>func keyHash(name string, key []byte) uint32</code></pre>
         </article>
         
         <article class="function" data-name="isValidName">
            <h2>isValidName</h2>
            <hr />
            
            <p>isValidName reports whether name is valid.
It must be non-empty and not have any Unicode spaces or pluses.</p>
            
            <pre><code>func isValidName(name string) bool</code></pre>
         </article>
         
         <article class="function" data-name="NewVerifier">
            <h2>NewVerifier</h2>
            <hr />
            
            <p>NewVerifier construct a new [Verifier] from an encoded verifier key.</p>
            
            <pre><code>func NewVerifier(vkey string) (Verifier, error)</code></pre>
         </article>
         
         <article class="function" data-name="chop">
            <h2>chop</h2>
            <hr />
            
            <p>chop chops s at the first instance of sep, if any,
and returns the text before and after sep.
If sep is not present, chop returns before is s and after is empty.</p>
            
            <pre><code>func chop(s string, sep string) (before string, after string)</code></pre>
         </article>
         
         <article class="function" data-name="Name">
            <h2>Name</h2>
            <hr />
            
            <pre><code>func Name() string</code></pre>
         </article>
         
         <article class="function" data-name="KeyHash">
            <h2>KeyHash</h2>
            <hr />
            
            <pre><code>func KeyHash() uint32</code></pre>
         </article>
         
         <article class="function" data-name="Verify">
            <h2>Verify</h2>
            <hr />
            
            <pre><code>func Verify(msg []byte, sig []byte) bool</code></pre>
         </article>
         
         <article class="function" data-name="NewSigner">
            <h2>NewSigner</h2>
            <hr />
            
            <p>NewSigner constructs a new [Signer] from an encoded signer key.</p>
            
            <pre><code>func NewSigner(skey string) (Signer, error)</code></pre>
         </article>
         
         <article class="function" data-name="Name">
            <h2>Name</h2>
            <hr />
            
            <pre><code>func Name() string</code></pre>
         </article>
         
         <article class="function" data-name="KeyHash">
            <h2>KeyHash</h2>
            <hr />
            
            <pre><code>func KeyHash() uint32</code></pre>
         </article>
         
         <article class="function" data-name="Sign">
            <h2>Sign</h2>
            <hr />
            
            <pre><code>func Sign(msg []byte) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="GenerateKey">
            <h2>GenerateKey</h2>
            <hr />
            
            <p>GenerateKey generates a signer and verifier key pair for a named server.
The signer key skey is private and must be kept secret.</p>
            
            <pre><code>func GenerateKey(rand io.Reader, name string) (skey string, vkey string, err error)</code></pre>
         </article>
         
         <article class="function" data-name="NewEd25519VerifierKey">
            <h2>NewEd25519VerifierKey</h2>
            <hr />
            
            <p>NewEd25519VerifierKey returns an encoded verifier key using the given name
and Ed25519 public key.</p>
            
            <pre><code>func NewEd25519VerifierKey(name string, key ed25519.PublicKey) (string, error)</code></pre>
         </article>
         
         <article class="function" data-name="Error">
            <h2>Error</h2>
            <hr />
            
            <pre><code>func Error() string</code></pre>
         </article>
         
         <article class="function" data-name="Error">
            <h2>Error</h2>
            <hr />
            
            <pre><code>func Error() string</code></pre>
         </article>
         
         <article class="function" data-name="VerifierList">
            <h2>VerifierList</h2>
            <hr />
            
            <p>VerifierList returns a [Verifiers] implementation that uses the given list of verifiers.</p>
            
            <pre><code>func VerifierList(list ...Verifier) Verifiers</code></pre>
         </article>
         
         <article class="function" data-name="Verifier">
            <h2>Verifier</h2>
            <hr />
            
            <pre><code>func Verifier(name string, hash uint32) (Verifier, error)</code></pre>
         </article>
         
         <article class="function" data-name="Error">
            <h2>Error</h2>
            <hr />
            
            <pre><code>func Error() string</code></pre>
         </article>
         
         <article class="function" data-name="Error">
            <h2>Error</h2>
            <hr />
            
            <pre><code>func Error() string</code></pre>
         </article>
         
         <article class="function" data-name="Open">
            <h2>Open</h2>
            <hr />
            
            <p>Open opens and parses the message msg, checking signatures from the known verifiers.

For each signature in the message, Open calls known.Verifier to find a verifier.
If known.Verifier returns a verifier and the verifier accepts the signature,
Open records the signature in the returned note's Sigs field.
If known.Verifier returns a verifier but the verifier rejects the signature,
Open returns an InvalidSignatureError.
If known.Verifier returns an UnknownVerifierError,
Open records the signature in the returned note's UnverifiedSigs field.
If known.Verifier returns any other error, Open returns that error.

If no known verifier has signed an otherwise valid note,
Open returns an [UnverifiedNoteError].
In this case, the unverified note can be fetched from inside the error.</p>
            
            <pre><code>func Open(msg []byte, known Verifiers) (*Note, error)</code></pre>
         </article>
         
         <article class="function" data-name="Sign">
            <h2>Sign</h2>
            <hr />
            
            <p>Sign signs the note with the given signers and returns the encoded message.
The new signatures from signers are listed in the encoded message after
the existing signatures already present in n.Sigs.
If any signer uses the same key as an existing signature,
the existing signature is elided from the output.</p>
            
            <pre><code>func Sign(n *Note, signers ...Signer) ([]byte, error)</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
