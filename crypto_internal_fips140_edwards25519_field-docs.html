<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - field</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 14px;
            scroll-behavior: smooth;
         }

         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
            line-height: 1.6;
         }

         .sidebar {
            width: 12%;
            background: rgba(59, 56, 56, 0.15);
            padding: 1.5rem;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.4);
            overflow-y: auto;
            position: sticky;
            top: 0;
            height: 100vh;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
         }

         .sidebar::-webkit-scrollbar {
            width: 6px;
         }

         .sidebar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
         }

         .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
         }

         main {
            flex: 1;
            padding: 2rem;
            margin: 0;
            max-width: calc(100% - 280px);
            background: linear-gradient(
               135deg,
               rgba(59, 56, 56, 0.05) 0%,
               rgba(0, 0, 0, 0.1) 100%
            );
         }

         .nav-links {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
         }

         .nav-links a {
            color: #ddd;
            text-decoration: none;
            padding: 0.5rem;
            border-radius: 4px;
            transition: all 0.2s ease;
         }

         .nav-links a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
         }

         h1 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #fff 0%, #ddd 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
         }

         h2 {
            font-size: 1.4rem;
            margin: 1rem 0 0.5rem;
            color: #f0f0f0;
         }

         h3 {
            font-size: 1.2rem;
            margin: 0.8rem 0 0.3rem;
            color: #e0e0e0;
         }

         .sidebar h2,
         .sidebar h3 {
            font-size: 1rem;
            margin: 0.5rem 0 0.3rem;
            color: #ccc;
         }

         pre {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #e6e6e6;
            padding: 1rem 1.2rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-size: 0.9rem;
            overflow-x: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
         }

         code {
            color: #f5f5f5;
            font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace;
            white-space: pre-wrap;
         }

         p {
            font-size: 15px;
            margin: 1rem 0;
            color: #ddd;
         }

         article {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(59, 56, 56, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
         }

         article:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
            transform: translateY(-2px);
         }

         .hidden {
            display: none !important;
         }

         .filter-section {
            margin-bottom: 1.5rem;
         }

         .filter-section h3 {
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #aaa;
         }

         .filter-toggle label {
            display: flex;
            align-items: center;
            margin-bottom: 0.6rem;
            font-size: 0.85rem;
            color: #bbb;
            cursor: pointer;
            padding: 0.3rem;
            border-radius: 4px;
            transition: background 0.2s ease;
         }

         .filter-toggle label:hover {
            background: rgba(255, 255, 255, 0.05);
         }

         .filter-toggle input {
            margin-right: 0.6rem;
         }

         .field-line,
         .method-line {
            display: block;
         }

         #searchInput {
            width: 100%;
            margin-bottom: 1.5rem;
            border-radius: 8px !important;
            height: 2.8rem;
            font-size: 0.9rem;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 0 1rem;
         }

         #searchInput::placeholder {
            color: rgba(255, 255, 255, 0.5);
         }

         #searchInput:focus {
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.1);
         }

         .section-divider {
            height: 1px;
            background: linear-gradient(
               90deg,
               transparent 0%,
               rgba(255, 255, 255, 0.3) 50%,
               transparent 100%
            );
            margin: 1.5rem 0;
         }

         .subpackage-list {
            list-style: none;
            padding: 0;
         }

         .subpackage-list li {
            margin-bottom: 0.4rem;
         }

         .subpackage-list a {
            display: block;
            padding: 0.5rem 0.8rem;
            color: #ccc;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-size: 0.85rem;
         }

         .subpackage-list a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            transform: translateX(4px);
         }

         .empty-state {
            color: rgba(177, 175, 175, 0.6);
            font-style: italic;
            font-size: 0.8rem;
         }

         .badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            color: #ddd;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-left: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .method-badge {
            background: rgba(100, 200, 255, 0.2);
            color: #87ceeb;
         }

         .const-badge {
            background: rgba(255, 200, 100, 0.2);
            color: #ffd700;
         }

         .var-badge {
            background: rgba(200, 255, 100, 0.2);
            color: #90ee90;
         }

         .type-badge {
            background: rgba(255, 100, 200, 0.2);
            color: #699eff;
         }

         .interface-badge {
            background: rgba(150, 100, 255, 0.2);
            color: #dda0dd;
         }

         .toc {
            position: sticky;
            top: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
         }

         .toc h4 {
            margin: 0 0 0.8rem;
            font-size: 0.9rem;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .toc ul {
            list-style: none;
            padding: 0;
            margin: 0;
         }

         .toc li {
            margin-bottom: 0.3rem;
         }

         .toc a {
            color: #bbb;
            text-decoration: none;
            font-size: 0.8rem;
            transition: color 0.2s ease;
         }

         .toc a:hover {
            color: #fff;
         }

         @media (max-width: 768px) {
            body {
               flex-direction: column;
            }

            .sidebar {
               width: 90%;
               height: auto;
               position: relative;
            }

            main {
               max-width: 100%;
               padding: 1rem;
            }
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <div class="nav-links">
            <a href="index.html" title="Home">⌂</a>
            <span>|</span>
            <a href="#" onclick="history.back()" title="Back">←</a>
         </div>

         <div class="filter-section">
            <h3>Search</h3>
            <input
               type="search"
               id="searchInput"
               placeholder="Search symbols..."
            />
         </div>

         <div class="filter-section">
            <h3>Filters</h3>
            <div class="filter-toggle">
               <label>
                  <input type="checkbox" id="showImports" />
                  Show imports
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFunctions" />
                  Show private functions
               </label>
               <label>
                  <input type="checkbox" id="showPrivateStructs" />
                  Show private structs
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFields" />
                  Show private fields
               </label>
               <label>
                  <input type="checkbox" id="showPrivateGlobals" />
                  Show private globals
               </label>
               <label>
                  <input type="checkbox" id="showPrivateTypes" />
                  Show private types
               </label>
               <label>
                  <input type="checkbox" id="showPrivateInterfaces" />
                  Show private interfaces
               </label>
            </div>
         </div>

         <div class="section-divider"></div>

         <div class="filter-section">
            <h3>Subpackages</h3>
            
            <ul class="subpackage-list">
               
               <li><a href="crypto_internal_fips140_edwards25519_field__asm-docs.html">_asm</a></li>
               
            </ul>
            
         </div>

         
         <div class="section-divider"></div>

         <div class="toc">
            <h4>Quick Navigation</h4>
            <ul>
               
               <li><a href="#globals">Constants & Variables</a></li>
                  
               <li><a href="#structs">Structs</a></li>
                
               <li><a href="#functions">Functions</a></li>
               
            </ul>
         </div>
         
      </aside>

      <main>
         <h1>field</h1>
         <div class="section-divider"></div>

         
         <section id="imports">
            <h2>Imports</h2>
            <article class="imports" data-name="imports">
               <pre><code>"math/bits"
_ "crypto/internal/fips140/check"
"crypto/internal/fips140/subtle"
"crypto/internal/fips140deps/byteorder"
"errors"
"math/bits"
</code></pre>
            </article>
         </section>
          
         <section id="globals">
            <h2>Constants & Variables</h2>
            
            <article class="global" data-name="feOne">
               <h3>
                  feOne 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var feOne = *ast.UnaryExpr</code></pre>
            </article>
            
            <article class="global" data-name="feZero">
               <h3>
                  feZero 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var feZero = *ast.UnaryExpr</code></pre>
            </article>
            
            <article class="global" data-name="maskLow51Bits">
               <h3>
                  maskLow51Bits 
                  <span class="badge const-badge">const</span>
                  
               </h3>
               
               <pre><code>const maskLow51Bits uint64 = *ast.BinaryExpr</code></pre>
            </article>
            
            <article class="global" data-name="sqrtM1">
               <h3>
                  sqrtM1 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <p>sqrtM1 is 2^((p-1)/4), which squared is equal to -1 by Euler's Criterion.</p>
               
               <pre><code>var sqrtM1 = *ast.UnaryExpr</code></pre>
            </article>
            
         </section>
            
         <section id="structs">
            <h2>Structs</h2>
            
            <article class="struct" data-name="Element">
               <h3>
                  Element
                  <span class="badge">struct</span>
               </h3>
               
               <p>Element represents an element of the field GF(2^255-19). Note that this
is not a cryptographically secure group, and should only be used to interact
with edwards25519.Point coordinates.
This type works similarly to math/big.Int, and all arguments and receivers
are allowed to alias.
The zero value is a valid zero element.</p>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type Element struct {
l0 uint64
l1 uint64
l2 uint64
l3 uint64
l4 uint64
}</code></pre>
            </article>
            
            <article class="struct" data-name="uint128">
               <h3>
                  uint128
                  <span class="badge">struct</span>
               </h3>
               
               <p>uint128 holds a 128-bit number as two 64-bit limbs, for use with the
bits.Mul64 and bits.Add64 intrinsics.</p>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type uint128 struct {
lo uint64
hi uint64
}</code></pre>
            </article>
            
         </section>
          
         <section id="functions">
            <h2>Functions</h2>
            
            <article class="function" data-name="Absolute">
               <h3>
                  Absolute 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Absolute sets v to |u|, and returns v.</p>
               
               <pre><code>func (v *Element) Absolute(u *Element) *Element</code></pre>
            </article>
            
            <article class="function" data-name="Add">
               <h3>
                  Add 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Add sets v = a + b, and returns v.</p>
               
               <pre><code>func (v *Element) Add(a *Element, b *Element) *Element</code></pre>
            </article>
            
            <article class="function" data-name="Bytes">
               <h3>
                  Bytes 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Bytes returns the canonical 32-byte little-endian encoding of v.</p>
               
               <pre><code>func (v *Element) Bytes() []byte</code></pre>
            </article>
            
            <article class="function" data-name="Equal">
               <h3>
                  Equal 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Equal returns 1 if v and u are equal, and 0 otherwise.</p>
               
               <pre><code>func (v *Element) Equal(u *Element) int</code></pre>
            </article>
            
            <article class="function" data-name="Invert">
               <h3>
                  Invert 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Invert sets v = 1/z mod p, and returns v.
If z == 0, Invert returns v = 0.</p>
               
               <pre><code>func (v *Element) Invert(z *Element) *Element</code></pre>
            </article>
            
            <article class="function" data-name="IsNegative">
               <h3>
                  IsNegative 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>IsNegative returns 1 if v is negative, and 0 otherwise.</p>
               
               <pre><code>func (v *Element) IsNegative() int</code></pre>
            </article>
            
            <article class="function" data-name="Mult32">
               <h3>
                  Mult32 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Mult32 sets v = x * y, and returns v.</p>
               
               <pre><code>func (v *Element) Mult32(x *Element, y uint32) *Element</code></pre>
            </article>
            
            <article class="function" data-name="Multiply">
               <h3>
                  Multiply 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Multiply sets v = x * y, and returns v.</p>
               
               <pre><code>func (v *Element) Multiply(x *Element, y *Element) *Element</code></pre>
            </article>
            
            <article class="function" data-name="Negate">
               <h3>
                  Negate 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Negate sets v = -a, and returns v.</p>
               
               <pre><code>func (v *Element) Negate(a *Element) *Element</code></pre>
            </article>
            
            <article class="function" data-name="One">
               <h3>
                  One 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>One sets v = 1, and returns v.</p>
               
               <pre><code>func (v *Element) One() *Element</code></pre>
            </article>
            
            <article class="function" data-name="Pow22523">
               <h3>
                  Pow22523 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Pow22523 set v = x^((p-5)/8), and returns v. (p-5)/8 is 2^252-3.</p>
               
               <pre><code>func (v *Element) Pow22523(x *Element) *Element</code></pre>
            </article>
            
            <article class="function" data-name="Select">
               <h3>
                  Select 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Select sets v to a if cond == 1, and to b if cond == 0.</p>
               
               <pre><code>func (v *Element) Select(a *Element, b *Element, cond int) *Element</code></pre>
            </article>
            
            <article class="function" data-name="Set">
               <h3>
                  Set 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Set sets v = a, and returns v.</p>
               
               <pre><code>func (v *Element) Set(a *Element) *Element</code></pre>
            </article>
            
            <article class="function" data-name="SetBytes">
               <h3>
                  SetBytes 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>SetBytes sets v to x, where x is a 32-byte little-endian encoding. If x is
not of the right length, SetBytes returns nil and an error, and the
receiver is unchanged.
Consistent with RFC 7748, the most significant bit (the high bit of the
last byte) is ignored, and non-canonical values (2^255-19 through 2^255-1)
are accepted. Note that this is laxer than specified by RFC 8032, but
consistent with most Ed25519 implementations.</p>
               
               <pre><code>func (v *Element) SetBytes(x []byte) (*Element, error)</code></pre>
            </article>
            
            <article class="function" data-name="SqrtRatio">
               <h3>
                  SqrtRatio 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>SqrtRatio sets r to the non-negative square root of the ratio of u and v.
If u/v is square, SqrtRatio returns r and 1. If u/v is not square, SqrtRatio
sets r according to Section 4.3 of draft-irtf-cfrg-ristretto255-decaf448-00,
and returns r and 0.</p>
               
               <pre><code>func (r *Element) SqrtRatio(u *Element, v *Element) (R *Element, wasSquare int)</code></pre>
            </article>
            
            <article class="function" data-name="Square">
               <h3>
                  Square 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Square sets v = x * x, and returns v.</p>
               
               <pre><code>func (v *Element) Square(x *Element) *Element</code></pre>
            </article>
            
            <article class="function" data-name="Subtract">
               <h3>
                  Subtract 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Subtract sets v = a - b, and returns v.</p>
               
               <pre><code>func (v *Element) Subtract(a *Element, b *Element) *Element</code></pre>
            </article>
            
            <article class="function" data-name="Swap">
               <h3>
                  Swap 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Swap swaps v and u if cond == 1 or leaves them unchanged if cond == 0, and returns v.</p>
               
               <pre><code>func (v *Element) Swap(u *Element, cond int)</code></pre>
            </article>
            
            <article class="function" data-name="Zero">
               <h3>
                  Zero 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Zero sets v = 0, and returns v.</p>
               
               <pre><code>func (v *Element) Zero() *Element</code></pre>
            </article>
            
            <article class="function" data-name="addMul64">
               <h3>
                  addMul64 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>addMul64 returns v + a * b.</p>
               
               <pre><code>func addMul64(v uint128, a uint64, b uint64) uint128</code></pre>
            </article>
            
            <article class="function" data-name="bytes">
               <h3>
                  bytes 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (v *Element) bytes(out *[32]byte) []byte</code></pre>
            </article>
            
            <article class="function" data-name="carryPropagate">
               <h3>
                  carryPropagate 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>go:noescape</p>
               
               <pre><code>func carryPropagate(v *Element)</code></pre>
            </article>
            
            <article class="function" data-name="carryPropagate">
               <h3>
                  carryPropagate 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (v *Element) carryPropagate() *Element</code></pre>
            </article>
            
            <article class="function" data-name="carryPropagate">
               <h3>
                  carryPropagate 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (v *Element) carryPropagate() *Element</code></pre>
            </article>
            
            <article class="function" data-name="carryPropagateGeneric">
               <h3>
                  carryPropagateGeneric 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>carryPropagateGeneric brings the limbs below 52 bits by applying the reduction
identity (a * 2²⁵⁵ + b = a * 19 + b) to the l4 carry.</p>
               
               <pre><code>func (v *Element) carryPropagateGeneric() *Element</code></pre>
            </article>
            
            <article class="function" data-name="feMul">
               <h3>
                  feMul 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func feMul(v *Element, x *Element, y *Element)</code></pre>
            </article>
            
            <article class="function" data-name="feMul">
               <h3>
                  feMul 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>feMul sets out = a * b. It works like feMulGeneric.
go:noescape</p>
               
               <pre><code>func feMul(out *Element, a *Element, b *Element)</code></pre>
            </article>
            
            <article class="function" data-name="feMulGeneric">
               <h3>
                  feMulGeneric 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func feMulGeneric(v *Element, a *Element, b *Element)</code></pre>
            </article>
            
            <article class="function" data-name="feSquare">
               <h3>
                  feSquare 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func feSquare(v *Element, x *Element)</code></pre>
            </article>
            
            <article class="function" data-name="feSquare">
               <h3>
                  feSquare 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>feSquare sets out = a * a. It works like feSquareGeneric.
go:noescape</p>
               
               <pre><code>func feSquare(out *Element, a *Element)</code></pre>
            </article>
            
            <article class="function" data-name="feSquareGeneric">
               <h3>
                  feSquareGeneric 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func feSquareGeneric(v *Element, a *Element)</code></pre>
            </article>
            
            <article class="function" data-name="mask64Bits">
               <h3>
                  mask64Bits 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>mask64Bits returns 0xffffffff if cond is 1, and 0 otherwise.</p>
               
               <pre><code>func mask64Bits(cond int) uint64</code></pre>
            </article>
            
            <article class="function" data-name="mul51">
               <h3>
                  mul51 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>mul51 returns lo + hi * 2⁵¹ = a * b.</p>
               
               <pre><code>func mul51(a uint64, b uint32) (lo uint64, hi uint64)</code></pre>
            </article>
            
            <article class="function" data-name="mul64">
               <h3>
                  mul64 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>mul64 returns a * b.</p>
               
               <pre><code>func mul64(a uint64, b uint64) uint128</code></pre>
            </article>
            
            <article class="function" data-name="reduce">
               <h3>
                  reduce 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>reduce reduces v modulo 2^255 - 19 and returns it.</p>
               
               <pre><code>func (v *Element) reduce() *Element</code></pre>
            </article>
            
            <article class="function" data-name="shiftRightBy51">
               <h3>
                  shiftRightBy51 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>shiftRightBy51 returns a >> 51. a is assumed to be at most 115 bits.</p>
               
               <pre><code>func shiftRightBy51(a uint128) uint64</code></pre>
            </article>
            
         </section>
         
      </main>

      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }

         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               imports: document.getElementById("showImports"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
               types: document.getElementById("showPrivateTypes"),
               interfaces: document.getElementById(
                  "showPrivateInterfaces"
               ),
            };

            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });

               if (toggle) {
                  toggle.addEventListener("change", () => {
                     const show = toggle.checked;
                     document
                        .querySelectorAll(`${selector}.private`)
                        .forEach((el) => {
                           el.classList.toggle("hidden", !show);
                        });
                  });
               }
            };

            hideInitial("article.imports", toggles.imports);
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            hideInitial("article.type", toggles.types);
            hideInitial("article.interface", toggles.interfaces);

            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;

                  const lines = codeBlock.innerHTML.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch && trimmed != "}") {
                           return `<span class="field-line">${line}</span>`;
                        }
                        if (nameMatch == null) return;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class="field-line${
                           isPriv ? " hidden private" : ""
                        }" data-name="${name}">${line}</span>`;
                     })
                     .join("");

                  codeBlock.innerHTML = newContent;

                  if (toggles.fields) {
                     toggles.fields.addEventListener("change", () => {
                        const show = toggles.fields.checked;
                        article
                           .querySelectorAll(".field-line.private")
                           .forEach((el) =>
                              el.classList.toggle("hidden", !show)
                           );
                     });
                  }
               });

            // Handle private methods in interfaces
            document
               .querySelectorAll("article.interface")
               .forEach((article) => {
                  const codeBlock = article.querySelector(
                     "code.methods-code"
                  );
                  if (!codeBlock) return;

                  const lines = codeBlock.innerHTML.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch) {
                           return `<span class="method-line">${line}</span>`;
                        }

                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class="method-line${
                           isPriv ? " hidden private" : ""
                        }" data-name="${name}">${line}</span>`;
                     })
                     .join("");

                  codeBlock.innerHTML = newContent;

                  if (toggles.fields) {
                     // Reuse fields toggle for interface methods
                     toggles.fields.addEventListener("change", () => {
                        const show = toggles.fields.checked;
                        article
                           .querySelectorAll(".method-line.private")
                           .forEach((el) =>
                              el.classList.toggle("hidden", !show)
                           );
                     });
                  }
               });

            const searchInput = document.getElementById("searchInput");
            if (searchInput) {
               searchInput.addEventListener("input", () => {
                  const query = searchInput.value.trim().toLowerCase();

                  document.querySelectorAll("article").forEach((el) => {
                     const name = el.dataset.name;
                     if (!name) return;

                     const matches =
                        query === "" ||
                        name.toLowerCase().includes(query) ||
                        (el.textContent &&
                           el.textContent.toLowerCase().includes(query));

                     if (matches) {
                        // Only show if not hidden by privacy filters
                        const isPrivateEl =
                           el.classList.contains("private");
                        const shouldShowPrivate =
                           getPrivateToggleState(el);

                        if (!isPrivateEl || shouldShowPrivate) {
                           el.classList.remove("hidden");
                        }
                     } else {
                        el.classList.add("hidden");
                     }
                  });
               });
            }

            // Helper function to check if private elements should be shown
            function getPrivateToggleState(element) {
               if (element.classList.contains("function")) {
                  return toggles.functions?.checked || false;
               } else if (element.classList.contains("struct")) {
                  return toggles.structs?.checked || false;
               } else if (element.classList.contains("global")) {
                  return toggles.globals?.checked || false;
               } else if (element.classList.contains("type")) {
                  return toggles.types?.checked || false;
               } else if (element.classList.contains("interface")) {
                  return toggles.interfaces?.checked || false;
               } else if (element.classList.contains("imports")) {
                  return toggles.imports?.checked || false;
               }
               return false;
            }

            document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
               anchor.addEventListener("click", function (e) {
                  e.preventDefault();
                  const target = document.querySelector(
                     this.getAttribute("href")
                  );
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               });
            });
         });
      </script>
   </body>
</html>
