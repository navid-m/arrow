<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - ecdsa</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <link
         href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 14px;
            scroll-behavior: smooth;
         }

         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
            line-height: 1.6;
         }

         .sidebar {
            width: 12%;
            background: rgba(59, 56, 56, 0.15);
            padding: 1.5rem;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.4);
            overflow-y: auto;
            position: sticky;
            top: 0;
            height: 100vh;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
         }

         .sidebar::-webkit-scrollbar {
            width: 6px;
         }

         .sidebar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
         }

         .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
         }

         main {
            flex: 1;
            padding: 2rem;
            margin: 0;
            max-width: calc(100% - 280px);
            background: linear-gradient(
               135deg,
               rgba(59, 56, 56, 0.05) 0%,
               rgba(0, 0, 0, 0.1) 100%
            );
         }

         .nav-links {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
         }

         .nav-links a {
            color: #ddd;
            text-decoration: none;
            padding: 0.5rem;
            border-radius: 4px;
            transition: all 0.2s ease;
         }

         .nav-links a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
         }

         h1 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #fff 0%, #ddd 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
         }

         h2 {
            font-size: 1.4rem;
            margin: 1rem 0 0.5rem;
            color: #f0f0f0;
         }

         h3 {
            font-size: 1.2rem;
            margin: 0.8rem 0 0.3rem;
            color: #e0e0e0;
            position: relative;
         }

         .sidebar h2,
         .sidebar h3 {
            font-size: 1rem;
            margin: 0.5rem 0 0.3rem;
            color: #ccc;
         }

         .anchor {
            color: rgba(255, 255, 255, 0.3);
            text-decoration: none;
            font-weight: normal;
            margin-left: 0.5rem;
            opacity: 0;
            transition: opacity 0.2s ease;
            font-size: 0.8em;
         }

         h3:hover .anchor,
         .anchor:focus {
            opacity: 1;
         }

         .anchor:hover {
            color: rgba(255, 255, 255, 0.6);
         }

         .symbol-anchor {
            scroll-margin-top: 2rem;
         }

         pre, code {
            white-space: pre;
         }  

         pre[class*="language-"] {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3) !important;
            border-radius: 8px !important;
            margin: 1rem 0 !important;
            padding: 1rem 1.2rem !important;
            font-size: 0.9rem !important;
            overflow-x: auto !important;
         }

         code[class*="language-"] {
            color: #e6e6e6 !important;
            font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace !important;
            white-space: pre-wrap !important;
         }

         pre:not([class*="language-"]) {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #e6e6e6;
            padding: 1rem 1.2rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-size: 0.9rem;
            overflow-x: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
         }

         pre:not([class*="language-"]) code {
            color: #f5f5f5;
            font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace;
            white-space: pre-wrap;
         }

         .token.comment,
         .token.prolog,
         .token.doctype,
         .token.cdata {
            color: #7c7c7c !important;
         }

         .token.punctuation {
            color: #c9c9c9 !important;
         }

         .token.property,
         .token.tag,
         .token.boolean,
         .token.number,
         .token.constant,
         .token.symbol,
         .token.deleted {
            color: #f2777a !important;
         }

         .token.selector,
         .token.attr-name,
         .token.string,
         .token.char,
         .token.builtin,
         .token.inserted {
            color: #639fc2 !important;
         }

         .token.operator,
         .token.entity,
         .token.url,
         .language-css .token.string,
         .style .token.string {
            color: #66cccc !important;
         }

         .token.atrule,
         .token.attr-value,
         .token.keyword {
            color: #d34343 !important;
         }

         .token.function,
         .token.class-name {
            color: #f99157 !important;
         }

         .token.regex,
         .token.important,
         .token.variable {
            color: #ffcc66 !important;
         }

         p {
            font-size: 15px;
            margin: 1rem 0;
            color: #ddd;
         }

         article {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(59, 56, 56, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
         }

         article:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
            transform: translateY(-2px);
         }

         article:target {
            border-color: rgba(100, 200, 255, 0.5);
            box-shadow: 0 0 0 2px rgba(100, 200, 255, 0.2);
         }

         .hidden {
            display: none !important;
         }

         .filter-section {
            margin-bottom: 1.5rem;
         }

         .filter-section h3 {
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #aaa;
         }

         .filter-toggle label {
            display: flex;
            align-items: center;
            margin-bottom: 0.6rem;
            font-size: 0.85rem;
            color: #bbb;
            cursor: pointer;
            padding: 0.3rem;
            border-radius: 4px;
            transition: background 0.2s ease;
         }

         .filter-toggle label:hover {
            background: rgba(255, 255, 255, 0.05);
         }

         .filter-toggle input {
            margin-right: 0.6rem;
         }

         #searchInput {
            width: 100%;
            margin-bottom: 1.5rem;
            border-radius: 8px !important;
            height: 2.8rem;
            font-size: 0.9rem;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 0 1rem;
         }

         #searchInput::placeholder {
            color: rgba(255, 255, 255, 0.5);
         }

         #searchInput:focus {
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.1);
         }

         .section-divider {
            height: 1px;
            background: linear-gradient(
               90deg,
               transparent 0%,
               rgba(255, 255, 255, 0.3) 50%,
               transparent 100%
            );
            margin: 1.5rem 0;
         }

         .subpackage-list {
            list-style: none;
            padding: 0;
         }

         .subpackage-list li {
            margin-bottom: 0.4rem;
         }

         .subpackage-list a {
            display: block;
            padding: 0.5rem 0.8rem;
            color: #ccc;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-size: 0.85rem;
         }

         .subpackage-list a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            transform: translateX(4px);
         }

         .empty-state {
            color: rgba(177, 175, 175, 0.6);
            font-style: italic;
            font-size: 0.8rem;
         }

         .badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            color: #ddd;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-left: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .method-badge {
            background: rgba(100, 200, 255, 0.2);
            color: #87ceeb;
         }

         .const-badge {
            background: rgba(255, 200, 100, 0.2);
            color: #ffd700;
         }

         .var-badge {
            background: rgba(200, 255, 100, 0.2);
            color: #90ee90;
         }

         .type-badge {
            background: rgba(255, 100, 200, 0.2);
            color: #699eff;
         }

         .interface-badge {
            background: rgba(150, 100, 255, 0.2);
            color: #dda0dd;
         }

         .toc {
            position: sticky;
            top: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
         }

         .toc h4 {
            margin: 0 0 0.8rem;
            font-size: 0.9rem;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .toc ul {
            list-style: none;
            padding: 0;
            margin: 0;
         }

         .toc li {
            margin-bottom: 0.3rem;
         }

         .toc a {
            color: #bbb;
            text-decoration: none;
            font-size: 0.8rem;
            transition: color 0.2s ease;
         }

         .toc a:hover {
            color: #fff;
         }

         .symbol-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            background: rgba(0, 0, 0, 0.2);
         }

         .symbol-list::-webkit-scrollbar {
            width: 4px;
         }

         .symbol-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
         }

         .symbol-list ul {
            list-style: none;
            padding: 0.5rem;
            margin: 0;
         }

         .symbol-list li {
            margin-bottom: 0.2rem;
         }

         .symbol-list a {
            display: block;
            padding: 0.3rem 0.5rem;
            color: #bbb;
            text-decoration: none;
            border-radius: 4px;
            transition: all 0.2s ease;
            font-size: 0.75rem;
         }

         .symbol-list a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
         }

         @media (max-width: 768px) {
            body {
               flex-direction: column;
            }

            .sidebar {
               width: 90%;
               height: auto;
               position: relative;
            }

            main {
               max-width: 100%;
               padding: 1rem;
            }
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <div class="nav-links">
            <a href="index.html" title="Home">⌂</a>
            <span>|</span>
            <a href="#" onclick="history.back()" title="Back">←</a>
         </div>

         <div class="filter-section">
            <h3>Search</h3>
            <input
               type="search"
               id="searchInput"
               placeholder="Search symbols..."
            />
         </div>

         <div class="filter-section">
            <h3>Filters</h3>
            <div class="filter-toggle">
               <label>
                  <input type="checkbox" id="showImports" />
                  Show imports
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFunctions" />
                  Show private functions
               </label>
               <label>
                  <input type="checkbox" id="showPrivateStructs" />
                  Show private structs
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFields" />
                  Show private fields
               </label>
               <label>
                  <input type="checkbox" id="showPrivateGlobals" />
                  Show private globals
               </label>
               <label>
                  <input type="checkbox" id="showPrivateTypes" />
                  Show private types
               </label>
               <label>
                  <input type="checkbox" id="showPrivateInterfaces" />
                  Show private interfaces
               </label>
            </div>
         </div>

         <div class="section-divider"></div>

         <div class="filter-section">
            <h3>Subpackages</h3>
            
            <div class="empty-state">No subpackages</div>
            
         </div>

         
         <div class="section-divider"></div>

         <div class="toc">
            <h4>Quick Navigation</h4>
            <ul>
               
               <li><a href="#globals">Constants & Variables</a></li>
                
               <li><a href="#types">Type Aliases</a></li>
                
               <li><a href="#interfaces">Interfaces</a></li>
                
               <li><a href="#structs">Structs</a></li>
                
               <li><a href="#functions">Functions</a></li>
               
            </ul>
         </div>

         <div class="filter-section">
            <h3>All Symbols</h3>
            <div class="symbol-list">
               <ul id="symbolIndex">
               </ul>
            </div>
         </div>
         
      </aside>

      <main>
         <h1>ecdsa</h1>
         <div class="section-divider"></div>

         
         <section id="imports">
            <h2>Imports</h2>
            <article class="imports symbol-anchor" id="imports-section" data-name="imports">
               <h3>
                  Imports
                  <a href="#imports-section" class="anchor" title="Link to imports">#</a>
               </h3>
               <pre><code class="language-go">"bytes"
"crypto/internal/fips140"
_ "crypto/internal/fips140/check"
"crypto/internal/fips140/sha512"
"errors"
"sync"
"bytes"
"crypto/internal/fips140"
"crypto/internal/fips140/bigmod"
"crypto/internal/fips140/drbg"
"crypto/internal/fips140/nistec"
"errors"
"io"
"sync"
"crypto/internal/fips140/bigmod"
"crypto/internal/fips140deps/cpu"
"crypto/internal/impl"
"errors"
"bytes"
"crypto/internal/fips140"
"crypto/internal/fips140/hmac"
</code></pre>
            </article>
         </section>
          
         <section id="globals">
            <h2>Constants & Variables</h2>
            
            <article class="global symbol-anchor" id="_P224" data-name="_P224">
               <h3>
                  _P224 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#_P224" class="anchor" title="Link to _P224">#</a>
               </h3>
               
               <pre><code class="language-go">var _P224 = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="_P256" data-name="_P256">
               <h3>
                  _P256 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#_P256" class="anchor" title="Link to _P256">#</a>
               </h3>
               
               <pre><code class="language-go">var _P256 = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="_P384" data-name="_P384">
               <h3>
                  _P384 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#_P384" class="anchor" title="Link to _P384">#</a>
               </h3>
               
               <pre><code class="language-go">var _P384 = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="_P521" data-name="_P521">
               <h3>
                  _P521 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#_P521" class="anchor" title="Link to _P521">#</a>
               </h3>
               
               <pre><code class="language-go">var _P521 = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="fipsSelfTest" data-name="fipsSelfTest">
               <h3>
                  fipsSelfTest 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#fipsSelfTest" class="anchor" title="Link to fipsSelfTest">#</a>
               </h3>
               
               <pre><code class="language-go">var fipsSelfTest = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="fipsSelfTestDeterministic" data-name="fipsSelfTestDeterministic">
               <h3>
                  fipsSelfTestDeterministic 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#fipsSelfTestDeterministic" class="anchor" title="Link to fipsSelfTestDeterministic">#</a>
               </h3>
               
               <pre><code class="language-go">var fipsSelfTestDeterministic = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="maxRequestSize" data-name="maxRequestSize">
               <h3>
                  maxRequestSize 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#maxRequestSize" class="anchor" title="Link to maxRequestSize">#</a>
               </h3>
               
               <pre><code class="language-go">const maxRequestSize = *ast.BinaryExpr</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="p224" data-name="p224">
               <h3>
                  p224 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#p224" class="anchor" title="Link to p224">#</a>
               </h3>
               
               <pre><code class="language-go">const p224 curveID = "P-224"</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="p224Order" data-name="p224Order">
               <h3>
                  p224Order 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#p224Order" class="anchor" title="Link to p224Order">#</a>
               </h3>
               
               <pre><code class="language-go">var p224Order = []byte{...}</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="p256" data-name="p256">
               <h3>
                  p256 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#p256" class="anchor" title="Link to p256">#</a>
               </h3>
               
               <pre><code class="language-go">const p256 curveID = "P-256"</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="p256Order" data-name="p256Order">
               <h3>
                  p256Order 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#p256Order" class="anchor" title="Link to p256Order">#</a>
               </h3>
               
               <pre><code class="language-go">var p256Order = []byte{...}</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="p384" data-name="p384">
               <h3>
                  p384 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#p384" class="anchor" title="Link to p384">#</a>
               </h3>
               
               <pre><code class="language-go">const p384 curveID = "P-384"</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="p384Order" data-name="p384Order">
               <h3>
                  p384Order 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#p384Order" class="anchor" title="Link to p384Order">#</a>
               </h3>
               
               <pre><code class="language-go">var p384Order = []byte{...}</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="p521" data-name="p521">
               <h3>
                  p521 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#p521" class="anchor" title="Link to p521">#</a>
               </h3>
               
               <pre><code class="language-go">const p521 curveID = "P-521"</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="p521Order" data-name="p521Order">
               <h3>
                  p521Order 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#p521Order" class="anchor" title="Link to p521Order">#</a>
               </h3>
               
               <pre><code class="language-go">var p521Order = []byte{...}</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="reseedInterval" data-name="reseedInterval">
               <h3>
                  reseedInterval 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#reseedInterval" class="anchor" title="Link to reseedInterval">#</a>
               </h3>
               
               <pre><code class="language-go">const reseedInterval = *ast.BinaryExpr</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="supportsKDSA" data-name="supportsKDSA">
               <h3>
                  supportsKDSA 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#supportsKDSA" class="anchor" title="Link to supportsKDSA">#</a>
               </h3>
               
               <pre><code class="language-go">var supportsKDSA = cpu.S390XHasECDSA</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="testingOnlyRejectionSamplingLooped" data-name="testingOnlyRejectionSamplingLooped">
               <h3>
                  testingOnlyRejectionSamplingLooped 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#testingOnlyRejectionSamplingLooped" class="anchor" title="Link to testingOnlyRejectionSamplingLooped">#</a>
               </h3>
               
               <p>testingOnlyRejectionSamplingLooped is called when rejection sampling in
randomPoint rejects a candidate for being higher than the modulus.</p>
               
               <pre><code class="language-go">var testingOnlyRejectionSamplingLooped func()</code></pre>
            </article>
            
         </section>
          
         <section id="types">
            <h2>Type Aliases</h2>
            
            <article class="type symbol-anchor" id="blockAlignedPersonalizationString" data-name="blockAlignedPersonalizationString">
               <h3>
                  blockAlignedPersonalizationString
                  <span class="badge type-badge">type</span>
                  <a href="#blockAlignedPersonalizationString" class="anchor" title="Link to blockAlignedPersonalizationString">#</a>
               </h3>
               
               <p>Each entry in blockAlignedPersonalizationString is written to the HMAC at a
block boundary, as specified in draft-irtf-cfrg-det-sigs-with-noise-04,
Section 4.</p>
               
               <pre><code class="language-go">type blockAlignedPersonalizationString [][]byte</code></pre>
            </article>
            
            <article class="type symbol-anchor" id="curveID" data-name="curveID">
               <h3>
                  curveID
                  <span class="badge type-badge">type</span>
                  <a href="#curveID" class="anchor" title="Link to curveID">#</a>
               </h3>
               
               <pre><code class="language-go">type curveID string</code></pre>
            </article>
            
            <article class="type symbol-anchor" id="plainPersonalizationString" data-name="plainPersonalizationString">
               <h3>
                  plainPersonalizationString
                  <span class="badge type-badge">type</span>
                  <a href="#plainPersonalizationString" class="anchor" title="Link to plainPersonalizationString">#</a>
               </h3>
               
               <p>plainPersonalizationString is used by HMAC_DRBG as-is.</p>
               
               <pre><code class="language-go">type plainPersonalizationString []byte</code></pre>
            </article>
            
         </section>
          
         <section id="interfaces">
            <h2>Interfaces</h2>
            
            <article class="interface symbol-anchor" id="Point" data-name="Point">
               <h3>
                  Point
                  <span class="badge interface-badge">interface</span>
                  <a href="#Point" class="anchor" title="Link to Point">#</a>
               </h3>
               
               <p>Point is a generic constraint for the [nistec] Point types.</p>
               
               <pre
                  class="methods-block"
               ><code class="methods-code language-go">type Point interface {
*ast.BinaryExpr
Bytes() []byte
BytesX() ([]byte, error)
SetBytes([]byte) (P, error)
ScalarMult(P, []byte) (P, error)
ScalarBaseMult([]byte) (P, error)
Add(p1 P, p2 P) P
}</code></pre>
            </article>
            
            <article class="interface symbol-anchor" id="personalizationString" data-name="personalizationString">
               <h3>
                  personalizationString
                  <span class="badge interface-badge">interface</span>
                  <a href="#personalizationString" class="anchor" title="Link to personalizationString">#</a>
               </h3>
               
               <pre
                  class="methods-block"
               ><code class="methods-code language-go">type personalizationString interface {
isPersonalizationString()
}</code></pre>
            </article>
            
         </section>
          
         <section id="structs">
            <h2>Structs</h2>
            
            <article class="struct symbol-anchor" id="Curve" data-name="Curve">
               <h3>
                  Curve
                  <span class="badge">struct</span>
                  <a href="#Curve" class="anchor" title="Link to Curve">#</a>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code language-go">type Curve struct {
curve curveID
newPoint func() P
ordInverse func([]byte) ([]byte, error)
N *bigmod.Modulus
nMinus2 []byte
}</code></pre>
            </article>
            
            <article class="struct symbol-anchor" id="PrivateKey" data-name="PrivateKey">
               <h3>
                  PrivateKey
                  <span class="badge">struct</span>
                  <a href="#PrivateKey" class="anchor" title="Link to PrivateKey">#</a>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code language-go">type PrivateKey struct {
pub PublicKey
d []byte
}</code></pre>
            </article>
            
            <article class="struct symbol-anchor" id="PublicKey" data-name="PublicKey">
               <h3>
                  PublicKey
                  <span class="badge">struct</span>
                  <a href="#PublicKey" class="anchor" title="Link to PublicKey">#</a>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code language-go">type PublicKey struct {
curve curveID
q []byte
}</code></pre>
            </article>
            
            <article class="struct symbol-anchor" id="Signature" data-name="Signature">
               <h3>
                  Signature
                  <span class="badge">struct</span>
                  <a href="#Signature" class="anchor" title="Link to Signature">#</a>
               </h3>
               
               <p>Signature is an ECDSA signature, where r and s are represented as big-endian
byte slices of the same length as the curve order.</p>
               
               <pre
                  class="fields-block"
               ><code class="fields-code language-go">type Signature struct {
R []byte
S []byte
}</code></pre>
            </article>
            
            <article class="struct symbol-anchor" id="hmacDRBG" data-name="hmacDRBG">
               <h3>
                  hmacDRBG
                  <span class="badge">struct</span>
                  <a href="#hmacDRBG" class="anchor" title="Link to hmacDRBG">#</a>
               </h3>
               
               <p>hmacDRBG is an SP 800-90A Rev. 1 HMAC_DRBG.
It is only intended to be used to generate ECDSA nonces. Since it will be
instantiated ex-novo for each signature, its Generate function will only be
invoked once or twice (only for P-256, with probability 2⁻³²).
Per Table 2, it has a reseed interval of 2^48 requests, and a maximum request
size of 2^19 bits (2^16 bytes, 64 KiB).</p>
               
               <pre
                  class="fields-block"
               ><code class="fields-code language-go">type hmacDRBG struct {
newHMAC func(key []byte) *hmac.HMAC
hK *hmac.HMAC
V []byte
reseedCounter uint64
}</code></pre>
            </article>
            
         </section>
          
         <section id="functions">
            <h2>Functions</h2>
            
            <article class="function symbol-anchor" id="Bytes" data-name="Bytes">
               <h3>
                  Bytes 
                  <span class="badge method-badge">method</span>
                  
                  <a href="#Bytes" class="anchor" title="Link to Bytes">#</a>
               </h3>
               
               <pre><code class="language-go">func (priv *PrivateKey) Bytes() []byte</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="Bytes" data-name="Bytes">
               <h3>
                  Bytes 
                  <span class="badge method-badge">method</span>
                  
                  <a href="#Bytes" class="anchor" title="Link to Bytes">#</a>
               </h3>
               
               <pre><code class="language-go">func (pub *PublicKey) Bytes() []byte</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="Generate" data-name="Generate">
               <h3>
                  Generate 
                  <span class="badge method-badge">method</span>
                  
                  <a href="#Generate" class="anchor" title="Link to Generate">#</a>
               </h3>
               
               <p>Generate produces at most maxRequestSize bytes of random data in out.</p>
               
               <pre><code class="language-go">func (d *hmacDRBG) Generate(out []byte)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="GenerateKey" data-name="GenerateKey">
               <h3>
                  GenerateKey 
                  <span class="badge">function</span>
                  
                  <a href="#GenerateKey" class="anchor" title="Link to GenerateKey">#</a>
               </h3>
               
               <p>GenerateKey generates a new ECDSA private key pair for the specified curve.</p>
               
               <pre><code class="language-go">func GenerateKey(c **ast.IndexExpr, rand io.Reader) (*PrivateKey, error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="NewPrivateKey" data-name="NewPrivateKey">
               <h3>
                  NewPrivateKey 
                  <span class="badge">function</span>
                  
                  <a href="#NewPrivateKey" class="anchor" title="Link to NewPrivateKey">#</a>
               </h3>
               
               <pre><code class="language-go">func NewPrivateKey(c **ast.IndexExpr, D []byte, Q []byte) (*PrivateKey, error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="NewPublicKey" data-name="NewPublicKey">
               <h3>
                  NewPublicKey 
                  <span class="badge">function</span>
                  
                  <a href="#NewPublicKey" class="anchor" title="Link to NewPublicKey">#</a>
               </h3>
               
               <pre><code class="language-go">func NewPublicKey(c **ast.IndexExpr, Q []byte) (*PublicKey, error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="P224" data-name="P224">
               <h3>
                  P224 
                  <span class="badge">function</span>
                  
                  <a href="#P224" class="anchor" title="Link to P224">#</a>
               </h3>
               
               <pre><code class="language-go">func P224() **ast.IndexExpr</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="P256" data-name="P256">
               <h3>
                  P256 
                  <span class="badge">function</span>
                  
                  <a href="#P256" class="anchor" title="Link to P256">#</a>
               </h3>
               
               <pre><code class="language-go">func P256() **ast.IndexExpr</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="P384" data-name="P384">
               <h3>
                  P384 
                  <span class="badge">function</span>
                  
                  <a href="#P384" class="anchor" title="Link to P384">#</a>
               </h3>
               
               <pre><code class="language-go">func P384() **ast.IndexExpr</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="P521" data-name="P521">
               <h3>
                  P521 
                  <span class="badge">function</span>
                  
                  <a href="#P521" class="anchor" title="Link to P521">#</a>
               </h3>
               
               <pre><code class="language-go">func P521() **ast.IndexExpr</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="PublicKey" data-name="PublicKey">
               <h3>
                  PublicKey 
                  <span class="badge method-badge">method</span>
                  
                  <a href="#PublicKey" class="anchor" title="Link to PublicKey">#</a>
               </h3>
               
               <pre><code class="language-go">func (priv *PrivateKey) PublicKey() *PublicKey</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="Sign" data-name="Sign">
               <h3>
                  Sign 
                  <span class="badge">function</span>
                  
                  <a href="#Sign" class="anchor" title="Link to Sign">#</a>
               </h3>
               
               <p>Sign signs a hash (which shall be the result of hashing a larger message with
the hash function H) using the private key, priv. If the hash is longer than
the bit-length of the private key's curve order, the hash will be truncated
to that length.</p>
               
               <pre><code class="language-go">func Sign(c **ast.IndexExpr, h func() H, priv *PrivateKey, rand io.Reader, hash []byte) (*Signature, error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="SignDeterministic" data-name="SignDeterministic">
               <h3>
                  SignDeterministic 
                  <span class="badge">function</span>
                  
                  <a href="#SignDeterministic" class="anchor" title="Link to SignDeterministic">#</a>
               </h3>
               
               <p>SignDeterministic signs a hash (which shall be the result of hashing a
larger message with the hash function H) using the private key, priv. If the
hash is longer than the bit-length of the private key's curve order, the hash
will be truncated to that length. This applies Deterministic ECDSA as
specified in FIPS 186-5 and RFC 6979.</p>
               
               <pre><code class="language-go">func SignDeterministic(c **ast.IndexExpr, h func() H, priv *PrivateKey, hash []byte) (*Signature, error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="Verify" data-name="Verify">
               <h3>
                  Verify 
                  <span class="badge">function</span>
                  
                  <a href="#Verify" class="anchor" title="Link to Verify">#</a>
               </h3>
               
               <p>Verify verifies the signature, sig, of hash (which should be the result of
hashing a larger message) using the public key, pub. If the hash is longer
than the bit-length of the private key's curve order, the hash will be
truncated to that length.
The inputs are not considered confidential, and may leak through timing side
channels, or if an attacker has control of part of the inputs.</p>
               
               <pre><code class="language-go">func Verify(c **ast.IndexExpr, pub *PublicKey, hash []byte, sig *Signature) error</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="appendBlock" data-name="appendBlock">
               <h3>
                  appendBlock 
                  <span class="badge">function</span>
                  
                  <a href="#appendBlock" class="anchor" title="Link to appendBlock">#</a>
               </h3>
               
               <pre><code class="language-go">func appendBlock(p []byte, blocksize int, b []byte) []byte</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="bits2octets" data-name="bits2octets">
               <h3>
                  bits2octets 
                  <span class="badge">function</span>
                  
                  <a href="#bits2octets" class="anchor" title="Link to bits2octets">#</a>
               </h3>
               
               <p>bits2octets as specified in FIPS 186-5, Appendix B.2.4 or RFC 6979,
Section 2.3.4. See RFC 6979, Section 3.5 for the rationale.</p>
               
               <pre><code class="language-go">func bits2octets(c **ast.IndexExpr, hash []byte) []byte</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="canUseKDSA" data-name="canUseKDSA">
               <h3>
                  canUseKDSA 
                  <span class="badge">function</span>
                  
                  <a href="#canUseKDSA" class="anchor" title="Link to canUseKDSA">#</a>
               </h3>
               
               <p>canUseKDSA checks if KDSA instruction is available, and if it is, it checks
the name of the curve to see if it matches the curves supported(P-256, P-384, P-521).
Then, based on the curve name, a function code and a block size will be assigned.
If KDSA instruction is not available or if the curve is not supported, canUseKDSA
will set ok to false.</p>
               
               <pre><code class="language-go">func canUseKDSA(c curveID) (functionCode uint64, blockSize int, ok bool)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="fipsPCT" data-name="fipsPCT">
               <h3>
                  fipsPCT 
                  <span class="badge">function</span>
                  
                  <a href="#fipsPCT" class="anchor" title="Link to fipsPCT">#</a>
               </h3>
               
               <pre><code class="language-go">func fipsPCT(c **ast.IndexExpr, k *PrivateKey) error</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="hashToBytes" data-name="hashToBytes">
               <h3>
                  hashToBytes 
                  <span class="badge">function</span>
                  
                  <a href="#hashToBytes" class="anchor" title="Link to hashToBytes">#</a>
               </h3>
               
               <pre><code class="language-go">func hashToBytes(c **ast.IndexExpr, hash []byte) []byte</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="hashToNat" data-name="hashToNat">
               <h3>
                  hashToNat 
                  <span class="badge">function</span>
                  
                  <a href="#hashToNat" class="anchor" title="Link to hashToNat">#</a>
               </h3>
               
               <p>hashToNat sets e to the left-most bits of hash, according to
FIPS 186-5, Section 6.4.1, point 2 and Section 6.4.2, point 3.</p>
               
               <pre><code class="language-go">func hashToNat(c **ast.IndexExpr, e *bigmod.Nat, hash []byte)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="init" data-name="init">
               <h3>
                  init 
                  <span class="badge">function</span>
                  
                  <a href="#init" class="anchor" title="Link to init">#</a>
               </h3>
               
               <pre><code class="language-go">func init()</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="inverse" data-name="inverse">
               <h3>
                  inverse 
                  <span class="badge">function</span>
                  
                  <a href="#inverse" class="anchor" title="Link to inverse">#</a>
               </h3>
               
               <p>inverse sets kInv to the inverse of k modulo the order of the curve.</p>
               
               <pre><code class="language-go">func inverse(c **ast.IndexExpr, kInv *bigmod.Nat, k *bigmod.Nat)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="isPersonalizationString" data-name="isPersonalizationString">
               <h3>
                  isPersonalizationString 
                  <span class="badge method-badge">method</span>
                  
                  <a href="#isPersonalizationString" class="anchor" title="Link to isPersonalizationString">#</a>
               </h3>
               
               <pre><code class="language-go">func (blockAlignedPersonalizationString) isPersonalizationString()</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="isPersonalizationString" data-name="isPersonalizationString">
               <h3>
                  isPersonalizationString 
                  <span class="badge method-badge">method</span>
                  
                  <a href="#isPersonalizationString" class="anchor" title="Link to isPersonalizationString">#</a>
               </h3>
               
               <pre><code class="language-go">func (plainPersonalizationString) isPersonalizationString()</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="kdsa" data-name="kdsa">
               <h3>
                  kdsa 
                  <span class="badge">function</span>
                  
                  <a href="#kdsa" class="anchor" title="Link to kdsa">#</a>
               </h3>
               
               <p>kdsa invokes the "compute digital signature authentication"
instruction with the given function code and 4096 byte
parameter block.
The return value corresponds to the condition code set by the
instruction. Interrupted invocations are handled by the
function.
go:noescape</p>
               
               <pre><code class="language-go">func kdsa(fc uint64, params *[4096]byte) (errn uint64)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="newDRBG" data-name="newDRBG">
               <h3>
                  newDRBG 
                  <span class="badge">function</span>
                  
                  <a href="#newDRBG" class="anchor" title="Link to newDRBG">#</a>
               </h3>
               
               <pre><code class="language-go">func newDRBG(hash func() H, entropy []byte, nonce []byte, s personalizationString) *hmacDRBG</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="pad000" data-name="pad000">
               <h3>
                  pad000 
                  <span class="badge">function</span>
                  
                  <a href="#pad000" class="anchor" title="Link to pad000">#</a>
               </h3>
               
               <pre><code class="language-go">func pad000(h *hmac.HMAC, writtenSoFar int)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="precomputeParams" data-name="precomputeParams">
               <h3>
                  precomputeParams 
                  <span class="badge">function</span>
                  
                  <a href="#precomputeParams" class="anchor" title="Link to precomputeParams">#</a>
               </h3>
               
               <pre><code class="language-go">func precomputeParams(c **ast.IndexExpr, order []byte)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="randomPoint" data-name="randomPoint">
               <h3>
                  randomPoint 
                  <span class="badge">function</span>
                  
                  <a href="#randomPoint" class="anchor" title="Link to randomPoint">#</a>
               </h3>
               
               <p>randomPoint returns a random scalar and the corresponding point using a
procedure equivalent to FIPS 186-5, Appendix A.2.2 (ECDSA Key Pair Generation
by Rejection Sampling) and to Appendix A.3.2 (Per-Message Secret Number
Generation of Private Keys by Rejection Sampling) or Appendix A.3.3
(Per-Message Secret Number Generation for Deterministic ECDSA) followed by
Step 5 of Section 6.4.1.</p>
               
               <pre><code class="language-go">func randomPoint(c **ast.IndexExpr, generate func([]byte) error) (k *bigmod.Nat, p P, err error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="randomScalar" data-name="randomScalar">
               <h3>
                  randomScalar 
                  <span class="badge">function</span>
                  
                  <a href="#randomScalar" class="anchor" title="Link to randomScalar">#</a>
               </h3>
               
               <p>randomScalar is a copy of [randomPoint] that doesn't call ScalarBaseMult.</p>
               
               <pre><code class="language-go">func randomScalar(c **ast.IndexExpr, generate func([]byte) error) (k *bigmod.Nat, err error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="rightShift" data-name="rightShift">
               <h3>
                  rightShift 
                  <span class="badge">function</span>
                  
                  <a href="#rightShift" class="anchor" title="Link to rightShift">#</a>
               </h3>
               
               <p>rightShift implements the right shift necessary for bits2int, which takes the
leftmost bits of either the hash or HMAC_DRBG output.
Note how taking the rightmost bits would have been as easy as masking the
first byte, but we can't have nice things.</p>
               
               <pre><code class="language-go">func rightShift(b []byte, shift int) []byte</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="sign" data-name="sign">
               <h3>
                  sign 
                  <span class="badge">function</span>
                  
                  <a href="#sign" class="anchor" title="Link to sign">#</a>
               </h3>
               
               <pre><code class="language-go">func sign(c **ast.IndexExpr, priv *PrivateKey, drbg *hmacDRBG, hash []byte) (*Signature, error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="sign" data-name="sign">
               <h3>
                  sign 
                  <span class="badge">function</span>
                  
                  <a href="#sign" class="anchor" title="Link to sign">#</a>
               </h3>
               
               <pre><code class="language-go">func sign(c **ast.IndexExpr, priv *PrivateKey, drbg *hmacDRBG, hash []byte) (*Signature, error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="signGeneric" data-name="signGeneric">
               <h3>
                  signGeneric 
                  <span class="badge">function</span>
                  
                  <a href="#signGeneric" class="anchor" title="Link to signGeneric">#</a>
               </h3>
               
               <pre><code class="language-go">func signGeneric(c **ast.IndexExpr, priv *PrivateKey, drbg *hmacDRBG, hash []byte) (*Signature, error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="testHash" data-name="testHash">
               <h3>
                  testHash 
                  <span class="badge">function</span>
                  
                  <a href="#testHash" class="anchor" title="Link to testHash">#</a>
               </h3>
               
               <pre><code class="language-go">func testHash() []byte</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="testPrivateKey" data-name="testPrivateKey">
               <h3>
                  testPrivateKey 
                  <span class="badge">function</span>
                  
                  <a href="#testPrivateKey" class="anchor" title="Link to testPrivateKey">#</a>
               </h3>
               
               <pre><code class="language-go">func testPrivateKey() *PrivateKey</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="trimBlock" data-name="trimBlock">
               <h3>
                  trimBlock 
                  <span class="badge">function</span>
                  
                  <a href="#trimBlock" class="anchor" title="Link to trimBlock">#</a>
               </h3>
               
               <pre><code class="language-go">func trimBlock(p []byte, size int) ([]byte, error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="verify" data-name="verify">
               <h3>
                  verify 
                  <span class="badge">function</span>
                  
                  <a href="#verify" class="anchor" title="Link to verify">#</a>
               </h3>
               
               <pre><code class="language-go">func verify(c **ast.IndexExpr, pub *PublicKey, hash []byte, sig *Signature) error</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="verify" data-name="verify">
               <h3>
                  verify 
                  <span class="badge">function</span>
                  
                  <a href="#verify" class="anchor" title="Link to verify">#</a>
               </h3>
               
               <pre><code class="language-go">func verify(c **ast.IndexExpr, pub *PublicKey, hash []byte, sig *Signature) error</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="verifyGeneric" data-name="verifyGeneric">
               <h3>
                  verifyGeneric 
                  <span class="badge">function</span>
                  
                  <a href="#verifyGeneric" class="anchor" title="Link to verifyGeneric">#</a>
               </h3>
               
               <pre><code class="language-go">func verifyGeneric(c **ast.IndexExpr, pub *PublicKey, hash []byte, sig *Signature) error</code></pre>
            </article>
            
         </section>
         
      </main>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }

         function buildSymbolIndex() {
            const symbolIndex = document.getElementById('symbolIndex');
            if (!symbolIndex) return;

            const symbols = [];
            
            document.querySelectorAll('article[data-name]').forEach(article => {
               const name = article.dataset.name;
               const type = article.className.split(' ')[0]; 
               const isPrivateSymbol = isPrivate(name);
               
               if (name && name !== 'imports') {
                  symbols.push({
                     name,
                     type,
                     element: article,
                     isPrivate: isPrivateSymbol
                  });
               }
            });

            symbols.sort((a, b) => a.name.localeCompare(b.name));
            symbolIndex.innerHTML = '';
            symbols.forEach(symbol => {
               const li = document.createElement('li');
               const a = document.createElement('a');
               a.href = `#${symbol.name}`;
               a.textContent = symbol.name;
               a.title = `${symbol.type}: ${symbol.name}`;
               
               if (symbol.isPrivate) {
                  li.classList.add('private', 'hidden');
               }
               
               li.appendChild(a);
               symbolIndex.appendChild(li);
            });
         }

         document.addEventListener("DOMContentLoaded", () => {
            if (window.Prism) {
               Prism.highlightAll();
            }

            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               imports: document.getElementById("showImports"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
               types: document.getElementById("showPrivateTypes"),
               interfaces: document.getElementById(
                  "showPrivateInterfaces"
               ),
            };

            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });

               if (toggle) {
                  toggle.addEventListener("change", () => {
                     const show = toggle.checked;
                     document
                        .querySelectorAll(`${selector}.private`)
                        .forEach((el) => {
                           el.classList.toggle("hidden", !show);
                        });
                     
                     const symbolIndexItems = document.querySelectorAll('#symbolIndex li.private');
                     symbolIndexItems.forEach(li => {
                        const link = li.querySelector('a');
                        if (link) {
                           const targetId = link.getAttribute('href').substring(1);
                           const targetEl = document.getElementById(targetId);
                           if (targetEl && targetEl.matches(selector)) {
                              li.classList.toggle("hidden", !show);
                           }
                        }
                     });
                  });
               }
            };

            hideInitial("article.imports", toggles.imports);
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            hideInitial("article.type", toggles.types);
            hideInitial("article.interface", toggles.interfaces);

            document.querySelectorAll("article.struct").forEach((article) => {
               const codeBlock = article.querySelector("code.fields-code");
               if (!codeBlock) return;

               const raw = codeBlock.textContent.trim();

               const match = raw.match(/^type\s+\w+\s+struct\s*{(.*)}$/s);
               if (!match) return;

               const fieldsRaw = match[1].trim();
               const fields = fieldsRaw.split("\n").map(line => line.trim()).filter(Boolean);

               const formatted = fields.map(line => `\t${line}`).join("\n");
               const structName = article.dataset.name;

               const finalCode = `type ${structName} struct {\n${formatted}\n}`;

               codeBlock.textContent = finalCode;

               // Apply Prism highlighting again
               if (window.Prism) Prism.highlightElement(codeBlock);

   
               if (toggles.fields) {
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               }
            });

            document
               .querySelectorAll("article.interface")
               .forEach((article) => {
                  const codeBlock = article.querySelector(
                     "code.methods-code"
                  );
                  if (!codeBlock) return;

                  const lines = codeBlock.innerHTML.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch && !trimmed.endsWith("{") && trimmed != "}") {
                           return `<span class="method-line">${line}</span>`;
                        } else {
                           return ``;
                        }

                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class="method-line${
                           isPriv ? " hidden private" : ""
                        }" data-name="${name}">${line}</span><br />`;
                     })
                     .join("");

                  codeBlock.innerHTML = newContent;

                  if (window.Prism) {
                     Prism.highlightElement(codeBlock);
                  }

                  if (toggles.fields) {
                     toggles.fields.addEventListener("change", () => {
                        const show = toggles.fields.checked;
                        article
                           .querySelectorAll(".method-line.private")
                           .forEach((el) =>
                              el.classList.toggle("hidden", !show)
                           );
                     });
                  }
               });

            const searchInput = document.getElementById("searchInput");
            if (searchInput) {
               searchInput.addEventListener("input", () => {
                  const query = searchInput.value.trim().toLowerCase();

                  document.querySelectorAll("article").forEach((el) => {
                     const name = el.dataset.name;
                     if (!name) return;

                     const matches =
                        query === "" ||
                        name.toLowerCase().includes(query) ||
                        (el.textContent &&
                           el.textContent.toLowerCase().includes(query));

                     if (matches) {
                        const isPrivateEl =
                           el.classList.contains("private");
                        const shouldShowPrivate =
                           getPrivateToggleState(el);

                        if (!isPrivateEl || shouldShowPrivate) {
                           el.classList.remove("hidden");
                        }
                     } else {
                        el.classList.add("hidden");
                     }
                  });

                  document.querySelectorAll('#symbolIndex li').forEach(li => {
                     const link = li.querySelector('a');
                     if (link) {
                        const symbolName = link.textContent.toLowerCase();
                        const matches = query === "" || symbolName.includes(query);
                        
                        if (matches) {
                           const isPrivateSymbol = li.classList.contains('private');
                           const targetId = link.getAttribute('href').substring(1);
                           const targetEl = document.getElementById(targetId);
                           const shouldShowPrivate = targetEl ? getPrivateToggleState(targetEl) : false;
                           
                           if (!isPrivateSymbol || shouldShowPrivate) {
                              li.style.display = '';
                           }
                        } else {
                           li.style.display = 'none';
                        }
                     }
                  });
               });
            }

            function getPrivateToggleState(element) {
               if (element.classList.contains("function")) {
                  return toggles.functions?.checked || false;
               } else if (element.classList.contains("struct")) {
                  return toggles.structs?.checked || false;
               } else if (element.classList.contains("global")) {
                  return toggles.globals?.checked || false;
               } else if (element.classList.contains("type")) {
                  return toggles.types?.checked || false;
               } else if (element.classList.contains("interface")) {
                  return toggles.interfaces?.checked || false;
               } else if (element.classList.contains("imports")) {
                  return toggles.imports?.checked || false;
               }
               return false;
            }

            buildSymbolIndex();

            document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
               anchor.addEventListener("click", function (e) {
                  const target = document.querySelector(
                     this.getAttribute("href")
                  );
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               });
            });

            window.addEventListener('hashchange', () => {
               const hash = window.location.hash;
               if (hash) {
                  const target = document.querySelector(hash);
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               }
            });

            if (window.location.hash) {
               setTimeout(() => {
                  const target = document.querySelector(window.location.hash);
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               }, 100);
            }
         });
      </script>
   </body>
</html>