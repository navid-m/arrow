<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - ecdsa</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 14px;
            scroll-behavior: smooth;
         }

         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
            line-height: 1.6;
         }

         .sidebar {
            width: 12%;
            background: rgba(59, 56, 56, 0.15);
            padding: 1.5rem;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.4);
            overflow-y: auto;
            position: sticky;
            top: 0;
            height: 100vh;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
         }

         .sidebar::-webkit-scrollbar {
            width: 6px;
         }

         .sidebar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
         }

         .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
         }

         main {
            flex: 1;
            padding: 2rem;
            margin: 0;
            max-width: calc(100% - 280px);
            background: linear-gradient(
               135deg,
               rgba(59, 56, 56, 0.05) 0%,
               rgba(0, 0, 0, 0.1) 100%
            );
         }

         .nav-links {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
         }

         .nav-links a {
            color: #ddd;
            text-decoration: none;
            padding: 0.5rem;
            border-radius: 4px;
            transition: all 0.2s ease;
         }

         .nav-links a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
         }

         h1 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #fff 0%, #ddd 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
         }

         h2 {
            font-size: 1.4rem;
            margin: 1rem 0 0.5rem;
            color: #f0f0f0;
         }

         h3 {
            font-size: 1.2rem;
            margin: 0.8rem 0 0.3rem;
            color: #e0e0e0;
         }

         .sidebar h2,
         .sidebar h3 {
            font-size: 1rem;
            margin: 0.5rem 0 0.3rem;
            color: #ccc;
         }

         pre {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #e6e6e6;
            padding: 1rem 1.2rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-size: 0.9rem;
            overflow-x: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
         }

         code {
            color: #f5f5f5;
            font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace;
            white-space: pre-wrap;
         }

         p {
            font-size: 15px;
            margin: 1rem 0;
            color: #ddd;
         }

         article {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(59, 56, 56, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
         }

         article:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
            transform: translateY(-2px);
         }

         .hidden {
            display: none !important;
         }

         .filter-section {
            margin-bottom: 1.5rem;
         }

         .filter-section h3 {
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #aaa;
         }

         .filter-toggle label {
            display: flex;
            align-items: center;
            margin-bottom: 0.6rem;
            font-size: 0.85rem;
            color: #bbb;
            cursor: pointer;
            padding: 0.3rem;
            border-radius: 4px;
            transition: background 0.2s ease;
         }

         .filter-toggle label:hover {
            background: rgba(255, 255, 255, 0.05);
         }

         .filter-toggle input {
            margin-right: 0.6rem;
         }

         .field-line,
         .method-line {
            display: block;
         }

         #searchInput {
            width: 100%;
            margin-bottom: 1.5rem;
            border-radius: 8px !important;
            height: 2.8rem;
            font-size: 0.9rem;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 0 1rem;
         }

         #searchInput::placeholder {
            color: rgba(255, 255, 255, 0.5);
         }

         #searchInput:focus {
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.1);
         }

         .section-divider {
            height: 1px;
            background: linear-gradient(
               90deg,
               transparent 0%,
               rgba(255, 255, 255, 0.3) 50%,
               transparent 100%
            );
            margin: 1.5rem 0;
         }

         .subpackage-list {
            list-style: none;
            padding: 0;
         }

         .subpackage-list li {
            margin-bottom: 0.4rem;
         }

         .subpackage-list a {
            display: block;
            padding: 0.5rem 0.8rem;
            color: #ccc;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-size: 0.85rem;
         }

         .subpackage-list a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            transform: translateX(4px);
         }

         .empty-state {
            color: rgba(177, 175, 175, 0.6);
            font-style: italic;
            font-size: 0.8rem;
         }

         .badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            color: #ddd;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-left: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .method-badge {
            background: rgba(100, 200, 255, 0.2);
            color: #87ceeb;
         }

         .const-badge {
            background: rgba(255, 200, 100, 0.2);
            color: #ffd700;
         }

         .var-badge {
            background: rgba(200, 255, 100, 0.2);
            color: #90ee90;
         }

         .type-badge {
            background: rgba(255, 100, 200, 0.2);
            color: #699eff;
         }

         .interface-badge {
            background: rgba(150, 100, 255, 0.2);
            color: #dda0dd;
         }

         .toc {
            position: sticky;
            top: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
         }

         .toc h4 {
            margin: 0 0 0.8rem;
            font-size: 0.9rem;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .toc ul {
            list-style: none;
            padding: 0;
            margin: 0;
         }

         .toc li {
            margin-bottom: 0.3rem;
         }

         .toc a {
            color: #bbb;
            text-decoration: none;
            font-size: 0.8rem;
            transition: color 0.2s ease;
         }

         .toc a:hover {
            color: #fff;
         }

         @media (max-width: 768px) {
            body {
               flex-direction: column;
            }

            .sidebar {
               width: 90%;
               height: auto;
               position: relative;
            }

            main {
               max-width: 100%;
               padding: 1rem;
            }
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <div class="nav-links">
            <a href="index.html" title="Home">⌂</a>
            <span>|</span>
            <a href="#" onclick="history.back()" title="Back">←</a>
         </div>

         <div class="filter-section">
            <h3>Search</h3>
            <input
               type="search"
               id="searchInput"
               placeholder="Search symbols..."
            />
         </div>

         <div class="filter-section">
            <h3>Filters</h3>
            <div class="filter-toggle">
               <label>
                  <input type="checkbox" id="showImports" />
                  Show imports
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFunctions" />
                  Show private functions
               </label>
               <label>
                  <input type="checkbox" id="showPrivateStructs" />
                  Show private structs
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFields" />
                  Show private fields
               </label>
               <label>
                  <input type="checkbox" id="showPrivateGlobals" />
                  Show private globals
               </label>
               <label>
                  <input type="checkbox" id="showPrivateTypes" />
                  Show private types
               </label>
               <label>
                  <input type="checkbox" id="showPrivateInterfaces" />
                  Show private interfaces
               </label>
            </div>
         </div>

         <div class="section-divider"></div>

         <div class="filter-section">
            <h3>Subpackages</h3>
            
            <div class="empty-state">No subpackages</div>
            
         </div>

         
         <div class="section-divider"></div>

         <div class="toc">
            <h4>Quick Navigation</h4>
            <ul>
               
               <li><a href="#globals">Constants & Variables</a></li>
                
               <li><a href="#types">Type Aliases</a></li>
                
               <li><a href="#interfaces">Interfaces</a></li>
                
               <li><a href="#structs">Structs</a></li>
                
               <li><a href="#functions">Functions</a></li>
               
            </ul>
         </div>
         
      </aside>

      <main>
         <h1>ecdsa</h1>
         <div class="section-divider"></div>

         
         <section id="imports">
            <h2>Imports</h2>
            <article class="imports" data-name="imports">
               <pre><code>"bytes"
"crypto/internal/fips140"
_ "crypto/internal/fips140/check"
"crypto/internal/fips140/sha512"
"errors"
"sync"
"bytes"
"crypto/internal/fips140"
"crypto/internal/fips140/bigmod"
"crypto/internal/fips140/drbg"
"crypto/internal/fips140/nistec"
"errors"
"io"
"sync"
"crypto/internal/fips140/bigmod"
"crypto/internal/fips140deps/cpu"
"crypto/internal/impl"
"errors"
"bytes"
"crypto/internal/fips140"
"crypto/internal/fips140/hmac"
</code></pre>
            </article>
         </section>
          
         <section id="globals">
            <h2>Constants & Variables</h2>
            
            <article class="global" data-name="_P224">
               <h3>
                  _P224 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var _P224 = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global" data-name="_P256">
               <h3>
                  _P256 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var _P256 = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global" data-name="_P384">
               <h3>
                  _P384 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var _P384 = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global" data-name="_P521">
               <h3>
                  _P521 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var _P521 = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global" data-name="fipsSelfTest">
               <h3>
                  fipsSelfTest 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var fipsSelfTest = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global" data-name="fipsSelfTestDeterministic">
               <h3>
                  fipsSelfTestDeterministic 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var fipsSelfTestDeterministic = *ast.CallExpr</code></pre>
            </article>
            
            <article class="global" data-name="maxRequestSize">
               <h3>
                  maxRequestSize 
                  <span class="badge const-badge">const</span>
                  
               </h3>
               
               <pre><code>const maxRequestSize = *ast.BinaryExpr</code></pre>
            </article>
            
            <article class="global" data-name="p224">
               <h3>
                  p224 
                  <span class="badge const-badge">const</span>
                  
               </h3>
               
               <pre><code>const p224 curveID = "P-224"</code></pre>
            </article>
            
            <article class="global" data-name="p224Order">
               <h3>
                  p224Order 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var p224Order = []byte{...}</code></pre>
            </article>
            
            <article class="global" data-name="p256">
               <h3>
                  p256 
                  <span class="badge const-badge">const</span>
                  
               </h3>
               
               <pre><code>const p256 curveID = "P-256"</code></pre>
            </article>
            
            <article class="global" data-name="p256Order">
               <h3>
                  p256Order 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var p256Order = []byte{...}</code></pre>
            </article>
            
            <article class="global" data-name="p384">
               <h3>
                  p384 
                  <span class="badge const-badge">const</span>
                  
               </h3>
               
               <pre><code>const p384 curveID = "P-384"</code></pre>
            </article>
            
            <article class="global" data-name="p384Order">
               <h3>
                  p384Order 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var p384Order = []byte{...}</code></pre>
            </article>
            
            <article class="global" data-name="p521">
               <h3>
                  p521 
                  <span class="badge const-badge">const</span>
                  
               </h3>
               
               <pre><code>const p521 curveID = "P-521"</code></pre>
            </article>
            
            <article class="global" data-name="p521Order">
               <h3>
                  p521Order 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var p521Order = []byte{...}</code></pre>
            </article>
            
            <article class="global" data-name="reseedInterval">
               <h3>
                  reseedInterval 
                  <span class="badge const-badge">const</span>
                  
               </h3>
               
               <pre><code>const reseedInterval = *ast.BinaryExpr</code></pre>
            </article>
            
            <article class="global" data-name="supportsKDSA">
               <h3>
                  supportsKDSA 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <pre><code>var supportsKDSA = cpu.S390XHasECDSA</code></pre>
            </article>
            
            <article class="global" data-name="testingOnlyRejectionSamplingLooped">
               <h3>
                  testingOnlyRejectionSamplingLooped 
                  <span class="badge var-badge">var</span>
                  
               </h3>
               
               <p>testingOnlyRejectionSamplingLooped is called when rejection sampling in
randomPoint rejects a candidate for being higher than the modulus.</p>
               
               <pre><code>var testingOnlyRejectionSamplingLooped func()</code></pre>
            </article>
            
         </section>
          
         <section id="types">
            <h2>Type Aliases</h2>
            
            <article class="type" data-name="blockAlignedPersonalizationString">
               <h3>
                  blockAlignedPersonalizationString
                  <span class="badge type-badge">type</span>
               </h3>
               
               <p>Each entry in blockAlignedPersonalizationString is written to the HMAC at a
block boundary, as specified in draft-irtf-cfrg-det-sigs-with-noise-04,
Section 4.</p>
               
               <pre><code>type blockAlignedPersonalizationString [][]byte</code></pre>
            </article>
            
            <article class="type" data-name="curveID">
               <h3>
                  curveID
                  <span class="badge type-badge">type</span>
               </h3>
               
               <pre><code>type curveID string</code></pre>
            </article>
            
            <article class="type" data-name="plainPersonalizationString">
               <h3>
                  plainPersonalizationString
                  <span class="badge type-badge">type</span>
               </h3>
               
               <p>plainPersonalizationString is used by HMAC_DRBG as-is.</p>
               
               <pre><code>type plainPersonalizationString []byte</code></pre>
            </article>
            
         </section>
          
         <section id="interfaces">
            <h2>Interfaces</h2>
            
            <article class="interface" data-name="Point">
               <h3>
                  Point
                  <span class="badge interface-badge">interface</span>
               </h3>
               
               <p>Point is a generic constraint for the [nistec] Point types.</p>
               
               <pre
                  class="methods-block"
               ><code class="methods-code">type Point interface {
*ast.BinaryExpr
Bytes() []byte
BytesX() ([]byte, error)
SetBytes([]byte) (P, error)
ScalarMult(P, []byte) (P, error)
ScalarBaseMult([]byte) (P, error)
Add(p1 P, p2 P) P
}</code></pre>
            </article>
            
            <article class="interface" data-name="personalizationString">
               <h3>
                  personalizationString
                  <span class="badge interface-badge">interface</span>
               </h3>
               
               <pre
                  class="methods-block"
               ><code class="methods-code">type personalizationString interface {
isPersonalizationString()
}</code></pre>
            </article>
            
         </section>
          
         <section id="structs">
            <h2>Structs</h2>
            
            <article class="struct" data-name="Curve">
               <h3>
                  Curve
                  <span class="badge">struct</span>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type Curve struct {
curve curveID
newPoint func() P
ordInverse func([]byte) ([]byte, error)
N *bigmod.Modulus
nMinus2 []byte
}</code></pre>
            </article>
            
            <article class="struct" data-name="PrivateKey">
               <h3>
                  PrivateKey
                  <span class="badge">struct</span>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type PrivateKey struct {
pub PublicKey
d []byte
}</code></pre>
            </article>
            
            <article class="struct" data-name="PublicKey">
               <h3>
                  PublicKey
                  <span class="badge">struct</span>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type PublicKey struct {
curve curveID
q []byte
}</code></pre>
            </article>
            
            <article class="struct" data-name="Signature">
               <h3>
                  Signature
                  <span class="badge">struct</span>
               </h3>
               
               <p>Signature is an ECDSA signature, where r and s are represented as big-endian
byte slices of the same length as the curve order.</p>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type Signature struct {
R []byte
S []byte
}</code></pre>
            </article>
            
            <article class="struct" data-name="hmacDRBG">
               <h3>
                  hmacDRBG
                  <span class="badge">struct</span>
               </h3>
               
               <p>hmacDRBG is an SP 800-90A Rev. 1 HMAC_DRBG.
It is only intended to be used to generate ECDSA nonces. Since it will be
instantiated ex-novo for each signature, its Generate function will only be
invoked once or twice (only for P-256, with probability 2⁻³²).
Per Table 2, it has a reseed interval of 2^48 requests, and a maximum request
size of 2^19 bits (2^16 bytes, 64 KiB).</p>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type hmacDRBG struct {
newHMAC func(key []byte) *hmac.HMAC
hK *hmac.HMAC
V []byte
reseedCounter uint64
}</code></pre>
            </article>
            
         </section>
          
         <section id="functions">
            <h2>Functions</h2>
            
            <article class="function" data-name="Bytes">
               <h3>
                  Bytes 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (priv *PrivateKey) Bytes() []byte</code></pre>
            </article>
            
            <article class="function" data-name="Bytes">
               <h3>
                  Bytes 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (pub *PublicKey) Bytes() []byte</code></pre>
            </article>
            
            <article class="function" data-name="Generate">
               <h3>
                  Generate 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <p>Generate produces at most maxRequestSize bytes of random data in out.</p>
               
               <pre><code>func (d *hmacDRBG) Generate(out []byte)</code></pre>
            </article>
            
            <article class="function" data-name="GenerateKey">
               <h3>
                  GenerateKey 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>GenerateKey generates a new ECDSA private key pair for the specified curve.</p>
               
               <pre><code>func GenerateKey(c **ast.IndexExpr, rand io.Reader) (*PrivateKey, error)</code></pre>
            </article>
            
            <article class="function" data-name="NewPrivateKey">
               <h3>
                  NewPrivateKey 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func NewPrivateKey(c **ast.IndexExpr, D []byte, Q []byte) (*PrivateKey, error)</code></pre>
            </article>
            
            <article class="function" data-name="NewPublicKey">
               <h3>
                  NewPublicKey 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func NewPublicKey(c **ast.IndexExpr, Q []byte) (*PublicKey, error)</code></pre>
            </article>
            
            <article class="function" data-name="P224">
               <h3>
                  P224 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func P224() **ast.IndexExpr</code></pre>
            </article>
            
            <article class="function" data-name="P256">
               <h3>
                  P256 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func P256() **ast.IndexExpr</code></pre>
            </article>
            
            <article class="function" data-name="P384">
               <h3>
                  P384 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func P384() **ast.IndexExpr</code></pre>
            </article>
            
            <article class="function" data-name="P521">
               <h3>
                  P521 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func P521() **ast.IndexExpr</code></pre>
            </article>
            
            <article class="function" data-name="PublicKey">
               <h3>
                  PublicKey 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (priv *PrivateKey) PublicKey() *PublicKey</code></pre>
            </article>
            
            <article class="function" data-name="Sign">
               <h3>
                  Sign 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>Sign signs a hash (which shall be the result of hashing a larger message with
the hash function H) using the private key, priv. If the hash is longer than
the bit-length of the private key's curve order, the hash will be truncated
to that length.</p>
               
               <pre><code>func Sign(c **ast.IndexExpr, h func() H, priv *PrivateKey, rand io.Reader, hash []byte) (*Signature, error)</code></pre>
            </article>
            
            <article class="function" data-name="SignDeterministic">
               <h3>
                  SignDeterministic 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>SignDeterministic signs a hash (which shall be the result of hashing a
larger message with the hash function H) using the private key, priv. If the
hash is longer than the bit-length of the private key's curve order, the hash
will be truncated to that length. This applies Deterministic ECDSA as
specified in FIPS 186-5 and RFC 6979.</p>
               
               <pre><code>func SignDeterministic(c **ast.IndexExpr, h func() H, priv *PrivateKey, hash []byte) (*Signature, error)</code></pre>
            </article>
            
            <article class="function" data-name="Verify">
               <h3>
                  Verify 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>Verify verifies the signature, sig, of hash (which should be the result of
hashing a larger message) using the public key, pub. If the hash is longer
than the bit-length of the private key's curve order, the hash will be
truncated to that length.
The inputs are not considered confidential, and may leak through timing side
channels, or if an attacker has control of part of the inputs.</p>
               
               <pre><code>func Verify(c **ast.IndexExpr, pub *PublicKey, hash []byte, sig *Signature) error</code></pre>
            </article>
            
            <article class="function" data-name="appendBlock">
               <h3>
                  appendBlock 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func appendBlock(p []byte, blocksize int, b []byte) []byte</code></pre>
            </article>
            
            <article class="function" data-name="bits2octets">
               <h3>
                  bits2octets 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>bits2octets as specified in FIPS 186-5, Appendix B.2.4 or RFC 6979,
Section 2.3.4. See RFC 6979, Section 3.5 for the rationale.</p>
               
               <pre><code>func bits2octets(c **ast.IndexExpr, hash []byte) []byte</code></pre>
            </article>
            
            <article class="function" data-name="canUseKDSA">
               <h3>
                  canUseKDSA 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>canUseKDSA checks if KDSA instruction is available, and if it is, it checks
the name of the curve to see if it matches the curves supported(P-256, P-384, P-521).
Then, based on the curve name, a function code and a block size will be assigned.
If KDSA instruction is not available or if the curve is not supported, canUseKDSA
will set ok to false.</p>
               
               <pre><code>func canUseKDSA(c curveID) (functionCode uint64, blockSize int, ok bool)</code></pre>
            </article>
            
            <article class="function" data-name="fipsPCT">
               <h3>
                  fipsPCT 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func fipsPCT(c **ast.IndexExpr, k *PrivateKey) error</code></pre>
            </article>
            
            <article class="function" data-name="hashToBytes">
               <h3>
                  hashToBytes 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func hashToBytes(c **ast.IndexExpr, hash []byte) []byte</code></pre>
            </article>
            
            <article class="function" data-name="hashToNat">
               <h3>
                  hashToNat 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>hashToNat sets e to the left-most bits of hash, according to
FIPS 186-5, Section 6.4.1, point 2 and Section 6.4.2, point 3.</p>
               
               <pre><code>func hashToNat(c **ast.IndexExpr, e *bigmod.Nat, hash []byte)</code></pre>
            </article>
            
            <article class="function" data-name="init">
               <h3>
                  init 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func init()</code></pre>
            </article>
            
            <article class="function" data-name="inverse">
               <h3>
                  inverse 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>inverse sets kInv to the inverse of k modulo the order of the curve.</p>
               
               <pre><code>func inverse(c **ast.IndexExpr, kInv *bigmod.Nat, k *bigmod.Nat)</code></pre>
            </article>
            
            <article class="function" data-name="isPersonalizationString">
               <h3>
                  isPersonalizationString 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (blockAlignedPersonalizationString) isPersonalizationString()</code></pre>
            </article>
            
            <article class="function" data-name="isPersonalizationString">
               <h3>
                  isPersonalizationString 
                  <span class="badge method-badge">method</span>
                  
               </h3>
               
               <pre><code>func (plainPersonalizationString) isPersonalizationString()</code></pre>
            </article>
            
            <article class="function" data-name="kdsa">
               <h3>
                  kdsa 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>kdsa invokes the "compute digital signature authentication"
instruction with the given function code and 4096 byte
parameter block.
The return value corresponds to the condition code set by the
instruction. Interrupted invocations are handled by the
function.
go:noescape</p>
               
               <pre><code>func kdsa(fc uint64, params *[4096]byte) (errn uint64)</code></pre>
            </article>
            
            <article class="function" data-name="newDRBG">
               <h3>
                  newDRBG 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func newDRBG(hash func() H, entropy []byte, nonce []byte, s personalizationString) *hmacDRBG</code></pre>
            </article>
            
            <article class="function" data-name="pad000">
               <h3>
                  pad000 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func pad000(h *hmac.HMAC, writtenSoFar int)</code></pre>
            </article>
            
            <article class="function" data-name="precomputeParams">
               <h3>
                  precomputeParams 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func precomputeParams(c **ast.IndexExpr, order []byte)</code></pre>
            </article>
            
            <article class="function" data-name="randomPoint">
               <h3>
                  randomPoint 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>randomPoint returns a random scalar and the corresponding point using a
procedure equivalent to FIPS 186-5, Appendix A.2.2 (ECDSA Key Pair Generation
by Rejection Sampling) and to Appendix A.3.2 (Per-Message Secret Number
Generation of Private Keys by Rejection Sampling) or Appendix A.3.3
(Per-Message Secret Number Generation for Deterministic ECDSA) followed by
Step 5 of Section 6.4.1.</p>
               
               <pre><code>func randomPoint(c **ast.IndexExpr, generate func([]byte) error) (k *bigmod.Nat, p P, err error)</code></pre>
            </article>
            
            <article class="function" data-name="randomScalar">
               <h3>
                  randomScalar 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>randomScalar is a copy of [randomPoint] that doesn't call ScalarBaseMult.</p>
               
               <pre><code>func randomScalar(c **ast.IndexExpr, generate func([]byte) error) (k *bigmod.Nat, err error)</code></pre>
            </article>
            
            <article class="function" data-name="rightShift">
               <h3>
                  rightShift 
                  <span class="badge">function</span>
                  
               </h3>
               
               <p>rightShift implements the right shift necessary for bits2int, which takes the
leftmost bits of either the hash or HMAC_DRBG output.
Note how taking the rightmost bits would have been as easy as masking the
first byte, but we can't have nice things.</p>
               
               <pre><code>func rightShift(b []byte, shift int) []byte</code></pre>
            </article>
            
            <article class="function" data-name="sign">
               <h3>
                  sign 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func sign(c **ast.IndexExpr, priv *PrivateKey, drbg *hmacDRBG, hash []byte) (*Signature, error)</code></pre>
            </article>
            
            <article class="function" data-name="sign">
               <h3>
                  sign 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func sign(c **ast.IndexExpr, priv *PrivateKey, drbg *hmacDRBG, hash []byte) (*Signature, error)</code></pre>
            </article>
            
            <article class="function" data-name="signGeneric">
               <h3>
                  signGeneric 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func signGeneric(c **ast.IndexExpr, priv *PrivateKey, drbg *hmacDRBG, hash []byte) (*Signature, error)</code></pre>
            </article>
            
            <article class="function" data-name="testHash">
               <h3>
                  testHash 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func testHash() []byte</code></pre>
            </article>
            
            <article class="function" data-name="testPrivateKey">
               <h3>
                  testPrivateKey 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func testPrivateKey() *PrivateKey</code></pre>
            </article>
            
            <article class="function" data-name="trimBlock">
               <h3>
                  trimBlock 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func trimBlock(p []byte, size int) ([]byte, error)</code></pre>
            </article>
            
            <article class="function" data-name="verify">
               <h3>
                  verify 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func verify(c **ast.IndexExpr, pub *PublicKey, hash []byte, sig *Signature) error</code></pre>
            </article>
            
            <article class="function" data-name="verify">
               <h3>
                  verify 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func verify(c **ast.IndexExpr, pub *PublicKey, hash []byte, sig *Signature) error</code></pre>
            </article>
            
            <article class="function" data-name="verifyGeneric">
               <h3>
                  verifyGeneric 
                  <span class="badge">function</span>
                  
               </h3>
               
               <pre><code>func verifyGeneric(c **ast.IndexExpr, pub *PublicKey, hash []byte, sig *Signature) error</code></pre>
            </article>
            
         </section>
         
      </main>

      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }

         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               imports: document.getElementById("showImports"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
               types: document.getElementById("showPrivateTypes"),
               interfaces: document.getElementById(
                  "showPrivateInterfaces"
               ),
            };

            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });

               if (toggle) {
                  toggle.addEventListener("change", () => {
                     const show = toggle.checked;
                     document
                        .querySelectorAll(`${selector}.private`)
                        .forEach((el) => {
                           el.classList.toggle("hidden", !show);
                        });
                  });
               }
            };

            hideInitial("article.imports", toggles.imports);
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            hideInitial("article.type", toggles.types);
            hideInitial("article.interface", toggles.interfaces);

            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;

                  const lines = codeBlock.innerHTML.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch && trimmed != "}") {
                           return `<span class="field-line">${line}</span>`;
                        }
                        if (nameMatch == null) return;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class="field-line${
                           isPriv ? " hidden private" : ""
                        }" data-name="${name}">${line}</span>`;
                     })
                     .join("");

                  codeBlock.innerHTML = newContent;

                  if (toggles.fields) {
                     toggles.fields.addEventListener("change", () => {
                        const show = toggles.fields.checked;
                        article
                           .querySelectorAll(".field-line.private")
                           .forEach((el) =>
                              el.classList.toggle("hidden", !show)
                           );
                     });
                  }
               });

            // Handle private methods in interfaces
            document
               .querySelectorAll("article.interface")
               .forEach((article) => {
                  const codeBlock = article.querySelector(
                     "code.methods-code"
                  );
                  if (!codeBlock) return;

                  const lines = codeBlock.innerHTML.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch) {
                           return `<span class="method-line">${line}</span>`;
                        }

                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class="method-line${
                           isPriv ? " hidden private" : ""
                        }" data-name="${name}">${line}</span>`;
                     })
                     .join("");

                  codeBlock.innerHTML = newContent;

                  if (toggles.fields) {
                     // Reuse fields toggle for interface methods
                     toggles.fields.addEventListener("change", () => {
                        const show = toggles.fields.checked;
                        article
                           .querySelectorAll(".method-line.private")
                           .forEach((el) =>
                              el.classList.toggle("hidden", !show)
                           );
                     });
                  }
               });

            const searchInput = document.getElementById("searchInput");
            if (searchInput) {
               searchInput.addEventListener("input", () => {
                  const query = searchInput.value.trim().toLowerCase();

                  document.querySelectorAll("article").forEach((el) => {
                     const name = el.dataset.name;
                     if (!name) return;

                     const matches =
                        query === "" ||
                        name.toLowerCase().includes(query) ||
                        (el.textContent &&
                           el.textContent.toLowerCase().includes(query));

                     if (matches) {
                        // Only show if not hidden by privacy filters
                        const isPrivateEl =
                           el.classList.contains("private");
                        const shouldShowPrivate =
                           getPrivateToggleState(el);

                        if (!isPrivateEl || shouldShowPrivate) {
                           el.classList.remove("hidden");
                        }
                     } else {
                        el.classList.add("hidden");
                     }
                  });
               });
            }

            // Helper function to check if private elements should be shown
            function getPrivateToggleState(element) {
               if (element.classList.contains("function")) {
                  return toggles.functions?.checked || false;
               } else if (element.classList.contains("struct")) {
                  return toggles.structs?.checked || false;
               } else if (element.classList.contains("global")) {
                  return toggles.globals?.checked || false;
               } else if (element.classList.contains("type")) {
                  return toggles.types?.checked || false;
               } else if (element.classList.contains("interface")) {
                  return toggles.interfaces?.checked || false;
               } else if (element.classList.contains("imports")) {
                  return toggles.imports?.checked || false;
               }
               return false;
            }

            document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
               anchor.addEventListener("click", function (e) {
                  e.preventDefault();
                  const target = document.querySelector(
                     this.getAttribute("href")
                  );
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               });
            });
         });
      </script>
   </body>
</html>
