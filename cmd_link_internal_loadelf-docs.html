<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - loadelf</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>loadelf</code>
         </h1>
         <hr />
         
         <article class="global" data-name="SHT_ARM_ATTRIBUTES">
            <h2>SHT_ARM_ATTRIBUTES</h2>
            <hr />
            
            <pre><code>SHT_ARM_ATTRIBUTES</code></pre>
         </article>
         
         <article class="global" data-name="TagFile">
            <h2>TagFile</h2>
            <hr />
            
            <pre><code>TagFile</code></pre>
         </article>
         
         <article class="global" data-name="TagCPUName">
            <h2>TagCPUName</h2>
            <hr />
            
            <pre><code>TagCPUName</code></pre>
         </article>
         
         <article class="global" data-name="TagCPURawName">
            <h2>TagCPURawName</h2>
            <hr />
            
            <pre><code>TagCPURawName</code></pre>
         </article>
         
         <article class="global" data-name="TagCompatibility">
            <h2>TagCompatibility</h2>
            <hr />
            
            <pre><code>TagCompatibility</code></pre>
         </article>
         
         <article class="global" data-name="TagNoDefaults">
            <h2>TagNoDefaults</h2>
            <hr />
            
            <pre><code>TagNoDefaults</code></pre>
         </article>
         
         <article class="global" data-name="TagAlsoCompatibleWith">
            <h2>TagAlsoCompatibleWith</h2>
            <hr />
            
            <pre><code>TagAlsoCompatibleWith</code></pre>
         </article>
         
         <article class="global" data-name="TagABIVFPArgs">
            <h2>TagABIVFPArgs</h2>
            <hr />
            
            <pre><code>TagABIVFPArgs</code></pre>
         </article>
          
         <article class="struct" data-name="ElfSect">
            <h2>type ElfSect struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">name string
nameoff uint32
type_ elf.SectionType
flags elf.SectionFlag
addr uint64
off uint64
size uint64
link uint32
info uint32
align uint64
entsize uint64
base []byte
readOnlyMem bool
sym loader.Sym</code></pre>
         </article>
         
         <article class="struct" data-name="ElfObj">
            <h2>type ElfObj struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">f *bio.Reader
base int64
length int64
is64 int
name string
e binary.ByteOrder
sect []ElfSect
nsect uint
nsymtab int
symtab *ElfSect
symstr *ElfSect
type_ uint32
machine uint32
version uint32
entry uint64
phoff uint64
shoff uint64
flags uint32
ehsize uint32
phentsize uint32
phnum uint32
shentsize uint32
shnum uint32
shstrndx uint32</code></pre>
         </article>
         
         <article class="struct" data-name="ElfSym">
            <h2>type ElfSym struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">name string
value uint64
size uint64
bind elf.SymBind
type_ elf.SymType
other uint8
shndx elf.SectionIndex
sym loader.Sym</code></pre>
         </article>
         
         <article class="struct" data-name="elfAttribute">
            <h2>type elfAttribute struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">tag uint64
sval string
ival uint64</code></pre>
         </article>
         
         <article class="struct" data-name="elfAttributeList">
            <h2>type elfAttributeList struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">data []byte
err error</code></pre>
         </article>
          
         <article class="function" data-name="string">
            <h2>string</h2>
            <hr />
            
            <pre><code>func string() string</code></pre>
         </article>
         
         <article class="function" data-name="uleb128">
            <h2>uleb128</h2>
            <hr />
            
            <pre><code>func uleb128() uint64</code></pre>
         </article>
         
         <article class="function" data-name="armAttr">
            <h2>armAttr</h2>
            <hr />
            
            <p>Read an elfAttribute from the list following the rules used on ARM systems.</p>
            
            <pre><code>func armAttr() elfAttribute</code></pre>
         </article>
         
         <article class="function" data-name="done">
            <h2>done</h2>
            <hr />
            
            <pre><code>func done() bool</code></pre>
         </article>
         
         <article class="function" data-name="parseArmAttributes">
            <h2>parseArmAttributes</h2>
            <hr />
            
            <p>Look for the attribute that indicates the object uses the hard-float ABI (a
file-level attribute with tag Tag_VFP_arch and value 1). Unfortunately the
format used means that we have to parse all of the file-level attributes to
find the one we are looking for. This format is slightly documented in "ELF
for the ARM Architecture" but mostly this is derived from reading the source
to gold and readelf.</p>
            
            <pre><code>func parseArmAttributes(e binary.ByteOrder, data []byte) (found bool, ehdrFlags uint32, err error)</code></pre>
         </article>
         
         <article class="function" data-name="Load">
            <h2>Load</h2>
            <hr />
            
            <p>Load loads the ELF file pn from f.
Symbols are installed into the loader, and a slice of the text symbols is returned.

On ARM systems, Load will attempt to determine what ELF header flags to
emit by scanning the attributes in the ELF file being loaded. The
parameter initEhdrFlags contains the current header flags for the output
object, and the returned ehdrFlags contains what this Load function computes.
TODO: find a better place for this logic.</p>
            
            <pre><code>func Load(l *loader.Loader, arch *sys.Arch, localSymVersion int, f *bio.Reader, pkg string, length int64, pn string, initEhdrFlags uint32) (textp []loader.Sym, ehdrFlags uint32, err error)</code></pre>
         </article>
         
         <article class="function" data-name="section">
            <h2>section</h2>
            <hr />
            
            <pre><code>func section(elfobj *ElfObj, name string) *ElfSect</code></pre>
         </article>
         
         <article class="function" data-name="elfmap">
            <h2>elfmap</h2>
            <hr />
            
            <pre><code>func elfmap(elfobj *ElfObj, sect *ElfSect) err error</code></pre>
         </article>
         
         <article class="function" data-name="readelfsym">
            <h2>readelfsym</h2>
            <hr />
            
            <pre><code>func readelfsym(l *loader.Loader, arch *sys.Arch, elfobj *ElfObj, i int, elfsym *ElfSym, needSym int, localSymVersion int) err error</code></pre>
         </article>
         
         <article class="function" data-name="relSize">
            <h2>relSize</h2>
            <hr />
            
            <p>Return the size of the relocated field, and the size of the addend as the first
and second values. Note, the addend may be larger than the relocation field in
some cases when a relocated value is split across multiple relocations.</p>
            
            <pre><code>func relSize(arch *sys.Arch, pn string, elftype uint32) (uint8, uint8, error)</code></pre>
         </article>
         
         <article class="function" data-name="cstring">
            <h2>cstring</h2>
            <hr />
            
            <pre><code>func cstring(x []byte) string</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
