<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - loadelf</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 14px;
            scroll-behavior: smooth;
         }

         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
            line-height: 1.6;
         }

         .sidebar {
            width: 12%;
            background: rgba(59, 56, 56, 0.15);
            padding: 1.5rem;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.4);
            overflow-y: auto;
            position: sticky;
            top: 0;
            height: 100vh;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
         }

         .sidebar::-webkit-scrollbar {
            width: 6px;
         }

         .sidebar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
         }

         .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
         }

         main {
            flex: 1;
            padding: 2rem;
            margin: 0;
            max-width: calc(100% - 280px);
            background: linear-gradient(
               135deg,
               rgba(59, 56, 56, 0.05) 0%,
               rgba(0, 0, 0, 0.1) 100%
            );
         }

         .nav-links {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
         }

         .nav-links a {
            color: #ddd;
            text-decoration: none;
            padding: 0.5rem;
            border-radius: 4px;
            transition: all 0.2s ease;
         }

         .nav-links a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
         }

         h1 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #fff 0%, #ddd 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
         }

         h2 {
            font-size: 1.4rem;
            margin: 1rem 0 0.5rem;
            color: #f0f0f0;
         }

         h3 {
            font-size: 1.2rem;
            margin: 0.8rem 0 0.3rem;
            color: #e0e0e0;
            position: relative;
         }

         .sidebar h2,
         .sidebar h3 {
            font-size: 1rem;
            margin: 0.5rem 0 0.3rem;
            color: #ccc;
         }

         /* Anchor link styling */
         .anchor {
            color: rgba(255, 255, 255, 0.3);
            text-decoration: none;
            font-weight: normal;
            margin-left: 0.5rem;
            opacity: 0;
            transition: opacity 0.2s ease;
            font-size: 0.8em;
         }

         h3:hover .anchor,
         .anchor:focus {
            opacity: 1;
         }

         .anchor:hover {
            color: rgba(255, 255, 255, 0.6);
         }

         /* Scroll target offset for fixed elements */
         .symbol-anchor {
            scroll-margin-top: 2rem;
         }

         pre {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #e6e6e6;
            padding: 1rem 1.2rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-size: 0.9rem;
            overflow-x: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
         }

         code {
            color: #f5f5f5;
            font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace;
            white-space: pre-wrap;
         }

         p {
            font-size: 15px;
            margin: 1rem 0;
            color: #ddd;
         }

         article {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(59, 56, 56, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
         }

         article:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
            transform: translateY(-2px);
         }

         article:target {
            border-color: rgba(100, 200, 255, 0.5);
            box-shadow: 0 0 0 2px rgba(100, 200, 255, 0.2);
         }

         .hidden {
            display: none !important;
         }

         .filter-section {
            margin-bottom: 1.5rem;
         }

         .filter-section h3 {
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #aaa;
         }

         .filter-toggle label {
            display: flex;
            align-items: center;
            margin-bottom: 0.6rem;
            font-size: 0.85rem;
            color: #bbb;
            cursor: pointer;
            padding: 0.3rem;
            border-radius: 4px;
            transition: background 0.2s ease;
         }

         .filter-toggle label:hover {
            background: rgba(255, 255, 255, 0.05);
         }

         .filter-toggle input {
            margin-right: 0.6rem;
         }

         .field-line,
         .method-line {
            display: block;
         }

         #searchInput {
            width: 100%;
            margin-bottom: 1.5rem;
            border-radius: 8px !important;
            height: 2.8rem;
            font-size: 0.9rem;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 0 1rem;
         }

         #searchInput::placeholder {
            color: rgba(255, 255, 255, 0.5);
         }

         #searchInput:focus {
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.1);
         }

         .section-divider {
            height: 1px;
            background: linear-gradient(
               90deg,
               transparent 0%,
               rgba(255, 255, 255, 0.3) 50%,
               transparent 100%
            );
            margin: 1.5rem 0;
         }

         .subpackage-list {
            list-style: none;
            padding: 0;
         }

         .subpackage-list li {
            margin-bottom: 0.4rem;
         }

         .subpackage-list a {
            display: block;
            padding: 0.5rem 0.8rem;
            color: #ccc;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-size: 0.85rem;
         }

         .subpackage-list a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            transform: translateX(4px);
         }

         .empty-state {
            color: rgba(177, 175, 175, 0.6);
            font-style: italic;
            font-size: 0.8rem;
         }

         .badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            color: #ddd;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-left: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .method-badge {
            background: rgba(100, 200, 255, 0.2);
            color: #87ceeb;
         }

         .const-badge {
            background: rgba(255, 200, 100, 0.2);
            color: #ffd700;
         }

         .var-badge {
            background: rgba(200, 255, 100, 0.2);
            color: #90ee90;
         }

         .type-badge {
            background: rgba(255, 100, 200, 0.2);
            color: #699eff;
         }

         .interface-badge {
            background: rgba(150, 100, 255, 0.2);
            color: #dda0dd;
         }

         .toc {
            position: sticky;
            top: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
         }

         .toc h4 {
            margin: 0 0 0.8rem;
            font-size: 0.9rem;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .toc ul {
            list-style: none;
            padding: 0;
            margin: 0;
         }

         .toc li {
            margin-bottom: 0.3rem;
         }

         .toc a {
            color: #bbb;
            text-decoration: none;
            font-size: 0.8rem;
            transition: color 0.2s ease;
         }

         .toc a:hover {
            color: #fff;
         }

         .symbol-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            background: rgba(0, 0, 0, 0.2);
         }

         .symbol-list::-webkit-scrollbar {
            width: 4px;
         }

         .symbol-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
         }

         .symbol-list ul {
            list-style: none;
            padding: 0.5rem;
            margin: 0;
         }

         .symbol-list li {
            margin-bottom: 0.2rem;
         }

         .symbol-list a {
            display: block;
            padding: 0.3rem 0.5rem;
            color: #bbb;
            text-decoration: none;
            border-radius: 4px;
            transition: all 0.2s ease;
            font-size: 0.75rem;
         }

         .symbol-list a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
         }

         @media (max-width: 768px) {
            body {
               flex-direction: column;
            }

            .sidebar {
               width: 90%;
               height: auto;
               position: relative;
            }

            main {
               max-width: 100%;
               padding: 1rem;
            }
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <div class="nav-links">
            <a href="index.html" title="Home">⌂</a>
            <span>|</span>
            <a href="#" onclick="history.back()" title="Back">←</a>
         </div>

         <div class="filter-section">
            <h3>Search</h3>
            <input
               type="search"
               id="searchInput"
               placeholder="Search symbols..."
            />
         </div>

         <div class="filter-section">
            <h3>Filters</h3>
            <div class="filter-toggle">
               <label>
                  <input type="checkbox" id="showImports" />
                  Show imports
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFunctions" />
                  Show private functions
               </label>
               <label>
                  <input type="checkbox" id="showPrivateStructs" />
                  Show private structs
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFields" />
                  Show private fields
               </label>
               <label>
                  <input type="checkbox" id="showPrivateGlobals" />
                  Show private globals
               </label>
               <label>
                  <input type="checkbox" id="showPrivateTypes" />
                  Show private types
               </label>
               <label>
                  <input type="checkbox" id="showPrivateInterfaces" />
                  Show private interfaces
               </label>
            </div>
         </div>

         <div class="section-divider"></div>

         <div class="filter-section">
            <h3>Subpackages</h3>
            
            <div class="empty-state">No subpackages</div>
            
         </div>

         
         <div class="section-divider"></div>

         <div class="toc">
            <h4>Quick Navigation</h4>
            <ul>
               
               <li><a href="#globals">Constants & Variables</a></li>
                  
               <li><a href="#structs">Structs</a></li>
                
               <li><a href="#functions">Functions</a></li>
               
            </ul>
         </div>

         <div class="filter-section">
            <h3>All Symbols</h3>
            <div class="symbol-list">
               <ul id="symbolIndex">
               </ul>
            </div>
         </div>
         
      </aside>

      <main>
         <h1>loadelf</h1>
         <div class="section-divider"></div>

         
         <section id="imports">
            <h2>Imports</h2>
            <article class="imports symbol-anchor" id="imports-section" data-name="imports">
               <h3>
                  Imports
                  <a href="#imports-section" class="anchor" title="Link to imports">#</a>
               </h3>
               <pre><code>"bytes"
"cmd/internal/bio"
"cmd/internal/objabi"
"cmd/internal/sys"
"cmd/link/internal/loader"
"cmd/link/internal/sym"
"debug/elf"
"encoding/binary"
"fmt"
"io"
"log"
"strings"
</code></pre>
            </article>
         </section>
          
         <section id="globals">
            <h2>Constants & Variables</h2>
            
            <article class="global symbol-anchor" id="SHT_ARM_ATTRIBUTES" data-name="SHT_ARM_ATTRIBUTES">
               <h3>
                  SHT_ARM_ATTRIBUTES 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#SHT_ARM_ATTRIBUTES" class="anchor" title="Link to SHT_ARM_ATTRIBUTES">#</a>
               </h3>
               
               <pre><code>const SHT_ARM_ATTRIBUTES = 0x70000003</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="TagABIVFPArgs" data-name="TagABIVFPArgs">
               <h3>
                  TagABIVFPArgs 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#TagABIVFPArgs" class="anchor" title="Link to TagABIVFPArgs">#</a>
               </h3>
               
               <pre><code>const TagABIVFPArgs = 28</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="TagAlsoCompatibleWith" data-name="TagAlsoCompatibleWith">
               <h3>
                  TagAlsoCompatibleWith 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#TagAlsoCompatibleWith" class="anchor" title="Link to TagAlsoCompatibleWith">#</a>
               </h3>
               
               <pre><code>const TagAlsoCompatibleWith = 65</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="TagCPUName" data-name="TagCPUName">
               <h3>
                  TagCPUName 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#TagCPUName" class="anchor" title="Link to TagCPUName">#</a>
               </h3>
               
               <pre><code>const TagCPUName = 4</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="TagCPURawName" data-name="TagCPURawName">
               <h3>
                  TagCPURawName 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#TagCPURawName" class="anchor" title="Link to TagCPURawName">#</a>
               </h3>
               
               <pre><code>const TagCPURawName = 5</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="TagCompatibility" data-name="TagCompatibility">
               <h3>
                  TagCompatibility 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#TagCompatibility" class="anchor" title="Link to TagCompatibility">#</a>
               </h3>
               
               <pre><code>const TagCompatibility = 32</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="TagFile" data-name="TagFile">
               <h3>
                  TagFile 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#TagFile" class="anchor" title="Link to TagFile">#</a>
               </h3>
               
               <pre><code>const TagFile = 1</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="TagNoDefaults" data-name="TagNoDefaults">
               <h3>
                  TagNoDefaults 
                  <span class="badge const-badge">const</span>
                  
                  <a href="#TagNoDefaults" class="anchor" title="Link to TagNoDefaults">#</a>
               </h3>
               
               <pre><code>const TagNoDefaults = 64</code></pre>
            </article>
            
         </section>
            
         <section id="structs">
            <h2>Structs</h2>
            
            <article class="struct symbol-anchor" id="ElfObj" data-name="ElfObj">
               <h3>
                  ElfObj
                  <span class="badge">struct</span>
                  <a href="#ElfObj" class="anchor" title="Link to ElfObj">#</a>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type ElfObj struct {
f *bio.Reader
base int64
length int64
is64 int
name string
e binary.ByteOrder
sect []ElfSect
nsect uint
nsymtab int
symtab *ElfSect
symstr *ElfSect
type_ uint32
machine uint32
version uint32
entry uint64
phoff uint64
shoff uint64
flags uint32
ehsize uint32
phentsize uint32
phnum uint32
shentsize uint32
shnum uint32
shstrndx uint32
}</code></pre>
            </article>
            
            <article class="struct symbol-anchor" id="ElfSect" data-name="ElfSect">
               <h3>
                  ElfSect
                  <span class="badge">struct</span>
                  <a href="#ElfSect" class="anchor" title="Link to ElfSect">#</a>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type ElfSect struct {
name string
nameoff uint32
type_ elf.SectionType
flags elf.SectionFlag
addr uint64
off uint64
size uint64
link uint32
info uint32
align uint64
entsize uint64
base []byte
readOnlyMem bool
sym loader.Sym
}</code></pre>
            </article>
            
            <article class="struct symbol-anchor" id="ElfSym" data-name="ElfSym">
               <h3>
                  ElfSym
                  <span class="badge">struct</span>
                  <a href="#ElfSym" class="anchor" title="Link to ElfSym">#</a>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type ElfSym struct {
name string
value uint64
size uint64
bind elf.SymBind
type_ elf.SymType
other uint8
shndx elf.SectionIndex
sym loader.Sym
}</code></pre>
            </article>
            
            <article class="struct symbol-anchor" id="elfAttribute" data-name="elfAttribute">
               <h3>
                  elfAttribute
                  <span class="badge">struct</span>
                  <a href="#elfAttribute" class="anchor" title="Link to elfAttribute">#</a>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type elfAttribute struct {
tag uint64
sval string
ival uint64
}</code></pre>
            </article>
            
            <article class="struct symbol-anchor" id="elfAttributeList" data-name="elfAttributeList">
               <h3>
                  elfAttributeList
                  <span class="badge">struct</span>
                  <a href="#elfAttributeList" class="anchor" title="Link to elfAttributeList">#</a>
               </h3>
               
               <pre
                  class="fields-block"
               ><code class="fields-code">type elfAttributeList struct {
data []byte
err error
}</code></pre>
            </article>
            
         </section>
          
         <section id="functions">
            <h2>Functions</h2>
            
            <article class="function symbol-anchor" id="Load" data-name="Load">
               <h3>
                  Load 
                  <span class="badge">function</span>
                  
                  <a href="#Load" class="anchor" title="Link to Load">#</a>
               </h3>
               
               <p>Load loads the ELF file pn from f.
Symbols are installed into the loader, and a slice of the text symbols is returned.
On ARM systems, Load will attempt to determine what ELF header flags to
emit by scanning the attributes in the ELF file being loaded. The
parameter initEhdrFlags contains the current header flags for the output
object, and the returned ehdrFlags contains what this Load function computes.
TODO: find a better place for this logic.</p>
               
               <pre><code>func Load(l *loader.Loader, arch *sys.Arch, localSymVersion int, f *bio.Reader, pkg string, length int64, pn string, initEhdrFlags uint32) (textp []loader.Sym, ehdrFlags uint32, err error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="armAttr" data-name="armAttr">
               <h3>
                  armAttr 
                  <span class="badge method-badge">method</span>
                  
                  <a href="#armAttr" class="anchor" title="Link to armAttr">#</a>
               </h3>
               
               <p>Read an elfAttribute from the list following the rules used on ARM systems.</p>
               
               <pre><code>func (a *elfAttributeList) armAttr() elfAttribute</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="cstring" data-name="cstring">
               <h3>
                  cstring 
                  <span class="badge">function</span>
                  
                  <a href="#cstring" class="anchor" title="Link to cstring">#</a>
               </h3>
               
               <pre><code>func cstring(x []byte) string</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="done" data-name="done">
               <h3>
                  done 
                  <span class="badge method-badge">method</span>
                  
                  <a href="#done" class="anchor" title="Link to done">#</a>
               </h3>
               
               <pre><code>func (a *elfAttributeList) done() bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="elfmap" data-name="elfmap">
               <h3>
                  elfmap 
                  <span class="badge">function</span>
                  
                  <a href="#elfmap" class="anchor" title="Link to elfmap">#</a>
               </h3>
               
               <pre><code>func elfmap(elfobj *ElfObj, sect *ElfSect) (err error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="parseArmAttributes" data-name="parseArmAttributes">
               <h3>
                  parseArmAttributes 
                  <span class="badge">function</span>
                  
                  <a href="#parseArmAttributes" class="anchor" title="Link to parseArmAttributes">#</a>
               </h3>
               
               <p>Look for the attribute that indicates the object uses the hard-float ABI (a
file-level attribute with tag Tag_VFP_arch and value 1). Unfortunately the
format used means that we have to parse all of the file-level attributes to
find the one we are looking for. This format is slightly documented in "ELF
for the ARM Architecture" but mostly this is derived from reading the source
to gold and readelf.</p>
               
               <pre><code>func parseArmAttributes(e binary.ByteOrder, data []byte) (found bool, ehdrFlags uint32, err error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="readelfsym" data-name="readelfsym">
               <h3>
                  readelfsym 
                  <span class="badge">function</span>
                  
                  <a href="#readelfsym" class="anchor" title="Link to readelfsym">#</a>
               </h3>
               
               <pre><code>func readelfsym(l *loader.Loader, arch *sys.Arch, elfobj *ElfObj, i int, elfsym *ElfSym, needSym int, localSymVersion int) (err error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="relSize" data-name="relSize">
               <h3>
                  relSize 
                  <span class="badge">function</span>
                  
                  <a href="#relSize" class="anchor" title="Link to relSize">#</a>
               </h3>
               
               <p>Return the size of the relocated field, and the size of the addend as the first
and second values. Note, the addend may be larger than the relocation field in
some cases when a relocated value is split across multiple relocations.</p>
               
               <pre><code>func relSize(arch *sys.Arch, pn string, elftype uint32) (uint8, uint8, error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="section" data-name="section">
               <h3>
                  section 
                  <span class="badge">function</span>
                  
                  <a href="#section" class="anchor" title="Link to section">#</a>
               </h3>
               
               <pre><code>func section(elfobj *ElfObj, name string) *ElfSect</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="string" data-name="string">
               <h3>
                  string 
                  <span class="badge method-badge">method</span>
                  
                  <a href="#string" class="anchor" title="Link to string">#</a>
               </h3>
               
               <pre><code>func (a *elfAttributeList) string() string</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="uleb128" data-name="uleb128">
               <h3>
                  uleb128 
                  <span class="badge method-badge">method</span>
                  
                  <a href="#uleb128" class="anchor" title="Link to uleb128">#</a>
               </h3>
               
               <pre><code>func (a *elfAttributeList) uleb128() uint64</code></pre>
            </article>
            
         </section>
         
      </main>

      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }

         function buildSymbolIndex() {
            const symbolIndex = document.getElementById('symbolIndex');
            if (!symbolIndex) return;

            const symbols = [];
            
            document.querySelectorAll('article[data-name]').forEach(article => {
               const name = article.dataset.name;
               const type = article.className.split(' ')[0]; 
               const isPrivateSymbol = isPrivate(name);
               
               if (name && name !== 'imports') {
                  symbols.push({
                     name,
                     type,
                     element: article,
                     isPrivate: isPrivateSymbol
                  });
               }
            });

            symbols.sort((a, b) => a.name.localeCompare(b.name));
            symbolIndex.innerHTML = '';
            symbols.forEach(symbol => {
               const li = document.createElement('li');
               const a = document.createElement('a');
               a.href = `#${symbol.name}`;
               a.textContent = symbol.name;
               a.title = `${symbol.type}: ${symbol.name}`;
               
               if (symbol.isPrivate) {
                  li.classList.add('private', 'hidden');
               }
               
               li.appendChild(a);
               symbolIndex.appendChild(li);
            });
         }

         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               imports: document.getElementById("showImports"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
               types: document.getElementById("showPrivateTypes"),
               interfaces: document.getElementById(
                  "showPrivateInterfaces"
               ),
            };

            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });

               if (toggle) {
                  toggle.addEventListener("change", () => {
                     const show = toggle.checked;
                     document
                        .querySelectorAll(`${selector}.private`)
                        .forEach((el) => {
                           el.classList.toggle("hidden", !show);
                        });
                     
                     const symbolIndexItems = document.querySelectorAll('#symbolIndex li.private');
                     symbolIndexItems.forEach(li => {
                        const link = li.querySelector('a');
                        if (link) {
                           const targetId = link.getAttribute('href').substring(1);
                           const targetEl = document.getElementById(targetId);
                           if (targetEl && targetEl.matches(selector)) {
                              li.classList.toggle("hidden", !show);
                           }
                        }
                     });
                  });
               }
            };

            hideInitial("article.imports", toggles.imports);
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            hideInitial("article.type", toggles.types);
            hideInitial("article.interface", toggles.interfaces);

            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;

                  const lines = codeBlock.innerHTML.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch && trimmed != "}") {
                           return `<span class="field-line">${line}</span>`;
                        }
                        if (nameMatch == null) return;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class="field-line${
                           isPriv ? " hidden private" : ""
                        }" data-name="${name}">${line}</span>`;
                     })
                     .join("");

                  codeBlock.innerHTML = newContent;

                  if (toggles.fields) {
                     toggles.fields.addEventListener("change", () => {
                        const show = toggles.fields.checked;
                        article
                           .querySelectorAll(".field-line.private")
                           .forEach((el) =>
                              el.classList.toggle("hidden", !show)
                           );
                     });
                  }
               });

            document
               .querySelectorAll("article.interface")
               .forEach((article) => {
                  const codeBlock = article.querySelector(
                     "code.methods-code"
                  );
                  if (!codeBlock) return;

                  const lines = codeBlock.innerHTML.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch && !trimmed.endsWith("{") && trimmed != "}") {
                           return `<span class="method-line">${line}</span>`;
                        } else {
                           return ``;
                        }

                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class="method-line${
                           isPriv ? " hidden private" : ""
                        }" data-name="${name}">${line}</span>`;
                     })
                     .join("");

                  codeBlock.innerHTML = newContent;

                  if (toggles.fields) {
                     toggles.fields.addEventListener("change", () => {
                        const show = toggles.fields.checked;
                        article
                           .querySelectorAll(".method-line.private")
                           .forEach((el) =>
                              el.classList.toggle("hidden", !show)
                           );
                     });
                  }
               });

            const searchInput = document.getElementById("searchInput");
            if (searchInput) {
               searchInput.addEventListener("input", () => {
                  const query = searchInput.value.trim().toLowerCase();

                  document.querySelectorAll("article").forEach((el) => {
                     const name = el.dataset.name;
                     if (!name) return;

                     const matches =
                        query === "" ||
                        name.toLowerCase().includes(query) ||
                        (el.textContent &&
                           el.textContent.toLowerCase().includes(query));

                     if (matches) {
                        const isPrivateEl =
                           el.classList.contains("private");
                        const shouldShowPrivate =
                           getPrivateToggleState(el);

                        if (!isPrivateEl || shouldShowPrivate) {
                           el.classList.remove("hidden");
                        }
                     } else {
                        el.classList.add("hidden");
                     }
                  });

                  document.querySelectorAll('#symbolIndex li').forEach(li => {
                     const link = li.querySelector('a');
                     if (link) {
                        const symbolName = link.textContent.toLowerCase();
                        const matches = query === "" || symbolName.includes(query);
                        
                        if (matches) {
                           const isPrivateSymbol = li.classList.contains('private');
                           const targetId = link.getAttribute('href').substring(1);
                           const targetEl = document.getElementById(targetId);
                           const shouldShowPrivate = targetEl ? getPrivateToggleState(targetEl) : false;
                           
                           if (!isPrivateSymbol || shouldShowPrivate) {
                              li.style.display = '';
                           }
                        } else {
                           li.style.display = 'none';
                        }
                     }
                  });
               });
            }

            function getPrivateToggleState(element) {
               if (element.classList.contains("function")) {
                  return toggles.functions?.checked || false;
               } else if (element.classList.contains("struct")) {
                  return toggles.structs?.checked || false;
               } else if (element.classList.contains("global")) {
                  return toggles.globals?.checked || false;
               } else if (element.classList.contains("type")) {
                  return toggles.types?.checked || false;
               } else if (element.classList.contains("interface")) {
                  return toggles.interfaces?.checked || false;
               } else if (element.classList.contains("imports")) {
                  return toggles.imports?.checked || false;
               }
               return false;
            }

            buildSymbolIndex();

            document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
               anchor.addEventListener("click", function (e) {
                  const target = document.querySelector(
                     this.getAttribute("href")
                  );
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               });
            });

            window.addEventListener('hashchange', () => {
               const hash = window.location.hash;
               if (hash) {
                  const target = document.querySelector(hash);
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               }
            });

            if (window.location.hash) {
               setTimeout(() => {
                  const target = document.querySelector(window.location.hash);
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               }, 100);
            }
         });
      </script>
   </body>
</html>