<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - fsys</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>fsys</code>
         </h1>
         <hr />
         
         <article class="global" data-name="doTrace">
            <h2>doTrace</h2>
            <hr />
            
            <pre><code>doTrace bool</code></pre>
         </article>
         
         <article class="global" data-name="traceFile">
            <h2>traceFile</h2>
            <hr />
            
            <pre><code>traceFile *os.File</code></pre>
         </article>
         
         <article class="global" data-name="traceMu">
            <h2>traceMu</h2>
            <hr />
            
            <pre><code>traceMu sync.Mutex</code></pre>
         </article>
         
         <article class="global" data-name="gofsystrace">
            <h2>gofsystrace</h2>
            <hr />
            
            <pre><code>gofsystrace</code></pre>
         </article>
         
         <article class="global" data-name="gofsystracelog">
            <h2>gofsystracelog</h2>
            <hr />
            
            <pre><code>gofsystracelog</code></pre>
         </article>
         
         <article class="global" data-name="gofsystracestack">
            <h2>gofsystracestack</h2>
            <hr />
            
            <pre><code>gofsystracestack</code></pre>
         </article>
         
         <article class="global" data-name="OverlayFile">
            <h2>OverlayFile</h2>
            <hr />
            
            <p>OverlayFile is the -overlay flag value.
It names a file containing the JSON for an overlayJSON struct.</p>
            
            <pre><code>OverlayFile string</code></pre>
         </article>
         
         <article class="global" data-name="overlay">
            <h2>overlay</h2>
            <hr />
            
            <p>overlay is a list of replacements to be applied, sorted by cmp of the from field.
cmp sorts the filepath.Separator less than any other byte so that x is always
just before any children x/a, x/b, and so on, before x.go. (This would not
be the case with byte-wise sorting, which would produce x, x.go, x/a.)
The sorting lets us find the relevant overlay entry quickly even if it is for a
parent of the path being searched.</p>
            
            <pre><code>overlay []replace</code></pre>
         </article>
         
         <article class="global" data-name="binds">
            <h2>binds</h2>
            <hr />
            
            <pre><code>binds []replace</code></pre>
         </article>
         
         <article class="global" data-name="cwd">
            <h2>cwd</h2>
            <hr />
            
            <p>cwd returns the current directory, caching it on first use.</p>
            
            <pre><code>cwd</code></pre>
         </article>
         
         <article class="global" data-name="errNotDir">
            <h2>errNotDir</h2>
            <hr />
            
            <p>errNotDir is used to communicate from ReadDir to IsGoDir
that the argument is not a directory, so that IsGoDir doesn't
return an error.</p>
            
            <pre><code>errNotDir</code></pre>
         </article>
         
         <article class="global" data-name="statInfoOverlay">
            <h2>statInfoOverlay</h2>
            <hr />
            
            <pre><code>statInfoOverlay</code></pre>
         </article>
         
         <article class="global" data-name="statInfoTests">
            <h2>statInfoTests</h2>
            <hr />
            
            <pre><code>statInfoTests</code></pre>
         </article>
         
         <article class="global" data-name="statInfoChildrenTests">
            <h2>statInfoChildrenTests</h2>
            <hr />
            
            <pre><code>statInfoChildrenTests</code></pre>
         </article>
         
         <article class="global" data-name="readDirOverlay">
            <h2>readDirOverlay</h2>
            <hr />
            
            <pre><code>readDirOverlay</code></pre>
         </article>
         
         <article class="global" data-name="badOverlayTests">
            <h2>badOverlayTests</h2>
            <hr />
            
            <pre><code>badOverlayTests</code></pre>
         </article>
          
         <article class="struct" data-name="overlayJSON">
            <h2>type overlayJSON struct</h2>
            <hr />
            
            <p>overlayJSON is the format for the -overlay file.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Replace *ast.MapType</code></pre>
         </article>
         
         <article class="struct" data-name="replace">
            <h2>type replace struct</h2>
            <hr />
            
            <p>A replace represents a single replaced path.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">from string
to string</code></pre>
         </article>
         
         <article class="struct" data-name="info">
            <h2>type info struct</h2>
            <hr />
            
            <p>info is a summary of the known information about a path
being looked up in the virtual file system.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">abs string
deleted bool
replaced bool
dir bool
file bool
actual string</code></pre>
         </article>
         
         <article class="struct" data-name="fakeFile">
            <h2>type fakeFile struct</h2>
            <hr />
            
            <p>fakeFile provides an fs.FileInfo implementation for an overlaid file,
so that the file has the name of the overlaid file, but takes all
other characteristics of the replacement file.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">name string
real fs.FileInfo</code></pre>
         </article>
          
         <article class="function" data-name="Trace">
            <h2>Trace</h2>
            <hr />
            
            <p>Trace emits a trace event for the operation and file path to the trace log,
but only when $GODEBUG contains gofsystrace=1.
The traces are appended to the file named by the $GODEBUG setting gofsystracelog, or else standard error.
For debugging, if the $GODEBUG setting gofsystracestack is non-empty, then trace events for paths
matching that glob pattern (using path.Match) will be followed by a full stack trace.</p>
            
            <pre><code>func Trace(op string, path string)</code></pre>
         </article>
         
         <article class="function" data-name="init">
            <h2>init</h2>
            <hr />
            
            <pre><code>func init()</code></pre>
         </article>
         
         <article class="function" data-name="Bind">
            <h2>Bind</h2>
            <hr />
            
            <p>Bind makes the virtual file system use dir as if it were mounted at mtpt,
like Plan 9's “bind” or Linux's “mount --bind”, or like os.Symlink
but without the symbolic link.

For now, the behavior of using Bind on multiple overlapping
mountpoints (for example Bind("x", "/a") and Bind("y", "/a/b"))
is undefined.</p>
            
            <pre><code>func Bind(dir string, mtpt string)</code></pre>
         </article>
         
         <article class="function" data-name="cwdOnce">
            <h2>cwdOnce</h2>
            <hr />
            
            <pre><code>func cwdOnce() string</code></pre>
         </article>
         
         <article class="function" data-name="abs">
            <h2>abs</h2>
            <hr />
            
            <p>abs returns the absolute form of path, for looking up in the overlay map.
For the most part, this is filepath.Abs and filepath.Clean,
except that Windows requires special handling, as always.</p>
            
            <pre><code>func abs(path string) string</code></pre>
         </article>
         
         <article class="function" data-name="searchcmp">
            <h2>searchcmp</h2>
            <hr />
            
            <pre><code>func searchcmp(r replace, t string) int</code></pre>
         </article>
         
         <article class="function" data-name="stat">
            <h2>stat</h2>
            <hr />
            
            <p>stat returns info about the path in the virtual file system.</p>
            
            <pre><code>func stat(path string) info</code></pre>
         </article>
         
         <article class="function" data-name="children">
            <h2>children</h2>
            <hr />
            
            <p>children returns a sequence of (name, info)
for all the children of the directory i
implied by the overlay.</p>
            
            <pre><code>func children() *ast.IndexListExpr</code></pre>
         </article>
         
         <article class="function" data-name="Init">
            <h2>Init</h2>
            <hr />
            
            <p>Init initializes the overlay, if one is being used.</p>
            
            <pre><code>func Init() error</code></pre>
         </article>
         
         <article class="function" data-name="initFromJSON">
            <h2>initFromJSON</h2>
            <hr />
            
            <pre><code>func initFromJSON(js []byte) error</code></pre>
         </article>
         
         <article class="function" data-name="IsDir">
            <h2>IsDir</h2>
            <hr />
            
            <p>IsDir returns true if path is a directory on disk or in the
overlay.</p>
            
            <pre><code>func IsDir(path string) (bool, error)</code></pre>
         </article>
         
         <article class="function" data-name="osReadDir">
            <h2>osReadDir</h2>
            <hr />
            
            <p>osReadDir is like os.ReadDir corrects the error to be errNotDir
if the problem is that name exists but is not a directory.</p>
            
            <pre><code>func osReadDir(name string) ([]fs.DirEntry, error)</code></pre>
         </article>
         
         <article class="function" data-name="ReadDir">
            <h2>ReadDir</h2>
            <hr />
            
            <p>ReadDir reads the named directory in the virtual file system.</p>
            
            <pre><code>func ReadDir(name string) ([]fs.DirEntry, error)</code></pre>
         </article>
         
         <article class="function" data-name="Actual">
            <h2>Actual</h2>
            <hr />
            
            <p>Actual returns the actual file system path for the named file.
It returns the empty string if name has been deleted in the virtual file system.</p>
            
            <pre><code>func Actual(name string) string</code></pre>
         </article>
         
         <article class="function" data-name="Replaced">
            <h2>Replaced</h2>
            <hr />
            
            <p>Replaced reports whether the named file has been modified
in the virtual file system compared to the OS file system.</p>
            
            <pre><code>func Replaced(name string) bool</code></pre>
         </article>
         
         <article class="function" data-name="Open">
            <h2>Open</h2>
            <hr />
            
            <p>Open opens the named file in the virtual file system.
It must be an ordinary file, not a directory.</p>
            
            <pre><code>func Open(name string) (*os.File, error)</code></pre>
         </article>
         
         <article class="function" data-name="ReadFile">
            <h2>ReadFile</h2>
            <hr />
            
            <p>ReadFile reads the named file from the virtual file system
and returns the contents.</p>
            
            <pre><code>func ReadFile(name string) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="IsGoDir">
            <h2>IsGoDir</h2>
            <hr />
            
            <p>IsGoDir reports whether the named directory in the virtual file system
is a directory containing one or more Go source files.</p>
            
            <pre><code>func IsGoDir(name string) (bool, error)</code></pre>
         </article>
         
         <article class="function" data-name="Lstat">
            <h2>Lstat</h2>
            <hr />
            
            <p>Lstat returns a FileInfo describing the named file in the virtual file system.
It does not follow symbolic links</p>
            
            <pre><code>func Lstat(name string) (fs.FileInfo, error)</code></pre>
         </article>
         
         <article class="function" data-name="Stat">
            <h2>Stat</h2>
            <hr />
            
            <p>Stat returns a FileInfo describing the named file in the virtual file system.
It follows symbolic links.</p>
            
            <pre><code>func Stat(name string) (fs.FileInfo, error)</code></pre>
         </article>
         
         <article class="function" data-name="overlayStat">
            <h2>overlayStat</h2>
            <hr />
            
            <p>overlayStat implements lstat or Stat (depending on whether os.Lstat or os.Stat is passed in).</p>
            
            <pre><code>func overlayStat(op string, path string, osStat func) (fs.FileInfo, error)</code></pre>
         </article>
         
         <article class="function" data-name="Name">
            <h2>Name</h2>
            <hr />
            
            <pre><code>func Name() string</code></pre>
         </article>
         
         <article class="function" data-name="Size">
            <h2>Size</h2>
            <hr />
            
            <pre><code>func Size() int64</code></pre>
         </article>
         
         <article class="function" data-name="Mode">
            <h2>Mode</h2>
            <hr />
            
            <pre><code>func Mode() fs.FileMode</code></pre>
         </article>
         
         <article class="function" data-name="ModTime">
            <h2>ModTime</h2>
            <hr />
            
            <pre><code>func ModTime() time.Time</code></pre>
         </article>
         
         <article class="function" data-name="IsDir">
            <h2>IsDir</h2>
            <hr />
            
            <pre><code>func IsDir() bool</code></pre>
         </article>
         
         <article class="function" data-name="Sys">
            <h2>Sys</h2>
            <hr />
            
            <pre><code>func Sys() any</code></pre>
         </article>
         
         <article class="function" data-name="String">
            <h2>String</h2>
            <hr />
            
            <pre><code>func String() string</code></pre>
         </article>
         
         <article class="function" data-name="Name">
            <h2>Name</h2>
            <hr />
            
            <pre><code>func Name() string</code></pre>
         </article>
         
         <article class="function" data-name="Size">
            <h2>Size</h2>
            <hr />
            
            <pre><code>func Size() int64</code></pre>
         </article>
         
         <article class="function" data-name="Mode">
            <h2>Mode</h2>
            <hr />
            
            <pre><code>func Mode() fs.FileMode</code></pre>
         </article>
         
         <article class="function" data-name="ModTime">
            <h2>ModTime</h2>
            <hr />
            
            <pre><code>func ModTime() time.Time</code></pre>
         </article>
         
         <article class="function" data-name="IsDir">
            <h2>IsDir</h2>
            <hr />
            
            <pre><code>func IsDir() bool</code></pre>
         </article>
         
         <article class="function" data-name="Sys">
            <h2>Sys</h2>
            <hr />
            
            <pre><code>func Sys() any</code></pre>
         </article>
         
         <article class="function" data-name="String">
            <h2>String</h2>
            <hr />
            
            <pre><code>func String() string</code></pre>
         </article>
         
         <article class="function" data-name="Name">
            <h2>Name</h2>
            <hr />
            
            <pre><code>func Name() string</code></pre>
         </article>
         
         <article class="function" data-name="Size">
            <h2>Size</h2>
            <hr />
            
            <pre><code>func Size() int64</code></pre>
         </article>
         
         <article class="function" data-name="Mode">
            <h2>Mode</h2>
            <hr />
            
            <pre><code>func Mode() fs.FileMode</code></pre>
         </article>
         
         <article class="function" data-name="ModTime">
            <h2>ModTime</h2>
            <hr />
            
            <pre><code>func ModTime() time.Time</code></pre>
         </article>
         
         <article class="function" data-name="IsDir">
            <h2>IsDir</h2>
            <hr />
            
            <pre><code>func IsDir() bool</code></pre>
         </article>
         
         <article class="function" data-name="Sys">
            <h2>Sys</h2>
            <hr />
            
            <pre><code>func Sys() any</code></pre>
         </article>
         
         <article class="function" data-name="String">
            <h2>String</h2>
            <hr />
            
            <pre><code>func String() string</code></pre>
         </article>
         
         <article class="function" data-name="cmp">
            <h2>cmp</h2>
            <hr />
            
            <pre><code>func cmp(x string, y string) int</code></pre>
         </article>
         
         <article class="function" data-name="resetForTesting">
            <h2>resetForTesting</h2>
            <hr />
            
            <pre><code>func resetForTesting()</code></pre>
         </article>
         
         <article class="function" data-name="initOverlay">
            <h2>initOverlay</h2>
            <hr />
            
            <p>initOverlay resets the overlay state to reflect the config.
config should be a text archive string. The comment is the overlay config
json, and the files, in the archive are laid out in a temp directory
that cwd is set to.</p>
            
            <pre><code>func initOverlay(t *testing.T, config string)</code></pre>
         </article>
         
         <article class="function" data-name="TestStatInfo">
            <h2>TestStatInfo</h2>
            <hr />
            
            <pre><code>func TestStatInfo(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestIsDir">
            <h2>TestIsDir</h2>
            <hr />
            
            <pre><code>func TestIsDir(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestReadDir">
            <h2>TestReadDir</h2>
            <hr />
            
            <pre><code>func TestReadDir(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestGlob">
            <h2>TestGlob</h2>
            <hr />
            
            <pre><code>func TestGlob(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestActual">
            <h2>TestActual</h2>
            <hr />
            
            <pre><code>func TestActual(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestOpen">
            <h2>TestOpen</h2>
            <hr />
            
            <pre><code>func TestOpen(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestIsGoDir">
            <h2>TestIsGoDir</h2>
            <hr />
            
            <pre><code>func TestIsGoDir(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestWalk">
            <h2>TestWalk</h2>
            <hr />
            
            <pre><code>func TestWalk(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestWalkSkipDir">
            <h2>TestWalkSkipDir</h2>
            <hr />
            
            <pre><code>func TestWalkSkipDir(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestWalkSkipAll">
            <h2>TestWalkSkipAll</h2>
            <hr />
            
            <pre><code>func TestWalkSkipAll(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestWalkError">
            <h2>TestWalkError</h2>
            <hr />
            
            <pre><code>func TestWalkError(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestWalkSymlink">
            <h2>TestWalkSymlink</h2>
            <hr />
            
            <pre><code>func TestWalkSymlink(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestLstat">
            <h2>TestLstat</h2>
            <hr />
            
            <pre><code>func TestLstat(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestStat">
            <h2>TestStat</h2>
            <hr />
            
            <pre><code>func TestStat(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestStatSymlink">
            <h2>TestStatSymlink</h2>
            <hr />
            
            <pre><code>func TestStatSymlink(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestBindOverlay">
            <h2>TestBindOverlay</h2>
            <hr />
            
            <pre><code>func TestBindOverlay(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestBadOverlay">
            <h2>TestBadOverlay</h2>
            <hr />
            
            <pre><code>func TestBadOverlay(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="testReadFile">
            <h2>testReadFile</h2>
            <hr />
            
            <pre><code>func testReadFile(t *testing.T, name string, want string)</code></pre>
         </article>
         
         <article class="function" data-name="testReadDir">
            <h2>testReadDir</h2>
            <hr />
            
            <pre><code>func testReadDir(t *testing.T, name string, want ...string)</code></pre>
         </article>
         
         <article class="function" data-name="Glob">
            <h2>Glob</h2>
            <hr />
            
            <p>Glob is like filepath.Glob but uses the overlay file system.</p>
            
            <pre><code>func Glob(pattern string) (matches []string, err error)</code></pre>
         </article>
         
         <article class="function" data-name="cleanGlobPath">
            <h2>cleanGlobPath</h2>
            <hr />
            
            <p>cleanGlobPath prepares path for glob matching.</p>
            
            <pre><code>func cleanGlobPath(path string) string</code></pre>
         </article>
         
         <article class="function" data-name="volumeNameLen">
            <h2>volumeNameLen</h2>
            <hr />
            
            <pre><code>func volumeNameLen(path string) int</code></pre>
         </article>
         
         <article class="function" data-name="cleanGlobPathWindows">
            <h2>cleanGlobPathWindows</h2>
            <hr />
            
            <p>cleanGlobPathWindows is windows version of cleanGlobPath.</p>
            
            <pre><code>func cleanGlobPathWindows(path string) (prefixLen int, cleaned string)</code></pre>
         </article>
         
         <article class="function" data-name="glob">
            <h2>glob</h2>
            <hr />
            
            <p>glob searches for files matching pattern in the directory dir
and appends them to matches. If the directory cannot be
opened, it returns the existing matches. New matches are
added in lexicographical order.</p>
            
            <pre><code>func glob(dir string, pattern string, matches []string) (m []string, e error)</code></pre>
         </article>
         
         <article class="function" data-name="hasMeta">
            <h2>hasMeta</h2>
            <hr />
            
            <p>hasMeta reports whether path contains any of the magic characters
recognized by filepath.Match.</p>
            
            <pre><code>func hasMeta(path string) bool</code></pre>
         </article>
         
         <article class="function" data-name="WalkDir">
            <h2>WalkDir</h2>
            <hr />
            
            <p>WalkDir is like filepath.WalkDir but over the virtual file system.</p>
            
            <pre><code>func WalkDir(root string, fn fs.WalkDirFunc) error</code></pre>
         </article>
         
         <article class="function" data-name="walkDir">
            <h2>walkDir</h2>
            <hr />
            
            <p>walkDir recursively descends path, calling walkDirFn.</p>
            
            <pre><code>func walkDir(path string, d fs.DirEntry, walkDirFn fs.WalkDirFunc) error</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
