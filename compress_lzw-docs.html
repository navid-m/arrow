<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - lzw</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>lzw</code>
         </h1>
         <hr />
         
         <article class="global" data-name="LSB">
            <h2>LSB</h2>
            <hr />
            
            <p>LSB means Least Significant Bits first, as used in the GIF file format.</p>
            
            <pre><code>LSB Order</code></pre>
         </article>
         
         <article class="global" data-name="MSB">
            <h2>MSB</h2>
            <hr />
            
            <p>MSB means Most Significant Bits first, as used in the TIFF and PDF
file formats.</p>
            
            <pre><code>MSB</code></pre>
         </article>
         
         <article class="global" data-name="maxWidth">
            <h2>maxWidth</h2>
            <hr />
            
            <pre><code>maxWidth</code></pre>
         </article>
         
         <article class="global" data-name="decoderInvalidCode">
            <h2>decoderInvalidCode</h2>
            <hr />
            
            <pre><code>decoderInvalidCode</code></pre>
         </article>
         
         <article class="global" data-name="flushBuffer">
            <h2>flushBuffer</h2>
            <hr />
            
            <pre><code>flushBuffer</code></pre>
         </article>
         
         <article class="global" data-name="errClosed">
            <h2>errClosed</h2>
            <hr />
            
            <pre><code>errClosed</code></pre>
         </article>
         
         <article class="global" data-name="lzwTests">
            <h2>lzwTests</h2>
            <hr />
            
            <pre><code>lzwTests</code></pre>
         </article>
         
         <article class="global" data-name="maxCode">
            <h2>maxCode</h2>
            <hr />
            
            <p>A code is a 12 bit value, stored as a uint32 when encoding to avoid
type conversions when shifting bits.</p>
            
            <pre><code>maxCode</code></pre>
         </article>
         
         <article class="global" data-name="invalidCode">
            <h2>invalidCode</h2>
            <hr />
            
            <pre><code>invalidCode</code></pre>
         </article>
         
         <article class="global" data-name="tableSize">
            <h2>tableSize</h2>
            <hr />
            
            <p>There are 1<<12 possible codes, which is an upper bound on the number of
valid hash table entries at any given point in time. tableSize is 4x that.</p>
            
            <pre><code>tableSize</code></pre>
         </article>
         
         <article class="global" data-name="tableMask">
            <h2>tableMask</h2>
            <hr />
            
            <pre><code>tableMask</code></pre>
         </article>
         
         <article class="global" data-name="invalidEntry">
            <h2>invalidEntry</h2>
            <hr />
            
            <p>A hash table entry is a uint32. Zero is an invalid entry since the
lower 12 bits of a valid entry must be a non-literal code.</p>
            
            <pre><code>invalidEntry</code></pre>
         </article>
         
         <article class="global" data-name="errOutOfCodes">
            <h2>errOutOfCodes</h2>
            <hr />
            
            <p>errOutOfCodes is an internal error that means that the writer has run out
of unused codes and a clear code needs to be sent next.</p>
            
            <pre><code>errOutOfCodes</code></pre>
         </article>
         
         <article class="global" data-name="filenames">
            <h2>filenames</h2>
            <hr />
            
            <pre><code>filenames</code></pre>
         </article>
          
         <article class="struct" data-name="Reader">
            <h2>type Reader struct</h2>
            <hr />
            
            <p>Reader is an io.Reader which can be used to read compressed data in the
LZW format.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">r io.ByteReader
bits uint32
nBits uint
width uint
read func
litWidth int
err error
clear uint16
eof uint16
hi uint16
overflow uint16
last uint16
suffix []uint8
prefix []uint16
output []byte
o int
toRead []byte</code></pre>
         </article>
         
         <article class="struct" data-name="lzwTest">
            <h2>type lzwTest struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">desc string
raw string
compressed string
err error</code></pre>
         </article>
         
         <article class="struct" data-name="devZero">
            <h2>type devZero struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code"></code></pre>
         </article>
         
         <article class="struct" data-name="Writer">
            <h2>type Writer struct</h2>
            <hr />
            
            <p>Writer is an LZW compressor. It writes the compressed form of the data
to an underlying writer (see [NewWriter]).</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">w writer
litWidth uint
order Order
write func
nBits uint
width uint
bits uint32
hi uint32
overflow uint32
savedCode uint32
err error
table []uint32</code></pre>
         </article>
          
         <article class="function" data-name="readLSB">
            <h2>readLSB</h2>
            <hr />
            
            <p>readLSB returns the next code for "Least Significant Bits first" data.</p>
            
            <pre><code>func readLSB() (uint16, error)</code></pre>
         </article>
         
         <article class="function" data-name="readMSB">
            <h2>readMSB</h2>
            <hr />
            
            <p>readMSB returns the next code for "Most Significant Bits first" data.</p>
            
            <pre><code>func readMSB() (uint16, error)</code></pre>
         </article>
         
         <article class="function" data-name="Read">
            <h2>Read</h2>
            <hr />
            
            <p>Read implements io.Reader, reading uncompressed bytes from its underlying [Reader].</p>
            
            <pre><code>func Read(b []byte) (int, error)</code></pre>
         </article>
         
         <article class="function" data-name="decode">
            <h2>decode</h2>
            <hr />
            
            <p>decode decompresses bytes from r and leaves them in d.toRead.
read specifies how to decode bytes into codes.
litWidth is the width in bits of literal codes.</p>
            
            <pre><code>func decode()</code></pre>
         </article>
         
         <article class="function" data-name="Close">
            <h2>Close</h2>
            <hr />
            
            <p>Close closes the [Reader] and returns an error for any future read operation.
It does not close the underlying [io.Reader].</p>
            
            <pre><code>func Close() error</code></pre>
         </article>
         
         <article class="function" data-name="Reset">
            <h2>Reset</h2>
            <hr />
            
            <p>Reset clears the [Reader]'s state and allows it to be reused again
as a new [Reader].</p>
            
            <pre><code>func Reset(src io.Reader, order Order, litWidth int)</code></pre>
         </article>
         
         <article class="function" data-name="NewReader">
            <h2>NewReader</h2>
            <hr />
            
            <p>NewReader creates a new [io.ReadCloser].
Reads from the returned [io.ReadCloser] read and decompress data from r.
If r does not also implement [io.ByteReader],
the decompressor may read more data than necessary from r.
It is the caller's responsibility to call Close on the ReadCloser when
finished reading.
The number of bits to use for literal codes, litWidth, must be in the
range [2,8] and is typically 8. It must equal the litWidth
used during compression.

It is guaranteed that the underlying type of the returned [io.ReadCloser]
is a *[Reader].</p>
            
            <pre><code>func NewReader(r io.Reader, order Order, litWidth int) io.ReadCloser</code></pre>
         </article>
         
         <article class="function" data-name="newReader">
            <h2>newReader</h2>
            <hr />
            
            <pre><code>func newReader(src io.Reader, order Order, litWidth int) *Reader</code></pre>
         </article>
         
         <article class="function" data-name="init">
            <h2>init</h2>
            <hr />
            
            <pre><code>func init(src io.Reader, order Order, litWidth int)</code></pre>
         </article>
         
         <article class="function" data-name="TestReader">
            <h2>TestReader</h2>
            <hr />
            
            <pre><code>func TestReader(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestReaderReset">
            <h2>TestReaderReset</h2>
            <hr />
            
            <pre><code>func TestReaderReset(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="Read">
            <h2>Read</h2>
            <hr />
            
            <pre><code>func Read(p []byte) (int, error)</code></pre>
         </article>
         
         <article class="function" data-name="TestHiCodeDoesNotOverflow">
            <h2>TestHiCodeDoesNotOverflow</h2>
            <hr />
            
            <pre><code>func TestHiCodeDoesNotOverflow(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestNoLongerSavingPriorExpansions">
            <h2>TestNoLongerSavingPriorExpansions</h2>
            <hr />
            
            <p>TestNoLongerSavingPriorExpansions tests the decoder state when codes other
than clear codes continue to be seen after decoder.hi and decoder.width
reach their maximum values (4095 and 12), i.e. after we no longer save prior
expansions. In particular, it tests seeing the highest possible code, 4095.</p>
            
            <pre><code>func TestNoLongerSavingPriorExpansions(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="BenchmarkDecoder">
            <h2>BenchmarkDecoder</h2>
            <hr />
            
            <pre><code>func BenchmarkDecoder(b *testing.B)</code></pre>
         </article>
         
         <article class="function" data-name="writeLSB">
            <h2>writeLSB</h2>
            <hr />
            
            <p>writeLSB writes the code c for "Least Significant Bits first" data.</p>
            
            <pre><code>func writeLSB(c uint32) error</code></pre>
         </article>
         
         <article class="function" data-name="writeMSB">
            <h2>writeMSB</h2>
            <hr />
            
            <p>writeMSB writes the code c for "Most Significant Bits first" data.</p>
            
            <pre><code>func writeMSB(c uint32) error</code></pre>
         </article>
         
         <article class="function" data-name="incHi">
            <h2>incHi</h2>
            <hr />
            
            <p>incHi increments e.hi and checks for both overflow and running out of
unused codes. In the latter case, incHi sends a clear code, resets the
writer state and returns errOutOfCodes.</p>
            
            <pre><code>func incHi() error</code></pre>
         </article>
         
         <article class="function" data-name="Write">
            <h2>Write</h2>
            <hr />
            
            <p>Write writes a compressed representation of p to w's underlying writer.</p>
            
            <pre><code>func Write(p []byte) (n int, err error)</code></pre>
         </article>
         
         <article class="function" data-name="Close">
            <h2>Close</h2>
            <hr />
            
            <p>Close closes the [Writer], flushing any pending output. It does not close
w's underlying writer.</p>
            
            <pre><code>func Close() error</code></pre>
         </article>
         
         <article class="function" data-name="Reset">
            <h2>Reset</h2>
            <hr />
            
            <p>Reset clears the [Writer]'s state and allows it to be reused again
as a new [Writer].</p>
            
            <pre><code>func Reset(dst io.Writer, order Order, litWidth int)</code></pre>
         </article>
         
         <article class="function" data-name="NewWriter">
            <h2>NewWriter</h2>
            <hr />
            
            <p>NewWriter creates a new [io.WriteCloser].
Writes to the returned [io.WriteCloser] are compressed and written to w.
It is the caller's responsibility to call Close on the WriteCloser when
finished writing.
The number of bits to use for literal codes, litWidth, must be in the
range [2,8] and is typically 8. Input bytes must be less than 1<<litWidth.

It is guaranteed that the underlying type of the returned [io.WriteCloser]
is a *[Writer].</p>
            
            <pre><code>func NewWriter(w io.Writer, order Order, litWidth int) io.WriteCloser</code></pre>
         </article>
         
         <article class="function" data-name="newWriter">
            <h2>newWriter</h2>
            <hr />
            
            <pre><code>func newWriter(dst io.Writer, order Order, litWidth int) *Writer</code></pre>
         </article>
         
         <article class="function" data-name="init">
            <h2>init</h2>
            <hr />
            
            <pre><code>func init(dst io.Writer, order Order, litWidth int)</code></pre>
         </article>
         
         <article class="function" data-name="testFile">
            <h2>testFile</h2>
            <hr />
            
            <p>testFile tests that compressing and then decompressing the given file with
the given options yields equivalent bytes to the original file.</p>
            
            <pre><code>func testFile(t *testing.T, fn string, order Order, litWidth int)</code></pre>
         </article>
         
         <article class="function" data-name="TestWriter">
            <h2>TestWriter</h2>
            <hr />
            
            <pre><code>func TestWriter(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestWriterReset">
            <h2>TestWriterReset</h2>
            <hr />
            
            <pre><code>func TestWriterReset(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestWriterReturnValues">
            <h2>TestWriterReturnValues</h2>
            <hr />
            
            <pre><code>func TestWriterReturnValues(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestSmallLitWidth">
            <h2>TestSmallLitWidth</h2>
            <hr />
            
            <pre><code>func TestSmallLitWidth(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestStartsWithClearCode">
            <h2>TestStartsWithClearCode</h2>
            <hr />
            
            <pre><code>func TestStartsWithClearCode(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="BenchmarkEncoder">
            <h2>BenchmarkEncoder</h2>
            <hr />
            
            <pre><code>func BenchmarkEncoder(b *testing.B)</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
