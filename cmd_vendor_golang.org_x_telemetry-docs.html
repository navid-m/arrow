<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - telemetry</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
          
         <a href="cmd_vendor_golang.org_x_telemetry_counter-docs.html">counter</a>
         <br />
          
      </aside>
      <main>
         <h1>
            Package
            <code>telemetry</code>
         </h1>
         <hr />
         
         <article class="global" data-name="daemonize">
            <h2>daemonize</h2>
            <hr />
            
            <pre><code>daemonize</code></pre>
         </article>
         
         <article class="global" data-name="telemetryChildVar">
            <h2>telemetryChildVar</h2>
            <hr />
            
            <p>If telemetryChildVar is set to "1" in the environment, this is the telemetry
child.

If telemetryChildVar is set to "2", this is a child of the child, and no
further forking should occur.</p>
            
            <pre><code>telemetryChildVar</code></pre>
         </article>
         
         <article class="global" data-name="telemetryUploadVar">
            <h2>telemetryUploadVar</h2>
            <hr />
            
            <p>If telemetryUploadVar is set to "1" in the environment, the upload token has been
acquired by the parent, and the child should attempt an upload.</p>
            
            <pre><code>telemetryUploadVar</code></pre>
         </article>
          
         <article class="struct" data-name="Config">
            <h2>type Config struct</h2>
            <hr />
            
            <p>Config controls the behavior of [Start].</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">ReportCrashes bool
Upload bool
TelemetryDir string
UploadStartTime time.Time
UploadURL string</code></pre>
         </article>
         
         <article class="struct" data-name="StartResult">
            <h2>type StartResult struct</h2>
            <hr />
            
            <p>A StartResult is a handle to the result of a call to [Start]. Call
[StartResult.Wait] to wait for the completion of all work done on behalf of
Start.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">wg sync.WaitGroup</code></pre>
         </article>
          
         <article class="function" data-name="Mode">
            <h2>Mode</h2>
            <hr />
            
            <p>Mode returns the current telemetry mode.

The telemetry mode is a global value that controls both the local collection
and uploading of telemetry data. Possible mode values are:
  - "on":    both collection and uploading is enabled
  - "local": collection is enabled, but uploading is disabled
  - "off":   both collection and uploading are disabled

When mode is "on", or "local", telemetry data is written to the local file
system and may be inspected with the [gotelemetry] command.

If an error occurs while reading the telemetry mode from the file system,
Mode returns the default value "local".

[gotelemetry]: https://pkg.go.dev/golang.org/x/telemetry/cmd/gotelemetry</p>
            
            <pre><code>func Mode() string</code></pre>
         </article>
         
         <article class="function" data-name="SetMode">
            <h2>SetMode</h2>
            <hr />
            
            <p>SetMode sets the global telemetry mode to the given value.

See the documentation of [Mode] for a description of the supported mode
values.

An error is returned if the provided mode value is invalid, or if an error
occurs while persisting the mode value to the file system.</p>
            
            <pre><code>func SetMode(mode string) error</code></pre>
         </article>
         
         <article class="function" data-name="Start">
            <h2>Start</h2>
            <hr />
            
            <p>Start initializes telemetry using the specified configuration.

Start opens the local telemetry database so that counter increment
operations are durably recorded in the local file system.

If [Config.Upload] is set, and the user has opted in to telemetry
uploading, this process may attempt to upload approved counters
to telemetry.go.dev.

If [Config.ReportCrashes] is set, any fatal crash will be
recorded by incrementing a counter named for the stack of the
first running goroutine in the traceback.

If either of these flags is set, Start re-executes the current
executable as a child process, in a special mode in which it
acts as a telemetry sidecar for the parent process (the application).
In that mode, the call to Start will never return, so Start must
be called immediately within main, even before such things as
inspecting the command line. The application should avoid expensive
steps or external side effects in init functions, as they will
be executed twice (parent and child).

Start returns a StartResult, which may be awaited via [StartResult.Wait] to
wait for all work done by Start to complete.</p>
            
            <pre><code>func Start(config Config) *StartResult</code></pre>
         </article>
         
         <article class="function" data-name="MaybeChild">
            <h2>MaybeChild</h2>
            <hr />
            
            <p>MaybeChild executes the telemetry child logic if the calling program is
the telemetry child process, and does nothing otherwise. It is meant to be
called as the first thing in a program that uses telemetry.Start but cannot
call telemetry.Start immediately when it starts.</p>
            
            <pre><code>func MaybeChild(config Config)</code></pre>
         </article>
         
         <article class="function" data-name="Wait">
            <h2>Wait</h2>
            <hr />
            
            <p>Wait waits for the completion of all work initiated by [Start].</p>
            
            <pre><code>func Wait()</code></pre>
         </article>
         
         <article class="function" data-name="parent">
            <h2>parent</h2>
            <hr />
            
            <pre><code>func parent(config Config) *StartResult</code></pre>
         </article>
         
         <article class="function" data-name="startChild">
            <h2>startChild</h2>
            <hr />
            
            <pre><code>func startChild(reportCrashes bool, upload bool, result *StartResult)</code></pre>
         </article>
         
         <article class="function" data-name="child">
            <h2>child</h2>
            <hr />
            
            <pre><code>func child(config Config)</code></pre>
         </article>
         
         <article class="function" data-name="uploaderChild">
            <h2>uploaderChild</h2>
            <hr />
            
            <pre><code>func uploaderChild(asof time.Time, uploadURL string)</code></pre>
         </article>
         
         <article class="function" data-name="acquireUploadToken">
            <h2>acquireUploadToken</h2>
            <hr />
            
            <p>acquireUploadToken acquires a token permitting the caller to upload.
To limit the frequency of uploads, only one token is issue per
machine per time period.
The boolean indicates whether the token was acquired.</p>
            
            <pre><code>func acquireUploadToken() bool</code></pre>
         </article>
         
         <article class="function" data-name="init">
            <h2>init</h2>
            <hr />
            
            <pre><code>func init()</code></pre>
         </article>
         
         <article class="function" data-name="daemonizePosix">
            <h2>daemonizePosix</h2>
            <hr />
            
            <pre><code>func daemonizePosix(cmd *exec.Cmd)</code></pre>
         </article>
         
         <article class="function" data-name="init">
            <h2>init</h2>
            <hr />
            
            <pre><code>func init()</code></pre>
         </article>
         
         <article class="function" data-name="daemonizeWindows">
            <h2>daemonizeWindows</h2>
            <hr />
            
            <pre><code>func daemonizeWindows(cmd *exec.Cmd)</code></pre>
         </article>
         
         <article class="function" data-name="Dir">
            <h2>Dir</h2>
            <hr />
            
            <p>Dir returns the telemetry directory.</p>
            
            <pre><code>func Dir() string</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
