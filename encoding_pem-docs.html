<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - pem</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>pem</code>
         </h1>
         <hr />
         
         <article class="global" data-name="pemStart">
            <h2>pemStart</h2>
            <hr />
            
            <pre><code>pemStart</code></pre>
         </article>
         
         <article class="global" data-name="pemEnd">
            <h2>pemEnd</h2>
            <hr />
            
            <pre><code>pemEnd</code></pre>
         </article>
         
         <article class="global" data-name="pemEndOfLine">
            <h2>pemEndOfLine</h2>
            <hr />
            
            <pre><code>pemEndOfLine</code></pre>
         </article>
         
         <article class="global" data-name="colon">
            <h2>colon</h2>
            <hr />
            
            <pre><code>colon</code></pre>
         </article>
         
         <article class="global" data-name="pemLineLength">
            <h2>pemLineLength</h2>
            <hr />
            
            <pre><code>pemLineLength</code></pre>
         </article>
         
         <article class="global" data-name="nl">
            <h2>nl</h2>
            <hr />
            
            <pre><code>nl</code></pre>
         </article>
         
         <article class="global" data-name="getLineTests">
            <h2>getLineTests</h2>
            <hr />
            
            <pre><code>getLineTests</code></pre>
         </article>
         
         <article class="global" data-name="pemTooFewEndingDashes">
            <h2>pemTooFewEndingDashes</h2>
            <hr />
            
            <pre><code>pemTooFewEndingDashes</code></pre>
         </article>
         
         <article class="global" data-name="pemTooManyEndingDashes">
            <h2>pemTooManyEndingDashes</h2>
            <hr />
            
            <pre><code>pemTooManyEndingDashes</code></pre>
         </article>
         
         <article class="global" data-name="pemTrailingNonWhitespace">
            <h2>pemTrailingNonWhitespace</h2>
            <hr />
            
            <pre><code>pemTrailingNonWhitespace</code></pre>
         </article>
         
         <article class="global" data-name="pemWrongEndingType">
            <h2>pemWrongEndingType</h2>
            <hr />
            
            <pre><code>pemWrongEndingType</code></pre>
         </article>
         
         <article class="global" data-name="pemMissingEndingSpace">
            <h2>pemMissingEndingSpace</h2>
            <hr />
            
            <pre><code>pemMissingEndingSpace</code></pre>
         </article>
         
         <article class="global" data-name="pemMissingEndLine">
            <h2>pemMissingEndLine</h2>
            <hr />
            
            <pre><code>pemMissingEndLine</code></pre>
         </article>
         
         <article class="global" data-name="pemRepeatingBegin">
            <h2>pemRepeatingBegin</h2>
            <hr />
            
            <pre><code>pemRepeatingBegin</code></pre>
         </article>
         
         <article class="global" data-name="badPEMTests">
            <h2>badPEMTests</h2>
            <hr />
            
            <pre><code>badPEMTests</code></pre>
         </article>
         
         <article class="global" data-name="sixtyFourCharString">
            <h2>sixtyFourCharString</h2>
            <hr />
            
            <pre><code>sixtyFourCharString</code></pre>
         </article>
         
         <article class="global" data-name="lineBreakerTests">
            <h2>lineBreakerTests</h2>
            <hr />
            
            <pre><code>lineBreakerTests</code></pre>
         </article>
         
         <article class="global" data-name="pemData">
            <h2>pemData</h2>
            <hr />
            
            <pre><code>pemData</code></pre>
         </article>
         
         <article class="global" data-name="certificate">
            <h2>certificate</h2>
            <hr />
            
            <pre><code>certificate</code></pre>
         </article>
         
         <article class="global" data-name="privateKey">
            <h2>privateKey</h2>
            <hr />
            
            <pre><code>privateKey</code></pre>
         </article>
         
         <article class="global" data-name="privateKey2">
            <h2>privateKey2</h2>
            <hr />
            
            <pre><code>privateKey2</code></pre>
         </article>
         
         <article class="global" data-name="pemPrivateKey2">
            <h2>pemPrivateKey2</h2>
            <hr />
            
            <pre><code>pemPrivateKey2</code></pre>
         </article>
          
         <article class="struct" data-name="Block">
            <h2>type Block struct</h2>
            <hr />
            
            <p>A Block represents a PEM encoded structure.

The encoded form is:

	-----BEGIN Type-----
	Headers
	base64-encoded Bytes
	-----END Type-----

where [Block.Headers] is a possibly empty sequence of Key: Value lines.</p>
            
            <pre
               class="fields-block"
            ><code class="fields-code">Type string
Headers *ast.MapType
Bytes []byte</code></pre>
         </article>
         
         <article class="struct" data-name="lineBreaker">
            <h2>type lineBreaker struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">line []byte
used int
out io.Writer</code></pre>
         </article>
         
         <article class="struct" data-name="GetLineTest">
            <h2>type GetLineTest struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">in string
out1 string
out2 string</code></pre>
         </article>
         
         <article class="struct" data-name="lineBreakerTest">
            <h2>type lineBreakerTest struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">in string
out string</code></pre>
         </article>
          
         <article class="function" data-name="getLine">
            <h2>getLine</h2>
            <hr />
            
            <p>getLine results the first \r\n or \n delineated line from the given byte
array. The line does not include trailing whitespace or the trailing new
line bytes. The remainder of the byte array (also not including the new line
bytes) is also returned and this will always be smaller than the original
argument.</p>
            
            <pre><code>func getLine(data []byte) (line []byte, rest []byte)</code></pre>
         </article>
         
         <article class="function" data-name="removeSpacesAndTabs">
            <h2>removeSpacesAndTabs</h2>
            <hr />
            
            <p>removeSpacesAndTabs returns a copy of its input with all spaces and tabs
removed, if there were any. Otherwise, the input is returned unchanged.

The base64 decoder already skips newline characters, so we don't need to
filter them out here.</p>
            
            <pre><code>func removeSpacesAndTabs(data []byte) []byte</code></pre>
         </article>
         
         <article class="function" data-name="Decode">
            <h2>Decode</h2>
            <hr />
            
            <p>Decode will find the next PEM formatted block (certificate, private key
etc) in the input. It returns that block and the remainder of the input. If
no PEM data is found, p is nil and the whole of the input is returned in
rest.</p>
            
            <pre><code>func Decode(data []byte) (p *Block, rest []byte)</code></pre>
         </article>
         
         <article class="function" data-name="Write">
            <h2>Write</h2>
            <hr />
            
            <pre><code>func Write(b []byte) (n int, err error)</code></pre>
         </article>
         
         <article class="function" data-name="Close">
            <h2>Close</h2>
            <hr />
            
            <pre><code>func Close() err error</code></pre>
         </article>
         
         <article class="function" data-name="writeHeader">
            <h2>writeHeader</h2>
            <hr />
            
            <pre><code>func writeHeader(out io.Writer, k string, v string) error</code></pre>
         </article>
         
         <article class="function" data-name="Encode">
            <h2>Encode</h2>
            <hr />
            
            <p>Encode writes the PEM encoding of b to out.</p>
            
            <pre><code>func Encode(out io.Writer, b *Block) error</code></pre>
         </article>
         
         <article class="function" data-name="EncodeToMemory">
            <h2>EncodeToMemory</h2>
            <hr />
            
            <p>EncodeToMemory returns the PEM encoding of b.

If b has invalid headers and cannot be encoded,
EncodeToMemory returns nil. If it is important to
report details about this error case, use [Encode] instead.</p>
            
            <pre><code>func EncodeToMemory(b *Block) []byte</code></pre>
         </article>
         
         <article class="function" data-name="TestGetLine">
            <h2>TestGetLine</h2>
            <hr />
            
            <pre><code>func TestGetLine(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestDecode">
            <h2>TestDecode</h2>
            <hr />
            
            <pre><code>func TestDecode(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestBadDecode">
            <h2>TestBadDecode</h2>
            <hr />
            
            <pre><code>func TestBadDecode(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestCVE202224675">
            <h2>TestCVE202224675</h2>
            <hr />
            
            <pre><code>func TestCVE202224675(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestEncode">
            <h2>TestEncode</h2>
            <hr />
            
            <pre><code>func TestEncode(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestLineBreaker">
            <h2>TestLineBreaker</h2>
            <hr />
            
            <pre><code>func TestLineBreaker(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestFuzz">
            <h2>TestFuzz</h2>
            <hr />
            
            <pre><code>func TestFuzz(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="BenchmarkEncode">
            <h2>BenchmarkEncode</h2>
            <hr />
            
            <pre><code>func BenchmarkEncode(b *testing.B)</code></pre>
         </article>
         
         <article class="function" data-name="BenchmarkDecode">
            <h2>BenchmarkDecode</h2>
            <hr />
            
            <pre><code>func BenchmarkDecode(b *testing.B)</code></pre>
         </article>
         
         <article class="function" data-name="TestBadEncode">
            <h2>TestBadEncode</h2>
            <hr />
            
            <pre><code>func TestBadEncode(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="testingKey">
            <h2>testingKey</h2>
            <hr />
            
            <pre><code>func testingKey(s string) string</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
