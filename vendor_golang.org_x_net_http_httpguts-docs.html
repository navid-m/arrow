<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - httpguts</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 14px;
            scroll-behavior: smooth;
         }

         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
            line-height: 1.6;
         }

         .sidebar {
            width: 12%;
            background: rgba(59, 56, 56, 0.15);
            padding: 1.5rem;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.4);
            overflow-y: auto;
            position: sticky;
            top: 0;
            height: 100vh;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
         }

         .sidebar::-webkit-scrollbar {
            width: 6px;
         }

         .sidebar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
         }

         .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
         }

         main {
            flex: 1;
            padding: 2rem;
            margin: 0;
            max-width: calc(100% - 280px);
            background: linear-gradient(
               135deg,
               rgba(59, 56, 56, 0.05) 0%,
               rgba(0, 0, 0, 0.1) 100%
            );
         }

         .nav-links {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
         }

         .nav-links a {
            color: #ddd;
            text-decoration: none;
            padding: 0.5rem;
            border-radius: 4px;
            transition: all 0.2s ease;
         }

         .nav-links a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
         }

         h1 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #fff 0%, #ddd 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
         }

         h2 {
            font-size: 1.4rem;
            margin: 1rem 0 0.5rem;
            color: #f0f0f0;
         }

         h3 {
            font-size: 1.2rem;
            margin: 0.8rem 0 0.3rem;
            color: #e0e0e0;
            position: relative;
         }

         .sidebar h2,
         .sidebar h3 {
            font-size: 1rem;
            margin: 0.5rem 0 0.3rem;
            color: #ccc;
         }

         /* Anchor link styling */
         .anchor {
            color: rgba(255, 255, 255, 0.3);
            text-decoration: none;
            font-weight: normal;
            margin-left: 0.5rem;
            opacity: 0;
            transition: opacity 0.2s ease;
            font-size: 0.8em;
         }

         h3:hover .anchor,
         .anchor:focus {
            opacity: 1;
         }

         .anchor:hover {
            color: rgba(255, 255, 255, 0.6);
         }

         /* Scroll target offset for fixed elements */
         .symbol-anchor {
            scroll-margin-top: 2rem;
         }

         pre {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #e6e6e6;
            padding: 1rem 1.2rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-size: 0.9rem;
            overflow-x: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
         }

         code {
            color: #f5f5f5;
            font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace;
            white-space: pre-wrap;
         }

         p {
            font-size: 15px;
            margin: 1rem 0;
            color: #ddd;
         }

         article {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(59, 56, 56, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
         }

         article:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
            transform: translateY(-2px);
         }

         article:target {
            border-color: rgba(100, 200, 255, 0.5);
            box-shadow: 0 0 0 2px rgba(100, 200, 255, 0.2);
         }

         .hidden {
            display: none !important;
         }

         .filter-section {
            margin-bottom: 1.5rem;
         }

         .filter-section h3 {
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #aaa;
         }

         .filter-toggle label {
            display: flex;
            align-items: center;
            margin-bottom: 0.6rem;
            font-size: 0.85rem;
            color: #bbb;
            cursor: pointer;
            padding: 0.3rem;
            border-radius: 4px;
            transition: background 0.2s ease;
         }

         .filter-toggle label:hover {
            background: rgba(255, 255, 255, 0.05);
         }

         .filter-toggle input {
            margin-right: 0.6rem;
         }

         .field-line,
         .method-line {
            display: block;
         }

         #searchInput {
            width: 100%;
            margin-bottom: 1.5rem;
            border-radius: 8px !important;
            height: 2.8rem;
            font-size: 0.9rem;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 0 1rem;
         }

         #searchInput::placeholder {
            color: rgba(255, 255, 255, 0.5);
         }

         #searchInput:focus {
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.1);
         }

         .section-divider {
            height: 1px;
            background: linear-gradient(
               90deg,
               transparent 0%,
               rgba(255, 255, 255, 0.3) 50%,
               transparent 100%
            );
            margin: 1.5rem 0;
         }

         .subpackage-list {
            list-style: none;
            padding: 0;
         }

         .subpackage-list li {
            margin-bottom: 0.4rem;
         }

         .subpackage-list a {
            display: block;
            padding: 0.5rem 0.8rem;
            color: #ccc;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-size: 0.85rem;
         }

         .subpackage-list a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            transform: translateX(4px);
         }

         .empty-state {
            color: rgba(177, 175, 175, 0.6);
            font-style: italic;
            font-size: 0.8rem;
         }

         .badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            color: #ddd;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-left: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .method-badge {
            background: rgba(100, 200, 255, 0.2);
            color: #87ceeb;
         }

         .const-badge {
            background: rgba(255, 200, 100, 0.2);
            color: #ffd700;
         }

         .var-badge {
            background: rgba(200, 255, 100, 0.2);
            color: #90ee90;
         }

         .type-badge {
            background: rgba(255, 100, 200, 0.2);
            color: #699eff;
         }

         .interface-badge {
            background: rgba(150, 100, 255, 0.2);
            color: #dda0dd;
         }

         .toc {
            position: sticky;
            top: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
         }

         .toc h4 {
            margin: 0 0 0.8rem;
            font-size: 0.9rem;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .toc ul {
            list-style: none;
            padding: 0;
            margin: 0;
         }

         .toc li {
            margin-bottom: 0.3rem;
         }

         .toc a {
            color: #bbb;
            text-decoration: none;
            font-size: 0.8rem;
            transition: color 0.2s ease;
         }

         .toc a:hover {
            color: #fff;
         }

         .symbol-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            background: rgba(0, 0, 0, 0.2);
         }

         .symbol-list::-webkit-scrollbar {
            width: 4px;
         }

         .symbol-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
         }

         .symbol-list ul {
            list-style: none;
            padding: 0.5rem;
            margin: 0;
         }

         .symbol-list li {
            margin-bottom: 0.2rem;
         }

         .symbol-list a {
            display: block;
            padding: 0.3rem 0.5rem;
            color: #bbb;
            text-decoration: none;
            border-radius: 4px;
            transition: all 0.2s ease;
            font-size: 0.75rem;
         }

         .symbol-list a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
         }

         @media (max-width: 768px) {
            body {
               flex-direction: column;
            }

            .sidebar {
               width: 90%;
               height: auto;
               position: relative;
            }

            main {
               max-width: 100%;
               padding: 1rem;
            }
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <div class="nav-links">
            <a href="index.html" title="Home">⌂</a>
            <span>|</span>
            <a href="#" onclick="history.back()" title="Back">←</a>
         </div>

         <div class="filter-section">
            <h3>Search</h3>
            <input
               type="search"
               id="searchInput"
               placeholder="Search symbols..."
            />
         </div>

         <div class="filter-section">
            <h3>Filters</h3>
            <div class="filter-toggle">
               <label>
                  <input type="checkbox" id="showImports" />
                  Show imports
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFunctions" />
                  Show private functions
               </label>
               <label>
                  <input type="checkbox" id="showPrivateStructs" />
                  Show private structs
               </label>
               <label>
                  <input type="checkbox" id="showPrivateFields" />
                  Show private fields
               </label>
               <label>
                  <input type="checkbox" id="showPrivateGlobals" />
                  Show private globals
               </label>
               <label>
                  <input type="checkbox" id="showPrivateTypes" />
                  Show private types
               </label>
               <label>
                  <input type="checkbox" id="showPrivateInterfaces" />
                  Show private interfaces
               </label>
            </div>
         </div>

         <div class="section-divider"></div>

         <div class="filter-section">
            <h3>Subpackages</h3>
            
            <div class="empty-state">No subpackages</div>
            
         </div>

         
         <div class="section-divider"></div>

         <div class="toc">
            <h4>Quick Navigation</h4>
            <ul>
               
               <li><a href="#globals">Constants & Variables</a></li>
                   
               <li><a href="#functions">Functions</a></li>
               
            </ul>
         </div>

         <div class="filter-section">
            <h3>All Symbols</h3>
            <div class="symbol-list">
               <ul id="symbolIndex">
               </ul>
            </div>
         </div>
         
      </aside>

      <main>
         <h1>httpguts</h1>
         <div class="section-divider"></div>

         
         <section id="imports">
            <h2>Imports</h2>
            <article class="imports symbol-anchor" id="imports-section" data-name="imports">
               <h3>
                  Imports
                  <a href="#imports-section" class="anchor" title="Link to imports">#</a>
               </h3>
               <pre><code>"net/textproto"
"strings"
"net"
"strings"
"unicode/utf8"
"golang.org/x/net/idna"
</code></pre>
            </article>
         </section>
          
         <section id="globals">
            <h2>Constants & Variables</h2>
            
            <article class="global symbol-anchor" id="badTrailer" data-name="badTrailer">
               <h3>
                  badTrailer 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#badTrailer" class="anchor" title="Link to badTrailer">#</a>
               </h3>
               
               <pre><code>var badTrailer = map[string]bool{...}</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="isTokenTable" data-name="isTokenTable">
               <h3>
                  isTokenTable 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#isTokenTable" class="anchor" title="Link to isTokenTable">#</a>
               </h3>
               
               <pre><code>var isTokenTable = [256]bool{...}</code></pre>
            </article>
            
            <article class="global symbol-anchor" id="validHostByte" data-name="validHostByte">
               <h3>
                  validHostByte 
                  <span class="badge var-badge">var</span>
                  
                  <a href="#validHostByte" class="anchor" title="Link to validHostByte">#</a>
               </h3>
               
               <p>See the validHostHeader comment.</p>
               
               <pre><code>var validHostByte = [256]bool{...}</code></pre>
            </article>
            
         </section>
             
         <section id="functions">
            <h2>Functions</h2>
            
            <article class="function symbol-anchor" id="HeaderValuesContainsToken" data-name="HeaderValuesContainsToken">
               <h3>
                  HeaderValuesContainsToken 
                  <span class="badge">function</span>
                  
                  <a href="#HeaderValuesContainsToken" class="anchor" title="Link to HeaderValuesContainsToken">#</a>
               </h3>
               
               <p>HeaderValuesContainsToken reports whether any string in values
contains the provided token, ASCII case-insensitively.</p>
               
               <pre><code>func HeaderValuesContainsToken(values []string, token string) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="IsTokenRune" data-name="IsTokenRune">
               <h3>
                  IsTokenRune 
                  <span class="badge">function</span>
                  
                  <a href="#IsTokenRune" class="anchor" title="Link to IsTokenRune">#</a>
               </h3>
               
               <pre><code>func IsTokenRune(r rune) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="PunycodeHostPort" data-name="PunycodeHostPort">
               <h3>
                  PunycodeHostPort 
                  <span class="badge">function</span>
                  
                  <a href="#PunycodeHostPort" class="anchor" title="Link to PunycodeHostPort">#</a>
               </h3>
               
               <p>PunycodeHostPort returns the IDNA Punycode version
of the provided "host" or "host:port" string.</p>
               
               <pre><code>func PunycodeHostPort(v string) (string, error)</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="ValidHeaderFieldName" data-name="ValidHeaderFieldName">
               <h3>
                  ValidHeaderFieldName 
                  <span class="badge">function</span>
                  
                  <a href="#ValidHeaderFieldName" class="anchor" title="Link to ValidHeaderFieldName">#</a>
               </h3>
               
               <p>ValidHeaderFieldName reports whether v is a valid HTTP/1.x header name.
HTTP/2 imposes the additional restriction that uppercase ASCII
letters are not allowed.
RFC 7230 says:
header-field   = field-name ":" OWS field-value OWS
field-name     = token
token          = 1*tchar
tchar = "!" / "#" / "$" / "%" / "&" / "'" / "*" / "+" / "-" / "." /
"^" / "_" / "`" / "|" / "~" / DIGIT / ALPHA</p>
               
               <pre><code>func ValidHeaderFieldName(v string) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="ValidHeaderFieldValue" data-name="ValidHeaderFieldValue">
               <h3>
                  ValidHeaderFieldValue 
                  <span class="badge">function</span>
                  
                  <a href="#ValidHeaderFieldValue" class="anchor" title="Link to ValidHeaderFieldValue">#</a>
               </h3>
               
               <p>ValidHeaderFieldValue reports whether v is a valid "field-value" according to
http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2 :
message-header = field-name ":" [ field-value ]
field-value    = *( field-content | LWS )
field-content  = <the OCTETs making up the field-value
and consisting of either *TEXT or combinations
of token, separators, and quoted-string>
http://www.w3.org/Protocols/rfc2616/rfc2616-sec2.html#sec2.2 :
TEXT           = <any OCTET except CTLs,
but including LWS>
LWS            = [CRLF] 1*( SP | HT )
CTL            = <any US-ASCII control character
(octets 0 - 31) and DEL (127)>
RFC 7230 says:
field-value    = *( field-content / obs-fold )
obj-fold       =  N/A to http2, and deprecated
field-content  = field-vchar [ 1*( SP / HTAB ) field-vchar ]
field-vchar    = VCHAR / obs-text
obs-text       = %x80-FF
VCHAR          = "any visible [USASCII] character"
http2 further says: "Similarly, HTTP/2 allows header field values
that are not valid. While most of the values that can be encoded
will not alter header field parsing, carriage return (CR, ASCII
0xd), line feed (LF, ASCII 0xa), and the zero character (NUL, ASCII
0x0) might be exploited by an attacker if they are translated
verbatim. Any request or response that contains a character not
permitted in a header field value MUST be treated as malformed
(Section 8.1.2.6). Valid characters are defined by the
field-content ABNF rule in Section 3.2 of [RFC7230]."
This function does not (yet?) properly handle the rejection of
strings that begin or end with SP or HTAB.</p>
               
               <pre><code>func ValidHeaderFieldValue(v string) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="ValidHostHeader" data-name="ValidHostHeader">
               <h3>
                  ValidHostHeader 
                  <span class="badge">function</span>
                  
                  <a href="#ValidHostHeader" class="anchor" title="Link to ValidHostHeader">#</a>
               </h3>
               
               <p>ValidHostHeader reports whether h is a valid host header.</p>
               
               <pre><code>func ValidHostHeader(h string) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="ValidTrailerHeader" data-name="ValidTrailerHeader">
               <h3>
                  ValidTrailerHeader 
                  <span class="badge">function</span>
                  
                  <a href="#ValidTrailerHeader" class="anchor" title="Link to ValidTrailerHeader">#</a>
               </h3>
               
               <p>ValidTrailerHeader reports whether name is a valid header field name to appear
in trailers.
See RFC 7230, Section 4.1.2</p>
               
               <pre><code>func ValidTrailerHeader(name string) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="headerValueContainsToken" data-name="headerValueContainsToken">
               <h3>
                  headerValueContainsToken 
                  <span class="badge">function</span>
                  
                  <a href="#headerValueContainsToken" class="anchor" title="Link to headerValueContainsToken">#</a>
               </h3>
               
               <p>headerValueContainsToken reports whether v (assumed to be a
0#element, in the ABNF extension described in RFC 7230 section 7)
contains token amongst its comma-separated tokens, ASCII
case-insensitively.</p>
               
               <pre><code>func headerValueContainsToken(v string, token string) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="isASCII" data-name="isASCII">
               <h3>
                  isASCII 
                  <span class="badge">function</span>
                  
                  <a href="#isASCII" class="anchor" title="Link to isASCII">#</a>
               </h3>
               
               <pre><code>func isASCII(s string) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="isCTL" data-name="isCTL">
               <h3>
                  isCTL 
                  <span class="badge">function</span>
                  
                  <a href="#isCTL" class="anchor" title="Link to isCTL">#</a>
               </h3>
               
               <p>isCTL reports whether b is a control byte, according
to http://www.w3.org/Protocols/rfc2616/rfc2616-sec2.html#sec2.2
CTL            = <any US-ASCII control character
(octets 0 - 31) and DEL (127)></p>
               
               <pre><code>func isCTL(b byte) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="isLWS" data-name="isLWS">
               <h3>
                  isLWS 
                  <span class="badge">function</span>
                  
                  <a href="#isLWS" class="anchor" title="Link to isLWS">#</a>
               </h3>
               
               <p>isLWS reports whether b is linear white space, according
to http://www.w3.org/Protocols/rfc2616/rfc2616-sec2.html#sec2.2
LWS            = [CRLF] 1*( SP | HT )</p>
               
               <pre><code>func isLWS(b byte) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="isOWS" data-name="isOWS">
               <h3>
                  isOWS 
                  <span class="badge">function</span>
                  
                  <a href="#isOWS" class="anchor" title="Link to isOWS">#</a>
               </h3>
               
               <p>isOWS reports whether b is an optional whitespace byte, as defined
by RFC 7230 section 3.2.3.</p>
               
               <pre><code>func isOWS(b byte) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="lowerASCII" data-name="lowerASCII">
               <h3>
                  lowerASCII 
                  <span class="badge">function</span>
                  
                  <a href="#lowerASCII" class="anchor" title="Link to lowerASCII">#</a>
               </h3>
               
               <p>lowerASCII returns the ASCII lowercase version of b.</p>
               
               <pre><code>func lowerASCII(b byte) byte</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="tokenEqual" data-name="tokenEqual">
               <h3>
                  tokenEqual 
                  <span class="badge">function</span>
                  
                  <a href="#tokenEqual" class="anchor" title="Link to tokenEqual">#</a>
               </h3>
               
               <p>tokenEqual reports whether t1 and t2 are equal, ASCII case-insensitively.</p>
               
               <pre><code>func tokenEqual(t1 string, t2 string) bool</code></pre>
            </article>
            
            <article class="function symbol-anchor" id="trimOWS" data-name="trimOWS">
               <h3>
                  trimOWS 
                  <span class="badge">function</span>
                  
                  <a href="#trimOWS" class="anchor" title="Link to trimOWS">#</a>
               </h3>
               
               <p>trimOWS returns x with all optional whitespace removes from the
beginning and end.</p>
               
               <pre><code>func trimOWS(x string) string</code></pre>
            </article>
            
         </section>
         
      </main>

      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }

         function buildSymbolIndex() {
            const symbolIndex = document.getElementById('symbolIndex');
            if (!symbolIndex) return;

            const symbols = [];
            
            document.querySelectorAll('article[data-name]').forEach(article => {
               const name = article.dataset.name;
               const type = article.className.split(' ')[0]; 
               const isPrivateSymbol = isPrivate(name);
               
               if (name && name !== 'imports') {
                  symbols.push({
                     name,
                     type,
                     element: article,
                     isPrivate: isPrivateSymbol
                  });
               }
            });

            symbols.sort((a, b) => a.name.localeCompare(b.name));
            symbolIndex.innerHTML = '';
            symbols.forEach(symbol => {
               const li = document.createElement('li');
               const a = document.createElement('a');
               a.href = `#${symbol.name}`;
               a.textContent = symbol.name;
               a.title = `${symbol.type}: ${symbol.name}`;
               
               if (symbol.isPrivate) {
                  li.classList.add('private', 'hidden');
               }
               
               li.appendChild(a);
               symbolIndex.appendChild(li);
            });
         }

         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               imports: document.getElementById("showImports"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
               types: document.getElementById("showPrivateTypes"),
               interfaces: document.getElementById(
                  "showPrivateInterfaces"
               ),
            };

            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });

               if (toggle) {
                  toggle.addEventListener("change", () => {
                     const show = toggle.checked;
                     document
                        .querySelectorAll(`${selector}.private`)
                        .forEach((el) => {
                           el.classList.toggle("hidden", !show);
                        });
                     
                     const symbolIndexItems = document.querySelectorAll('#symbolIndex li.private');
                     symbolIndexItems.forEach(li => {
                        const link = li.querySelector('a');
                        if (link) {
                           const targetId = link.getAttribute('href').substring(1);
                           const targetEl = document.getElementById(targetId);
                           if (targetEl && targetEl.matches(selector)) {
                              li.classList.toggle("hidden", !show);
                           }
                        }
                     });
                  });
               }
            };

            hideInitial("article.imports", toggles.imports);
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            hideInitial("article.type", toggles.types);
            hideInitial("article.interface", toggles.interfaces);

            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;

                  const lines = codeBlock.innerHTML.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch && trimmed != "}") {
                           return `<span class="field-line">${line}</span>`;
                        }
                        if (nameMatch == null) return;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class="field-line${
                           isPriv ? " hidden private" : ""
                        }" data-name="${name}">${line}</span>`;
                     })
                     .join("");

                  codeBlock.innerHTML = newContent;

                  if (toggles.fields) {
                     toggles.fields.addEventListener("change", () => {
                        const show = toggles.fields.checked;
                        article
                           .querySelectorAll(".field-line.private")
                           .forEach((el) =>
                              el.classList.toggle("hidden", !show)
                           );
                     });
                  }
               });

            document
               .querySelectorAll("article.interface")
               .forEach((article) => {
                  const codeBlock = article.querySelector(
                     "code.methods-code"
                  );
                  if (!codeBlock) return;

                  const lines = codeBlock.innerHTML.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch) {
                           return `<span class="method-line">${line}</span>`;
                        }

                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class="method-line${
                           isPriv ? " hidden private" : ""
                        }" data-name="${name}">${line}</span>`;
                     })
                     .join("");

                  codeBlock.innerHTML = newContent;

                  if (toggles.fields) {
                     toggles.fields.addEventListener("change", () => {
                        const show = toggles.fields.checked;
                        article
                           .querySelectorAll(".method-line.private")
                           .forEach((el) =>
                              el.classList.toggle("hidden", !show)
                           );
                     });
                  }
               });

            const searchInput = document.getElementById("searchInput");
            if (searchInput) {
               searchInput.addEventListener("input", () => {
                  const query = searchInput.value.trim().toLowerCase();

                  document.querySelectorAll("article").forEach((el) => {
                     const name = el.dataset.name;
                     if (!name) return;

                     const matches =
                        query === "" ||
                        name.toLowerCase().includes(query) ||
                        (el.textContent &&
                           el.textContent.toLowerCase().includes(query));

                     if (matches) {
                        const isPrivateEl =
                           el.classList.contains("private");
                        const shouldShowPrivate =
                           getPrivateToggleState(el);

                        if (!isPrivateEl || shouldShowPrivate) {
                           el.classList.remove("hidden");
                        }
                     } else {
                        el.classList.add("hidden");
                     }
                  });

                  document.querySelectorAll('#symbolIndex li').forEach(li => {
                     const link = li.querySelector('a');
                     if (link) {
                        const symbolName = link.textContent.toLowerCase();
                        const matches = query === "" || symbolName.includes(query);
                        
                        if (matches) {
                           const isPrivateSymbol = li.classList.contains('private');
                           const targetId = link.getAttribute('href').substring(1);
                           const targetEl = document.getElementById(targetId);
                           const shouldShowPrivate = targetEl ? getPrivateToggleState(targetEl) : false;
                           
                           if (!isPrivateSymbol || shouldShowPrivate) {
                              li.style.display = '';
                           }
                        } else {
                           li.style.display = 'none';
                        }
                     }
                  });
               });
            }

            function getPrivateToggleState(element) {
               if (element.classList.contains("function")) {
                  return toggles.functions?.checked || false;
               } else if (element.classList.contains("struct")) {
                  return toggles.structs?.checked || false;
               } else if (element.classList.contains("global")) {
                  return toggles.globals?.checked || false;
               } else if (element.classList.contains("type")) {
                  return toggles.types?.checked || false;
               } else if (element.classList.contains("interface")) {
                  return toggles.interfaces?.checked || false;
               } else if (element.classList.contains("imports")) {
                  return toggles.imports?.checked || false;
               }
               return false;
            }

            buildSymbolIndex();

            document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
               anchor.addEventListener("click", function (e) {
                  const target = document.querySelector(
                     this.getAttribute("href")
                  );
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               });
            });

            window.addEventListener('hashchange', () => {
               const hash = window.location.hash;
               if (hash) {
                  const target = document.querySelector(hash);
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               }
            });

            if (window.location.hash) {
               setTimeout(() => {
                  const target = document.querySelector(window.location.hash);
                  if (target) {
                     target.scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                     });
                  }
               }, 100);
            }
         });
      </script>
   </body>
</html>