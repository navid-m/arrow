<!DOCTYPE html>
<html lang="en" data-theme="dark">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="viewport"
         content="width=device-width, initial-scale=1.0"
      />
      <title>Docs - rsa</title>
      <link
         href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
         rel="stylesheet"
      />
      <style>
         html {
            font-size: 13px;
         }
         body {
            display: flex;
            min-height: 100vh;
            margin: 0;
         }
         .sidebar {
            width: 200px;
            background: rgba(59, 56, 56, 0.1);
            padding: 1.2rem;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            margin-right: 7px;
         }
         main {
            flex: 0.9;
            padding: 1rem;
            margin: 0;
            max-width: calc(100% - 220px);
         }
         h1 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
         }
         h2 {
            font-size: 1.2rem;
            margin: 0.3rem 0 0.2rem;
         }
         pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 0.4rem 0.6rem;
            border-radius: 6px;
            margin: 0 0 1rem;
            font-size: 0.85rem;
            overflow-x: auto;
         }
         code {
            color: #f0dbdb;
            white-space: pre-wrap;
         }
         p {
            font-size: 15px;
            padding-top: 10px;
         }
         article {
            margin-bottom: 0.5rem;
            padding: 0.4rem 0.9rem;
            background: rgba(59, 56, 56, 0.5);
            border-radius: 10px;
            max-width: 99%;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
         }
         .hidden {
            display: none;
         }
         .filter-toggle label {
            display: block;
            margin-bottom: 0.5rem;
         }
         .field-line {
            display: block;
         }
      </style>
   </head>
   <body>
      <aside class="sidebar">
         <a href="index.html">⌂</a>
         |
         <a href="#" onclick="history.back()">←</a>
         <hr style="opacity: 0" />
         <h2>Filters</h2>
         <hr />
         <input
            type="search"
            id="searchInput"
            placeholder="Search symbols..."
            style="
               width: 100%;
               margin-bottom: 1rem;
               margin-top: 0.8rem;
               border-radius: 10px !important;
               height: 50px;
               height: 2.5rem;
            "
         />
         <div class="filter-toggle">
            <label>
               <input type="checkbox" id="showPrivateFunctions" />
               Show private functions
            </label>
            <label>
               <input type="checkbox" id="showPrivateStructs" />
               Show private structs
            </label>
            <label>
               <input type="checkbox" id="showPrivateFields" />
               Show private struct fields
            </label>
            <label>
               <input type="checkbox" id="showPrivateGlobals" />
               Show private globals
            </label>
         </div>
         <hr style="opacity: 0" />
         <h2 style="padding-top: 5px">Subpackages</h2>
         <hr />
         
         <span style="color: rgba(177, 175, 175, 0.5)">
            No subpackages
         </span>
         
      </aside>
      <main>
         <h1>
            Package
            <code>rsa</code>
         </h1>
         <hr />
         
         <article class="global" data-name="ErrMessageTooLong">
            <h2>ErrMessageTooLong</h2>
            <hr />
            
            <pre><code>ErrMessageTooLong</code></pre>
         </article>
         
         <article class="global" data-name="ErrDecryption">
            <h2>ErrDecryption</h2>
            <hr />
            
            <pre><code>ErrDecryption</code></pre>
         </article>
         
         <article class="global" data-name="ErrVerification">
            <h2>ErrVerification</h2>
            <hr />
            
            <pre><code>ErrVerification</code></pre>
         </article>
         
         <article class="global" data-name="withCheck">
            <h2>withCheck</h2>
            <hr />
            
            <pre><code>withCheck</code></pre>
         </article>
         
         <article class="global" data-name="noCheck">
            <h2>noCheck</h2>
            <hr />
            
            <pre><code>noCheck</code></pre>
         </article>
         
         <article class="global" data-name="fipsSelfTest">
            <h2>fipsSelfTest</h2>
            <hr />
            
            <pre><code>fipsSelfTest</code></pre>
         </article>
         
         <article class="global" data-name="errDivisorTooLarge">
            <h2>errDivisorTooLarge</h2>
            <hr />
            
            <p>errDivisorTooLarge is returned by [totient] when gcd(p-1, q-1) is too large.</p>
            
            <pre><code>errDivisorTooLarge</code></pre>
         </article>
         
         <article class="global" data-name="productOfPrimes">
            <h2>productOfPrimes</h2>
            <hr />
            
            <p>productOfPrimes is the product of the first 74 primes higher than 2.

The number of primes was selected to be the highest such that the product fit
in 512 bits, so to be usable for 1024 bit RSA keys.

Higher values cause fewer Miller-Rabin tests of composites (nothing can help
with the final test on the actual prime) but make InverseVarTime take longer.</p>
            
            <pre><code>productOfPrimes</code></pre>
         </article>
         
         <article class="global" data-name="millerRabinCOMPOSITE">
            <h2>millerRabinCOMPOSITE</h2>
            <hr />
            
            <pre><code>millerRabinCOMPOSITE</code></pre>
         </article>
         
         <article class="global" data-name="millerRabinPOSSIBLYPRIME">
            <h2>millerRabinPOSSIBLYPRIME</h2>
            <hr />
            
            <pre><code>millerRabinPOSSIBLYPRIME</code></pre>
         </article>
         
         <article class="global" data-name="hashPrefixes">
            <h2>hashPrefixes</h2>
            <hr />
            
            <p>These are ASN1 DER structures:

	DigestInfo ::= SEQUENCE {
	  digestAlgorithm AlgorithmIdentifier,
	  digest OCTET STRING
	}

For performance, we don't use the generic ASN1 encoder. Rather, we
precompute a prefix of the digest value that makes a valid ASN1 DER string
with the correct contents.</p>
            
            <pre><code>hashPrefixes</code></pre>
         </article>
         
         <article class="global" data-name="pssSaltLengthAutodetect">
            <h2>pssSaltLengthAutodetect</h2>
            <hr />
            
            <pre><code>pssSaltLengthAutodetect</code></pre>
         </article>
          
         <article class="struct" data-name="PublicKey">
            <h2>type PublicKey struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">N *bigmod.Modulus
E int</code></pre>
         </article>
         
         <article class="struct" data-name="PrivateKey">
            <h2>type PrivateKey struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">pub PublicKey
d *bigmod.Nat
p *bigmod.Modulus
q *bigmod.Modulus
dP []byte
dQ []byte
qInv *bigmod.Nat
fipsApproved bool</code></pre>
         </article>
         
         <article class="struct" data-name="millerRabin">
            <h2>type millerRabin struct</h2>
            <hr />
            
            <pre
               class="fields-block"
            ><code class="fields-code">w *bigmod.Modulus
a uint
m []byte</code></pre>
         </article>
          
         <article class="function" data-name="Size">
            <h2>Size</h2>
            <hr />
            
            <p>Size returns the modulus size in bytes. Raw signatures and ciphertexts
for or by this public key will have the same size.</p>
            
            <pre><code>func Size() int</code></pre>
         </article>
         
         <article class="function" data-name="PublicKey">
            <h2>PublicKey</h2>
            <hr />
            
            <pre><code>func PublicKey() *PublicKey</code></pre>
         </article>
         
         <article class="function" data-name="NewPrivateKey">
            <h2>NewPrivateKey</h2>
            <hr />
            
            <p>NewPrivateKey creates a new RSA private key from the given parameters.

All values are in big-endian byte slice format, and may have leading zeros
or be shorter if leading zeroes were trimmed.</p>
            
            <pre><code>func NewPrivateKey(N []byte, e int, d []byte, P []byte, Q []byte) (*PrivateKey, error)</code></pre>
         </article>
         
         <article class="function" data-name="newPrivateKey">
            <h2>newPrivateKey</h2>
            <hr />
            
            <pre><code>func newPrivateKey(n *bigmod.Modulus, e int, d *bigmod.Nat, p *bigmod.Modulus, q *bigmod.Modulus) (*PrivateKey, error)</code></pre>
         </article>
         
         <article class="function" data-name="NewPrivateKeyWithPrecomputation">
            <h2>NewPrivateKeyWithPrecomputation</h2>
            <hr />
            
            <p>NewPrivateKeyWithPrecomputation creates a new RSA private key from the given
parameters, which include precomputed CRT values.</p>
            
            <pre><code>func NewPrivateKeyWithPrecomputation(N []byte, e int, d []byte, P []byte, Q []byte, dP []byte, dQ []byte, qInv []byte) (*PrivateKey, error)</code></pre>
         </article>
         
         <article class="function" data-name="NewPrivateKeyWithoutCRT">
            <h2>NewPrivateKeyWithoutCRT</h2>
            <hr />
            
            <p>NewPrivateKeyWithoutCRT creates a new RSA private key from the given parameters.

This is meant for deprecated multi-prime keys, and is not FIPS 140 compliant.</p>
            
            <pre><code>func NewPrivateKeyWithoutCRT(N []byte, e int, d []byte) (*PrivateKey, error)</code></pre>
         </article>
         
         <article class="function" data-name="Export">
            <h2>Export</h2>
            <hr />
            
            <p>Export returns the key parameters in big-endian byte slice format.

P, Q, dP, dQ, and qInv may be nil if the key was created with
NewPrivateKeyWithoutCRT.</p>
            
            <pre><code>func Export() (N []byte, e int, d []byte, P []byte, Q []byte, dP []byte, dQ []byte, qInv []byte)</code></pre>
         </article>
         
         <article class="function" data-name="checkPrivateKey">
            <h2>checkPrivateKey</h2>
            <hr />
            
            <p>checkPrivateKey is called by the NewPrivateKey and GenerateKey functions, and
is allowed to modify priv.fipsApproved.</p>
            
            <pre><code>func checkPrivateKey(priv *PrivateKey) error</code></pre>
         </article>
         
         <article class="function" data-name="checkPublicKey">
            <h2>checkPublicKey</h2>
            <hr />
            
            <pre><code>func checkPublicKey(pub *PublicKey) (fipsApproved bool, err error)</code></pre>
         </article>
         
         <article class="function" data-name="Encrypt">
            <h2>Encrypt</h2>
            <hr />
            
            <p>Encrypt performs the RSA public key operation.</p>
            
            <pre><code>func Encrypt(pub *PublicKey, plaintext []byte) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="encrypt">
            <h2>encrypt</h2>
            <hr />
            
            <pre><code>func encrypt(pub *PublicKey, plaintext []byte) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="DecryptWithoutCheck">
            <h2>DecryptWithoutCheck</h2>
            <hr />
            
            <p>DecryptWithoutCheck performs the RSA private key operation.</p>
            
            <pre><code>func DecryptWithoutCheck(priv *PrivateKey, ciphertext []byte) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="DecryptWithCheck">
            <h2>DecryptWithCheck</h2>
            <hr />
            
            <p>DecryptWithCheck performs the RSA private key operation and checks the
result to defend against errors in the CRT computation.</p>
            
            <pre><code>func DecryptWithCheck(priv *PrivateKey, ciphertext []byte) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="decrypt">
            <h2>decrypt</h2>
            <hr />
            
            <p>decrypt performs an RSA decryption of ciphertext into out. If check is true,
m^e is calculated and compared with ciphertext, in order to defend against
errors in the CRT computation.</p>
            
            <pre><code>func decrypt(priv *PrivateKey, ciphertext []byte, check bool) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="testPrivateKey">
            <h2>testPrivateKey</h2>
            <hr />
            
            <pre><code>func testPrivateKey() *PrivateKey</code></pre>
         </article>
         
         <article class="function" data-name="GenerateKey">
            <h2>GenerateKey</h2>
            <hr />
            
            <p>GenerateKey generates a new RSA key pair of the given bit size.
bits must be at least 32.</p>
            
            <pre><code>func GenerateKey(rand io.Reader, bits int) (*PrivateKey, error)</code></pre>
         </article>
         
         <article class="function" data-name="totient">
            <h2>totient</h2>
            <hr />
            
            <p>totient computes the Carmichael totient function λ(N) = lcm(p-1, q-1).</p>
            
            <pre><code>func totient(p *bigmod.Modulus, q *bigmod.Modulus) (*bigmod.Modulus, error)</code></pre>
         </article>
         
         <article class="function" data-name="randomPrime">
            <h2>randomPrime</h2>
            <hr />
            
            <p>randomPrime returns a random prime number of the given bit size following
the process in FIPS 186-5, Appendix A.1.3.</p>
            
            <pre><code>func randomPrime(rand io.Reader, bits int) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="isPrime">
            <h2>isPrime</h2>
            <hr />
            
            <p>isPrime runs the Miller-Rabin Probabilistic Primality Test from
FIPS 186-5, Appendix B.3.1.

w must be a random odd integer greater than three in big-endian order.
isPrime might return false positives for adversarially chosen values.

isPrime is not constant-time.</p>
            
            <pre><code>func isPrime(w []byte) bool</code></pre>
         </article>
         
         <article class="function" data-name="millerRabinSetup">
            <h2>millerRabinSetup</h2>
            <hr />
            
            <p>millerRabinSetup prepares state that's reused across multiple iterations of
the Miller-Rabin test.</p>
            
            <pre><code>func millerRabinSetup(w []byte) (*millerRabin, error)</code></pre>
         </article>
         
         <article class="function" data-name="millerRabinIteration">
            <h2>millerRabinIteration</h2>
            <hr />
            
            <pre><code>func millerRabinIteration(mr *millerRabin, bb []byte) (bool, error)</code></pre>
         </article>
         
         <article class="function" data-name="TestMillerRabin">
            <h2>TestMillerRabin</h2>
            <hr />
            
            <pre><code>func TestMillerRabin(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="TestTotient">
            <h2>TestTotient</h2>
            <hr />
            
            <pre><code>func TestTotient(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="oddDivisorLargerThan32Bits">
            <h2>oddDivisorLargerThan32Bits</h2>
            <hr />
            
            <pre><code>func oddDivisorLargerThan32Bits(b []byte) bool</code></pre>
         </article>
         
         <article class="function" data-name="addOne">
            <h2>addOne</h2>
            <hr />
            
            <pre><code>func addOne(b []byte) []byte</code></pre>
         </article>
         
         <article class="function" data-name="decodeHex">
            <h2>decodeHex</h2>
            <hr />
            
            <pre><code>func decodeHex(t *testing.T, s string) []byte</code></pre>
         </article>
         
         <article class="function" data-name="SignPKCS1v15">
            <h2>SignPKCS1v15</h2>
            <hr />
            
            <p>SignPKCS1v15 calculates an RSASSA-PKCS1-v1.5 signature.

hash is the name of the hash function as returned by [crypto.Hash.String]
or the empty string to indicate that the message is signed directly.</p>
            
            <pre><code>func SignPKCS1v15(priv *PrivateKey, hash string, hashed []byte) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="signPKCS1v15">
            <h2>signPKCS1v15</h2>
            <hr />
            
            <pre><code>func signPKCS1v15(priv *PrivateKey, hash string, hashed []byte) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="pkcs1v15ConstructEM">
            <h2>pkcs1v15ConstructEM</h2>
            <hr />
            
            <pre><code>func pkcs1v15ConstructEM(pub *PublicKey, hash string, hashed []byte) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="VerifyPKCS1v15">
            <h2>VerifyPKCS1v15</h2>
            <hr />
            
            <p>VerifyPKCS1v15 verifies an RSASSA-PKCS1-v1.5 signature.

hash is the name of the hash function as returned by [crypto.Hash.String]
or the empty string to indicate that the message is signed directly.</p>
            
            <pre><code>func VerifyPKCS1v15(pub *PublicKey, hash string, hashed []byte, sig []byte) error</code></pre>
         </article>
         
         <article class="function" data-name="verifyPKCS1v15">
            <h2>verifyPKCS1v15</h2>
            <hr />
            
            <pre><code>func verifyPKCS1v15(pub *PublicKey, hash string, hashed []byte, sig []byte) error</code></pre>
         </article>
         
         <article class="function" data-name="checkApprovedHashName">
            <h2>checkApprovedHashName</h2>
            <hr />
            
            <pre><code>func checkApprovedHashName(hash string)</code></pre>
         </article>
         
         <article class="function" data-name="TestHashPrefixes">
            <h2>TestHashPrefixes</h2>
            <hr />
            
            <pre><code>func TestHashPrefixes(t *testing.T)</code></pre>
         </article>
         
         <article class="function" data-name="incCounter">
            <h2>incCounter</h2>
            <hr />
            
            <p>incCounter increments a four byte, big-endian counter.</p>
            
            <pre><code>func incCounter(c *[]byte)</code></pre>
         </article>
         
         <article class="function" data-name="mgf1XOR">
            <h2>mgf1XOR</h2>
            <hr />
            
            <p>mgf1XOR XORs the bytes in out with a mask generated using the MGF1 function
specified in PKCS #1 v2.1.</p>
            
            <pre><code>func mgf1XOR(out []byte, hash fips140.Hash, seed []byte)</code></pre>
         </article>
         
         <article class="function" data-name="emsaPSSEncode">
            <h2>emsaPSSEncode</h2>
            <hr />
            
            <pre><code>func emsaPSSEncode(mHash []byte, emBits int, salt []byte, hash fips140.Hash) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="emsaPSSVerify">
            <h2>emsaPSSVerify</h2>
            <hr />
            
            <pre><code>func emsaPSSVerify(mHash []byte, em []byte, emBits int, sLen int, hash fips140.Hash) error</code></pre>
         </article>
         
         <article class="function" data-name="PSSMaxSaltLength">
            <h2>PSSMaxSaltLength</h2>
            <hr />
            
            <p>PSSMaxSaltLength returns the maximum salt length for a given public key and
hash function.</p>
            
            <pre><code>func PSSMaxSaltLength(pub *PublicKey, hash fips140.Hash) (int, error)</code></pre>
         </article>
         
         <article class="function" data-name="SignPSS">
            <h2>SignPSS</h2>
            <hr />
            
            <p>SignPSS calculates the signature of hashed using RSASSA-PSS.</p>
            
            <pre><code>func SignPSS(rand io.Reader, priv *PrivateKey, hash fips140.Hash, hashed []byte, saltLength int) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="VerifyPSS">
            <h2>VerifyPSS</h2>
            <hr />
            
            <p>VerifyPSS verifies sig with RSASSA-PSS automatically detecting the salt length.</p>
            
            <pre><code>func VerifyPSS(pub *PublicKey, hash fips140.Hash, digest []byte, sig []byte) error</code></pre>
         </article>
         
         <article class="function" data-name="VerifyPSSWithSaltLength">
            <h2>VerifyPSSWithSaltLength</h2>
            <hr />
            
            <p>VerifyPSS verifies sig with RSASSA-PSS and an expected salt length.</p>
            
            <pre><code>func VerifyPSSWithSaltLength(pub *PublicKey, hash fips140.Hash, digest []byte, sig []byte, saltLength int) error</code></pre>
         </article>
         
         <article class="function" data-name="verifyPSS">
            <h2>verifyPSS</h2>
            <hr />
            
            <pre><code>func verifyPSS(pub *PublicKey, hash fips140.Hash, digest []byte, sig []byte, saltLength int) error</code></pre>
         </article>
         
         <article class="function" data-name="checkApprovedHash">
            <h2>checkApprovedHash</h2>
            <hr />
            
            <pre><code>func checkApprovedHash(hash fips140.Hash)</code></pre>
         </article>
         
         <article class="function" data-name="EncryptOAEP">
            <h2>EncryptOAEP</h2>
            <hr />
            
            <p>EncryptOAEP encrypts the given message with RSAES-OAEP.</p>
            
            <pre><code>func EncryptOAEP(hash fips140.Hash, mgfHash fips140.Hash, random io.Reader, pub *PublicKey, msg []byte, label []byte) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="DecryptOAEP">
            <h2>DecryptOAEP</h2>
            <hr />
            
            <p>DecryptOAEP decrypts ciphertext using RSAES-OAEP.</p>
            
            <pre><code>func DecryptOAEP(hash fips140.Hash, mgfHash fips140.Hash, priv *PrivateKey, ciphertext []byte, label []byte) ([]byte, error)</code></pre>
         </article>
         
         <article class="function" data-name="TestEMSAPSS">
            <h2>TestEMSAPSS</h2>
            <hr />
            
            <pre><code>func TestEMSAPSS(t *testing.T)</code></pre>
         </article>
         
      </main>
      <script>
         function isPrivate(name) {
            return /^[a-z]/.test(name);
         }
         document.addEventListener("DOMContentLoaded", () => {
            const toggles = {
               functions: document.getElementById("showPrivateFunctions"),
               structs: document.getElementById("showPrivateStructs"),
               fields: document.getElementById("showPrivateFields"),
               globals: document.getElementById("showPrivateGlobals"),
            };
            const hideInitial = (selector, toggle) => {
               document.querySelectorAll(selector).forEach((el) => {
                  const name = el.dataset.name;
                  if (isPrivate(name)) {
                     el.classList.add("private", "hidden");
                  }
               });
               toggle.addEventListener("change", () => {
                  const show = toggle.checked;
                  document
                     .querySelectorAll(`${selector}.private`)
                     .forEach((el) => {
                        el.classList.toggle("hidden", !show);
                     });
               });
            };
            hideInitial("article.function", toggles.functions);
            hideInitial("article.struct", toggles.structs);
            hideInitial("article.global", toggles.globals);
            document
               .querySelectorAll("article.struct")
               .forEach((article) => {
                  const codeBlock =
                     article.querySelector("code.fields-code");
                  if (!codeBlock) return;
                  const lines = codeBlock.innerText.split("\n");
                  const newContent = lines
                     .map((line) => {
                        const trimmed = line.trim();
                        const nameMatch = trimmed.match(
                           /^([A-Za-z_][A-Za-z0-9_]*)/
                        );
                        if (!nameMatch)
                           return `<span class=\"field-line\">${line}</span>`;
                        const name = nameMatch[1];
                        const isPriv = isPrivate(name);
                        return `<span class=\"field-line${
                           isPriv ? " hidden private" : ""
                        }\" data-name=\"${name}\">${line}</span>`;
                     })
                     .join("");
                  codeBlock.innerHTML = newContent;
                  toggles.fields.addEventListener("change", () => {
                     const show = toggles.fields.checked;
                     article
                        .querySelectorAll(".field-line.private")
                        .forEach((el) =>
                           el.classList.toggle("hidden", !show)
                        );
                  });
               });
            const searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("input", () => {
               const query = searchInput.value.trim().toLowerCase();
               document.querySelectorAll("article").forEach((el) => {
                  const name = el.dataset.name.toLowerCase();
                  if (query === "" || name.includes(query)) {
                     el.classList.remove("hidden");
                  } else {
                     el.classList.add("hidden");
                  }
               });
            });
         });
      </script>
   </body>
</html>
